ahora lo instalas como complemento de Apache Y esa es la forma nativa de ser de php es para lo que se creó php técnicamente si quieres php no es que sea frecuente pero se puede hacer perfectamente php se puede ejecutar mediante el cmd se llama php cli es decir php command Line interface y php lo único es que no tiene eh una un entorno para crear aplicaciones de escritorio es decir así como python puede crear interfaces gráficas de usuario de escritorio con tc inter e interfaces gráficas para web mediante flask pues php tiene la opción de crear interfaces gráficas de usuario mediante web mediante la combinación de html pero es que además esto es la vía python y la vía php pero es que estas vías se pueden comar Así que ayer por ejemplo Estuvimos viendo un ejemplo mediante el cual trabajábamos con python voy a copiarme esto trabajábamos con python trabajábamos python tk inter para la interfaz de usuario vale python T para interfaz de usuario y hacíamos un controlador con el lenguaje de programación c+ má e hicimos una lectura y escritura de modelo mediante un archivo txt y podría haber sido muchos otros tipos de archivo para persistencia la filosofía del ejercicio de ayer es que se pueden combinar las tecnologías independientemente de que sea una forma más natural o menos natural vale eh se pueden combinar las tecnologías y aquí Fran es donde voy a tu pregunta Y es que python mediante flask vale Sí que tiene que estar arrancada siempre la aplicación hay diferentes tipos de aplicaciones web mediante las cuales en lugar de usar amente flask podemos usar ng Unicorn que es una un servidor para python que soporta flask pero es que si te fijas con php ocurre Lo mismo para que php sea servido al cliente Apache tiene que estar ejecutándose y tiene que estar ejecutándose además como servicio de forma continua y escuchando por eso digo que tener un flask siempre encendido no representa realmente ningún problema en el momento en el que tenemos un apache siempre encendido la cuestión es que está en que algo tiene que estar siempre encendido para escuchar las peticiones del usuario Pero además de ello Pero además de ello Claro tú en un servidor puedes decir ya pero es que en un servidor que ya tengo php ejecutándose Pues si arranco flask y flask arranca sobre el puerto 80 pues se va a pegar de leches con eh con php y con Apache y encima además igual tampoco tanto Vale pues la cuestión está en que de la misma forma que ayer hicimos esto yo a continuación puedo crear una jerarquía puedo crear una combinación de tecnologías mediante las cuales Y esta es la parte que te va a sorprender no te voy a decir que sea específicamente común pero te voy a decir que si quieres puedes hacerlo perfectamente y por supuesto yo ahora te voy a hacer la demostración Y es que tú puedes tener una Capa intermedia php como tienes ahora y puedes tener como interfaz de usuario una interfaz nativa web como tienes ahora pero por qué no y cuando te digo por qué no lo que te quiero decir es que no te he enseñado El Comando Pero te lo voy a enseñar ahora por qué no php se puede comunicar con python y no hay ningún problema y lo puedes hacer vale Y se puede hacer de formas tú usas php y para lo que quieras para lo que te interese cuando te interese en el momento que te interese tú puedes decirle a php que te levante python O puedes decirle a php que te levante c+ má O puedes decirle a php que te levante lo que a ti te dé la gana Pero insisto o bien que te lo levante como servicio o bien que te lo levante como quier otro tipo de aplicación o una aplicación bajo demanda es decir arranco python me hace una operación y python para Vale ahora a continuación vamos a analizar Cómo hacer esto te voy a demostrar Cómo hacer esto en php se hace mediante un comando sobre el cual te tengo que hablar específicamente de la seguridad que es el comando exec de php nos permite ejecutar cualquier Comando del sistema Pero cuidado Vale en la práctica vamos a tener que controlar esto para asegurar que un hacker No utilice el php exec y se ponga a ejecutar lo que le de la gana en la máquina vale o sea que vamos a hablar de la teoría y ahora a continuación lo hablamos en la práctica y verás que no hay ningún problema Entonces para ello Yo vengo por aquí vamos a verlo y eh vamos a ver voy a hacer primero una demostración me voy a hedit aquí en hedit me voy a dam me voy a Primero me voy a vamos a sistemas informáticos vale vamos a explotación de Mira software tipo requisitos licencias espérate Es que de esto quiero hablar también herramientas No espera ahí no vamos a gestión de recursos vamos a ver espera voy a crear por aquí una carpeta nueva llamada php exec y luego ya veremos dónde la metemos bien para ello voy a crear un archivo nuevo llamado 001 prueba.php y a continuación voy a crear un archivo nuevo llamado Eh pues como te diría yo 002 escribe. python en escribe. python voy a decir que archivo es igual a open prueba.txt en modo write y voy a decir que archivo. write si estás viendo esto es que te lo da php Perdona te lo da python quería decir vale Y ahora voy a decir archivo. Close y esto que voy a hacer ahora no es obligatorio pero es opcional y es que voy a decir print OK Porque print OK Será el mensaje o mira voy a decir python dice ok o soy python y digo Ok vale el mensaje que python devolverá a php un archivo sencillo de python ahora en prueba php e Hola dónde tengo Chrome vamos a hacer un php exec vamos a ver chat gpt modelo 4 simplest example of php exec probablemente el mismo chat gpt me dirá Pero cuidado con esto porque te lo pueden reventar los hackers y todo eso vale vamos a ver sí pero no quiero un shell no python Script on the same folder as the php Script o no vale o lo podría ejecutar de donde quisiera pero en este caso vale está en el mismo vale aquí esto es bien Así que me vengo aquí copio pego igual ahora lo limpio un poco vale cojo el directorio Ay el Script madre mía Qué tarde ch vecina el Script es 002 escribe. python Vale ahora el output es nada y aquí este es el problema bueno Perdona problema no ventaja vale Y es que lo que está haciendo es escape shell ar es decir proteger que esto no ejecute algo que no debe O sea que super guay vale Y ahora voy a ejecutar algo voy a atrapar la salida y voy a atrapar la variable de retorno que en este caso de momento es cero vale Así que la variable de retorno el output lo que devuelve es implode output vale para implode es para quitar el contrabarra n lo podría dejar tampoco pasa nada y código de vuelta es return bar el código de vuelta será un Ok vale un código uno de lo he ejecutado correctamente porque este ejemplo no reviste mucha complejidad Así que ahora a continuación me vengo aquí le digo local Host dam me voy a Primero me voy a me voy a dónde estás sistemas de G no segundo Ah Sí perdón aquí me voy a sistemas informáticos me voy a php exec cuidado eh No existe un archivo php vale ejecuto prueba php código de vuelta un que quiere decir el Script se ha ejecutado correctamente lo que devuelve es nada Uy qué raro vale debería 002 escribe. python vale Ok aquí refresco vale no se ha ejecutado nada 002 escribe punp ok eh okay okay okay vale momentín porque parece que no está funcionando pero el código de vuelta es uno a ver prueba t XT soy python y te digo OK Vamos a verlo python code is B It is not working H también tengo que ver si es que yo tengo algo desactivado en mi vale Okay python 3 está accesible Sí vale python 3 Sí ahora código corregido yo creo que lo tengo bien no archivo. Close Ok vale eh vamos a ver vamos a darle permisos para que sea ejecutado entonces acordémonos que esto es O sea qué permisos tiene el archivo vamos a verlo voy a entrar en esa carpeta porque Claro si tengo 755 no tengo permiso para ejecutarlo con lo cual vamos a ver vale con lo cual me voy dónde estás Ah bueno voy a Esto vale me voy a dam me voy a Primero me voy a sistemas informáticos me voy a Bueno me voy a php exec vamos a ver escribe pun python Qué propiedades tiene ejecutable como un programa as per permisos vale permisos vamos a ver tiene solo lectura escritura tiene solo lectura escritura otros tiene acceso lectura escritura y no está ejecutable como un programa Pero yo a continuación voy a decir sudo ch mod 777 men bueno el men r no hace falta escribe Ahora ejecuto me voy otra vez a propiedades ahora se puede ejecutar como un programa y ahora en permisos todo el mundo tiene lectura y escritura recordamos que le acabo de meter un 777 que no es que sea lo más recomendable pero en este caso es una forma rápida de que funcione Así que vengo por aquí recargo No todavía no Bueno pues vamos a ver 777 - r voy a metérselo al php exec 777 - r al php exec Vale ahora sí Y me dice lo que devuelve es soy python y digo Ok y el código de vuelta es cero Ahora sí vale y de hecho veo que ahora sí tengo un archivo llamado prueba.txt y si entro prueba.txt pues pone si estás viendo esto es que te lo da python vale por lo tanto hay que utilizarlo con cuidado porque de la misma forma que yo acabo de ejecutar un inocente Script de python que en este caso dice Hola pues lo que vale lo que ocurre en este caso es que cualquier persona puede escapar cualquier cosa Vale bien Vamos a ver eh A ver a ver sí te cuento en python efectivamente pero cuidado eh En este caso estamos hablando entiendo de variables de sesión en python y por tanto si hablamos de variables de sesión de lo que estamos hablando es de usar python con flask pregunto vale Te voy a decir una cosa te voy a decir una cosa el método de autenticación que utiliza php con php session realmente lo podemos implantar nosotros de forma manual en python aparte de que hay plugins para flask que hacen eso te voy a contar una cosa cada vez que yo implemento una sesión lo que ocurre automáticamente en la carpeta bar Es que yo me voy por aquí a creo que es log me voy a php a ver hay por aquí una carpeta dónde estás Ah cach Espera que te lo digo Espera que te lo digo Where are php sessions stor y está por aquí en la carpeta bar vale tmp Yo creo que no pero vamos a verlo tmp no onun server está por la carpeta bar vamos a ver Esto sí bar le HD Ahora sí bar Esto sí que me suena Live php y en sessions Vale ahora mismo está vacío Simplemente porque no tengo ningún programa que haya hecho una sesión pero lo voy a hacer así que vale s está vacío me voy a bar me voy a www me voy a dam me voy a Primero me voy a sistemas informáticos aquí en php exec por ejemplo ya que estamos en esta carpeta me voy a 003 sesion.php y en sesión php digo bueno perdón primero session Start y ahora digo usuario es igual a José Vicente ejecuto Esto me voy a sesión no ocurre nada particularmente pero ahora a continuación me voy a bar me voy a Live me voy a php me voy a sessions a ver si me dejan entrar no dice que está vacío y un huevo así que me voy a eh CD bajo CD Live CD php CD sessions ls permiso denegado vale vamos a ver eh sudo lsl Y si te fijas tengo aquí una sesión que lo he creado ahora mismo día eh enero 16 a las 1522 y ahora digo sudon No session de verdad bueno pertenece al usuario W Data vale voy a copiar este nombre de archivo lo voy a poner aquí pego y lo edito y resulta que como puedes ver la variable de sesión usuario se guarda en un mísero archivo txt protegido Eso sí ya has visto que he tenido que entrar como superusuario para poder verlo porque la información que guarda una sesión puede ser muy privada que es de tipo String que tiene 12 caracteres y que pone José Vicente con esto lo que te quiero decir ah Perdona y además Perdona Se me olvidaba si yo me meto porque tú dirás ya pero cómo sabe php A qué sesión corresponde cada cosa pues me voy a dónde estás aquí me voy a application me voy a cookies y en cookies resulta que tengo una Cookie que es phps que es 2tn 8b tal cual 2 tn8 B8 tal cual que acaba en 16 r3 que acaba en 16 r3 lo cual quiere decir que diferentes usuarios pueden abrir sesión en mi equipo y php con Apache tiene este truco que si te fijas es superfácil de destripar si eres Root del servidor claro donde simplemente en la en el cliente se guarda una galleta literalmente una Cookie que te dice Cuál es la sesión Y entonces en el servidor existe un archivo donde se quedan guardadas todas tus variables de sesión vale con lo cual Pues que sepas que por una parte hay variables de sesión en python pero con flask vale hay que hablar Siempre en ese caso de flask y si no En definitiva sea como sea con el método que sea yo te enseño cómo funcionan las variables de sesión de php realmente para que veas que al final es un archivo txt o sea que te puedes implementar tu propia versión de sesiones con pth o con el lenguaje que quieras porque al final ves que no tiene mucho misterio cuando nos metemos dentro vale o sea que eh No es que no es ya que seas un loco de la autenticación es que realmente eh cuando construyes una aplicación web en el momento en el que construyes un panel de control Pues tienes que implementar algún tipo de sistema de sesiones y tienes que intentar por supuesto eso también que la información viaje de la forma más segura posible vale cosa que es un reto no es ya tanto un reto para primero vale sino más un reto para segundo pero así vale entonces eh correspond Exacto Sí y si no atrás efectivamente Y si no corresponde pues Cierra la sesión o considera que la sesión está cerrada sí correcto o sea yo realmente cada vez que pongo aquí cada vez que pongo aquí session Start lo que le estoy haciendo es preavisar le al programa de decir Vete a buscar los archivos que están en ses y cuando le digo eh o sea soy esta sesión y quiero la variable usuario lo que le estoy diciendo a php es Ábrete este archivo y localz bien la línea donde ponga usuario es que no tiene más misterio al final el misterio obviamente está en que como has podido ver pues el archivo está guardado y protegido en una carpeta muy específica del servidor y no he podido acceder a él si no he entrado como Root pero no es algo que cualquier persona no pueda hacer vale yo insisto no tengo palabras suficientes para advertir acerca del tema de la seguridad vale Y el tema de que hagáis lo que hagáis pues program aplicaciones que en la medida de lo posible sean lo más seguras posibles para evitar problemas vale bien entonces vamos a ver eh Por cierto ayer voy a salir un momento de aquí eh ayer yo le dije que se me ah no es el Tab de mi equipo nada Ok cierro control x vale le dije que se ejecutara en el servidor y no se y esta mañana no se ha ejecutado ahora veré Por qué bien siguiente cuestión hablando de seguridad en el servidor ejemp en este caso estoy accediendo siempre que accedo al servidor es decir al vps con el que estamos trabajando con el usuario root mala costumbre vale el año pasado si os acordáis en la parte de usuarios es una parte que no vimos mucho en profundidad porque el año pasado muchas veces Lo acabamos todo haciendo como Root Pero hay una cosa que es una mala costumbre que es hacerlo todo como Root yo lo primero que tendría que hacer en el servidor vosotros lo podéis hacer en real si estáis en un servidor real y lo podéis hacer simulado si estáis en un servidor a ver un momento Ok vale si estáis en un servidor virtual vale que consiste en crear un usuario específico para ese servidor para ello voy a hacer lo siguiente vamos a ver ubun server voy a decirle aquí chat gpt o Mini y Esto me lo voy a apuntar el log del servidor vale me lo voy a apuntar en el log del servidor aquí para aquí en el log para luego poder entrar correctamente vale ubun server vamos a ver change Root password vale password Ok muy importante que nos acordemos cual es el Host Perdona el la contraseña en todo momento para poder luego acceder vale Security Warning cuidado Así que vamos a ver sí sí yo os enseñaré De hecho sí correcto primero tenemos que entender que son las cookies y luego las truc pero sí Ahora luego os cuento vale con lo cual vamos a en primer lugar vamos a cambiarle el password al Root le voy a poner una contraseña Pero obviamente momentín obviamente lo primero que os voy a decir es que os recomiendo que la contraseña tenga más de X caracteres que tenga mayúsculas minúsculas números y eh caracteres extraños vale por tanto voy a poner una contraseña voy a poner la contraseña vale Y ahora a continuación Ah fantástico espérate Me acabo de cambiar la contraseña de root de este equipo local no quería eso vale Ok lo que quería era cambiarme la contraseña de root del servidor Vale Voy a cambiarla del servidor vamos a ver pues a ver vamos a ver ssh Root @ ya digo Ya decía yo digo que es rápido me cambiado la contraseña del Root 160 2289 vale Yes ahora la contraseña actual del Root vale Clear Okay ahora a continuación le cambiamos la contraseña a Root lo normal es que me diga Ok vale con lo cual ahora logout vuelvo a Iniciar sesión y ahora solo si pongo la nueva contraseña es cuando me debe dar acceso vale por tanto voy a apuntar en el log voy a apuntar en el log del servidor Okay que el día 202 501 166 sudó password rot espérate esto ha sido a las sudo password rot y digo pongo la de siempre vale No pongáis la contraseña que habéis puesto Porque si alguien luego os ve el log pues ya la tiene bien siguiente Pero aunque he cambiado la contraseña de root pues es interesante que cree una nueva contraseña Perdón un nuevo usuario vale por tanto por lo tanto le digo Now create a New user named José Vicente with password voy a poner tame 1 m set eh Group of sudoers es decir que pueda hacer de todo and set bueno default es que a ver lo que quiero es que este usuario solo pueda acceder a la carpeta bar vale es decir que solo sea Mira voy a hacer una cosa eh name José Vicente web vale en set default folder barw html vale para hacer un usuario que solo pueda tocar eso y que si alguien me peta el usuario Pues que no me pueda petar el sistema Si alguien me caza la contraseña de usuario es decir es como que me voy a quitar permisos a mí mismo vale para que lo entendáis Así que vamos a ver okay momentín Un momentín vale vamos a por ello primero voy a crear un nuevo usuario el ad user sí que lo hicimos aunque fue de pasada el año pasado en sistemas operativos en Red así que 202 50116 a las no pongo espacios y digo sudo ad user home José Vicente web me vengo por aquí sudo ad user home José Vicente web vale vamos a ver el Home directory ya exist not touching vale The Home directory does not belong Okay New password le pongo un password le pongo un password full name José Vicente carratalá room number one work phone 620 891 home phone 620 891 other ninguno is inform correct Yes Ok vale al grupo usuarios ahora a continuación Us password ya tengo vale eh okay okay vale Okay ahora en el día 2025 0116 a las 1536 voy a decir que al usuario Vicente web lo añado en sud doers es decir puede hacer sudo vale Okay no quiero ch un claro vale Okay esto Sí también lo añado al grupo Data vale lo añado al grupo Data Esto sí que es correcto porque cambiar el propietario del de html puede ser peligroso y Ok nada y ya está esto quiere decir que ahora a continuación hago logout y digo ssh José Vicente web Yes pongo el password entro como administrador digo Clear digo ls y he entrado directamente en la carpeta que quiero he entrado directamente en la carpeta que toca puedo bajar más Probablemente sí puedo bajar más vale pero por lo menos mi carpeta home vale es la carpeta que hemos visto antes bien eh Por cierto al entrar hemos visto que el servidor estaba pendiente de reinicio HM vamos a verlo vamos a hacer un logout vamos a hacer un login Yes pongo contraseña y vemos que dice System restart required System restart require es porque probablemente el sistema habrá instalado algún tipo de actualización vale por tanto que sepáis que de vez en cuando y a ser posible cuando el servidor no esté en uso es interesante es importante que reinicié el servidor para aplicar todos los cambios que hayan que reiniciar si detectándose o bien vosotros a mano o bien de forma automática vale Así que en el día 202 50116 a las voy a hacer un sudo reboot entonces sudo reboot lo que hace básicamente me va a cerrar la conexión atención sudor reboot la contraseña el sistema Broken Pipe el sistema va a reiniciarse se está reiniciando me ha devuelto a mi equipo vale es lo que te decía antes si depende de un flask puro y duro sí que tendrías que rearranque automáticamente como servicio cuando el servidor re arranca te vuelvo a poner el ejemplo de Apache es decir si Apache está arrancado como proceso y no como servicio cuando se reinicia el servidor Apache no se ha arrancado y hay que arrancarlo a mano ahora si Apache lo arrancas como servicio cada vez que se reinicie el servidor se vuelve a iniciar Apache Así que en este caso como te digo pues puedes instalar G Unicorn o la aplicación que sea de tipo flask Vale y eh Y funciona perfectamente como servicio Vale entonces ahora entre que estamos hablando han pasado un par de minutos han pasado un par de minutos esto quiere decir que yo calculo que el servidor ya habrá arrancado es decir un servidor evidentemente es como Windows digamos vale al final pues es un sistema operativo que tarda 1 2 3 4 minutos en arrancarse eh si ahora le digo Iniciar sesión y me dice que no siempre se me ponen los huevos de corbata vale porque es como madre mía como no arranque esto a ver cómo accedo si no puedes acceder pues una llamadita a ionos Oye mira tengo este problema Y te ayudan a resolverlo voy a Iniciar sesión y ya está Vale Yes iniciamos sesión y ya estamos de nuevo en el servidor Y si os fijáis pues veis que vamos a ver momentín aquí y aquí vale Y bueno en este caso además otra de las cosas que tenemos que hacer de vez en cuando es eh vamos a ver aquí cuatro actualizaciones se pueden aplicar Ah se ha quedado pillado el navegador vale Ok pues paro la compartición vuelvo a arrancar con partición vale que estos días parece que el zoom va un poquito raro vale Ya lo tengo por aquí de nuevo Vale y siguiente eh de vez en cuando de vez en cuando también hay que ejecutar algún sudo update Vale entonces vamos a ver sudo app update lo estoy ejecutando en el 2025 0116 a las sud update con lo cual actualiza los paetes Vale y 12 paquetes se pueden upgrade vale en 2025 0116 a las también vamos a echar un vistazo a la lista de los paquetes que se pueden actualizar pegar vale estos son los paquetes que se pueden actualizar son paquetes de comunes Mira python 3 Vale pues a continuación voy a pegar aquí vale a continuación en 2025 a las 0116 1542 todavía Pues voy a hacer sudo app upgrade con lo cual sudo app upgrade lo que va a hacer es actualizar todos los paquetes Yes todos los paquetes que estén para actualizar y ya está Vale Eso quiere decir que si le doy a logout Y si le digo otra vez login Yes password pues lo que ocurrirá es que si os fijáis ahora ya no me dice que hay actualizaciones pendientes ni me dice que el servidor necesite un reinicio vale sino que he ejecutado estas operaciones sobre el servidor de forma que pues eh Pues ya está Vale de forma que el servidor pues ya está digamos limpio actualizado y tal debéis tener en cuenta que como siempre os digo el mundo hacker es un mundo muy difícil en el sentido de que pues día a día semana a semana van apareciendo vulnerabilidades en los sistemas operativos losar adores de sistemas operativos van sacando parches y actualizaciones para tapar esas vulnerabilidades pero a la vez los hackers van mirando Cuáles son esas vulnerabilidades para intentar cazar servidores que no hayan sido actualizados para explotar esas vulnerabilidades una vez más os digo no tengo ni puñetera idea de por qué lo hacen pero sé que lo hacen lo cual quiere decir que en el momento en el que tenéis un servidor en producción pues es bueno Es conveniente que periódicamente una vez a la semana una vez al mes pues eh ejecuté una actualización y que En definitiva vuestro servidor Pues siempre esté protegido contra esa gente que como siempre os comento pues intenta entrar dentro de nuestro equipo bien a continuación lo siguiente que vamos a hacer en la clase de hoy de sistemas informáticos va a ser complementar el Software que teníamos anteriormente que es el software cadet blue para realizar copias de seguridad en remoto vale vamos a ver Por qué si yo me voy a Ink escape y abro el esquema sagrado con el esquema sagrado nosotros En un momento dado además de hacer todo esto vamos a propiedades del documento vamos a hacer que tenga 100 vale nosotros en la máquina de producción en una carpeta en algún momento en alguna parte pues tenemos con el programa este que hice llamado cadet Blue tenemos una copia de seguridad tenemos una copia de seguridad quiere decir que o bien de forma manual o bien de forma automática tenemos la capacidad de elementos de aquí y vale o elementos de aquí o de lo que sea y de hacernos copia de seguridad dentro de esa carpeta pero el software cadet Blue que tenemos hasta el momento eh guarda la copia de seguridad en una carpeta del mismo servidor esto quiere decir que si falla el servidor o bien por causas naturales o bien porque un hacker lo tire abajo pues también va a fallar la copia de seguridad para ello hacer una copia de seguridad en el propio sistema Pues bueno bien está bien vale es un primer paso pero lo ideal es tener una segunda máquina algún tipo de segunda máquina voy a poner respaldo Y en este respaldo lo ideal es que de la forma que sea de la forma que sea ahora veremos qué quiere decir eso de la forma que sea pues de forma manual de forma periódica de forma automatizada o con un botón No lo sé pues las copias de seguridad o bien pasen de esta máquina a esta máquina o bien directamente se hagan desde la Fuente original a la máquina remota vale eso ya me da un poco más igual pero que se hagan como se tengan que hacer de tal forma que como veis aquí de color rojo la máquina de respaldo es una máquina diferente a priori No necesariamente conectada con la máquina original con lo cual si por el motivo que sea se cae la máquina de servidor Pues siempre podemos contar con la seguridad de que frontera número uno tenemos un backup en la máquina local frontera número dos tenemos una máquina de respaldo bien yo en este caso insisto eh Hay muchas formas de implementar esto yo os voy a enseñar una lo importante no es la forma concreta en la que yo os lo voy a enseñar lo importante es el concepto de máquina de respaldo si yo me meto en el proveedor momento Uy kubernetes tengo instalado kubernetes vale bueno no lo quería pero vale bien si yo me meto en el proveedor veré que tengo contratado Por una parte un servidor tengo contratado Por una parte un servidor y por otra parte tengo contratado un momento vale el vps y luego por otra parte tengo contratado un Hosting Podría tener contratado otro servidor en este caso tengo contratado un espacio web donde ahora mismo pues eh tengo ilimitados datos tengo un número máximo de 262000 eh archivos vale con lo cual lo que voy a hacer es lo siguiente vamos a verlo me voy a file fila Me conecto a ese servidor es este en ese servidor voy a hacer un directorio llamado copias de seguridad y a continuación me voy a conectar a ese servidor voy a en ese servidor un momento voy a ver ftp vale Este es el usuario que tengo por defecto Quiero crear una nueva cuenta la contraseña va a ser tame 1 2 3 dó nota personal copias de seguridad directorio quiero llegar al directorio de copias de seguridad y guardar okay Así que a continuación Así que a continuación voy a empezar a desarrollar una pieza un software ya podéis ir eligiendo un color Bueno ni lo abro yo abrid lo vosotros decidme qué color elegís para este software de copia de seguridad en remoto y decidme el color y vamos a por ello qué color cogéis así Creo un repositorio vale decidme un color qué color es cogéis vale decidme color alguien que me diga un color do bl que creo que ya lo tengo pillado me suena eh te lo digo no sé para qué pero dodger Blue Sí para el software de mapas mentales medium aquamarine este no lo tengo medium aquamarine pues ahí estamos pues copia de seguridad en remoto vale medium aquamarine Vale pues vamos allá público añado readm Vale ahora en mi Ja me traigo me clono el medium aquamarine vale medium aquamar me lo clono okay Y ahora me voy a edit y digo me voy a bar no me voy a sí me voy a bar me voy a w me voy a html me voy a medium aquamarine vale Y voy a crear un archivo llamado medium aquamarine python bien Dentro de este software voy a hacer lo siguiente esto con el 40 python Script to Connect to ssh creo que es sh Espera que te lo digo sí ssh and transfer a folder and its contents a local folder to server vale con lo cual para mico vale tendré que instalar para mico no hay ningún problema y ya vale vamos a ver copiamos Vale pegamos y ok En este caso sí que me conviene dejarlo como función aquí porque ahora veremos qué carpetas transfiero Finally Vale ahora datos de conexión vamos a ver los datos de conexión el servidor es este el puerto es este el usuario es este la contraseña es tame un 2 3 bien el local folder vamos a verlo es Eh pues alguna carpeta sabes creo que tengo por ahí salmon pues http no Perdona que http bar W no bar c W html y jarsa gu light salmon Remote path vamos a ver copias de seguridad Ok vale transfer vamos a por ello el puerto es el 22 Y si esto es correcto Ahora aquí en el ftp en copias de seguridad no hay nada pero si ejecuto y no da fallo f5 Ah Perdona f5 Espérate que no lo tengo que abrir con hedit sino lo tengo que abrir con idel para que se pueda ejecutar entonces bar W html jarsa medium aquamarine vale f5 No mod name scp un momento que ponga esto en grande para que lo veáis Vale y vale me voy al terminal y digo sudo app install scp break System packages contraseña eh Hola Okay break System packages Ah pues mira qué guay no perdona vale a ver sudo pip 3 install scp break System packages Vale ahora sí y sudo pip 3 install para mico Ok bien Ahora sí ejecuto conectando transferencia esta cuenta ha sido restringida por rssh vale los comandos permitidos son sftp vale Okay no pasa nada muy bien no se habrá hecho nada no hay ningún problema Vale pues no pasa nada lo pasamos a sftp Vale y eh gives this error okay So One convert to sftp and two before copying folder create a folder with año mes día hora minuto segundo and then inside make backup of source folder vamos a ver usamos el soporte de sftp de parico vale Vamos allá usamos para mico f5 Ok vale parece que sí qué me está copiando los objetos de jit Pero bueno ya está pues Qué remedio no hay más remedio que hacerlo otra cosa es que puedo decirle que no me copie los archivos de m de kit Pero bueno da igual lo que sea bien pues me voy ahora a la carpeta en copia de seguridad le digo actualizar Bueno veo que se ha creado una subcarpeta llamada copias de seguridad Vale me da igual ok ahora dentro y esto es lo importante se ha creado una carpeta con 2025 116 15 5929 y dentro tengo la carpeta light salmon vale bueno sí vale No pasa nada porque me ha copiado el contenido directamente vale no hay ningún problema porque si luego selecciono la carpeta maestra pues me copiará todo a la vez vale bien cosas que quiero hacer antes de configurar vale Sí lo sé Fran a una mala se puede poner una regla que diga Porque para la documentación sí que desde luego es muy molesto que te ponga los archivos de git vale Y es no me incluyas una carpeta que empiece por un punto y ya está vale porque Generalmente en un sistema operativo las carpetas que empiezan con punto especialmente en unix son carpetas ocultas con lo cual pues no me incluyas una carpeta cuyo carácter en el índice cer sea un punto y ya está bien Ahora a continuación antes de hacer nada más antes de hacer nada más ahora digo Ok perfect Now export ftp connection parameters tuan external json and load them Y sí Ah Para no sacar documentación de la documentación correcto Sí porque la de doc teóricamente es documentación de o sea integrada dentro de Pero bueno también te puedes hacer por ejemplo una Ray de carpetas eh de carpetas omitidas vale Y a partir de ahí pues podes especificar qué es lo que no quieres que entre en la documentación al igual qu podría hacer con la copia de seguridad O sea que sí sin problema Vale pues vamos a ver le doy aquí o sea le doy aquí a copiar vale pego Aquí y ahora sí con gedit Ahora sí de vuelta a hedit voy a crear un archivo aquí llamado como ftp config js archivo nuevo ftp config.js donde yo de momento pongo esto y a continuación le digo ftp config sample js y quito los datos reales de conexión Así que quito datos reales de conexión guardo y ahora de Cara a implementar en el servidor voy a de hecho hacer otra ejecución para comprobar que Ok que se e correctamente vale Okay Vale está con los archivos de git okay Y comprobamos como en el ftp Ahora hay otra copia de seguridad vale pues una vez que hemos hecho esto Ahora vamos a hacer una implantación en el servidor hemos hecho primero un desarrollo en local el ftp config lo quiero quitar Aunque luego lo voy a poner de nuevo vale Pero para que no se suba a github Así que ignore file vale no se sube ningún dato privado entonces vengo por aquí primer commit vale No hay datos privados por aquí Okay Vale y bueno sí esto realmente no pasa nada vale Okay Push vale a continuación me voy al servidor eh Clear vale me voy ya no aquí W CD html ls y a partir del logo del servidor Pues voy a clonar git clone Eh sí pero no s bueno espera sí que lo quiero crar jarsa y jarsa cómo se llama este que he hecho es medium aquine qué ha pasado permission den Ah Uh vale Espérate Qué sudo git clone pongo Vale ahora sí pongo el pas fras Ok vale Y ya está ya tengo aquamarine dentro de pero ahora a continuación quiero mejorar un poquito más este software quiero mejorar un poquito este software y quiero hacer lo siguiente vamos a ver Now on config file create a New parameter as an array to set folders in plural to be sa to cap server and on python pars that array that list that array vamos a ver bien Eso quiere decir que ahora en lugar de aceptar una sola carpeta en la configuración vamos a poder aceptar tantas carpetas como queramos la novedad estará aquí al final a ver y No espérate aquí Ok dónde lo estás haciendo config folders aquí for folders vale vamos a ver Vamos allá bien Ahora vengo por aquí Ok O sea Perdón esto lo copio y lo pego aquí ahora el config vamos a ver el config lo pego Aquí voy a poner databases Okay en el sample actualizo esto borro esto y borro Esto vale actualizo jad en el servidor Traigo una novedad eh dónde estás gitp en el servidor traigo la novedad no sudo gitp ahí va Ah Sí perdón CD jarsa medium qué medium aquamarine ahora sudit Bull vale Ok venga ya lo tenemos y ahora sí me voy a copiar Esto me voy al servidor no estoy en el servidor parece me he desconectado nu Ok Aquí está Vale ahora sí me voy al servidor y en medium aquamarine cojo el ftp config sample lo renombro localmente en el servidor como ftp config le pego la información que toca que en este caso es igual en el servidor que en desarrollo pero podría no serlo y ahora a continuación y ahora a continuación y ahora a continuación aquí python 3 medium aquamarine ah eh No existe para mico sudo eh pip 3 install para mico break System packages Vale ahora python 3 medium aquamarine con lo cual estoy haciendo copia de seguridad a eh al servidor está con light salmon vamos a verlo ahora me conecto al servidor actualizo y veo que hay una nueva copia de seguridad de las 1615 vale de las no de las 1603 Ah vale es que el servidor está una hora por detrás Sí vale es esta de aquí y veo que está light salmon pero no veo que esté a ver a ver yo creo que no es correcto es databases a ver qué mensajes de error momentín Okay light salmon y databases tu copia de seguridad pues parece que sí que esté no pero no sé Entonces vamos a ver no actualizar no eh vale a ver y no ha dado ningún error no 15 16 pues va a ser que no vale vamos a probar al contrar vale primero databases y luego jarsa light salmon ejecuto Okay 15 12 Okay me voy al ftp actualizo 15 12 vale yo creo que es por los permisos Entonces esto de aquí lo voy a meter con un sudo Ahora sí que lo está haciendo era por un tema de permisos vale Okay por lo tanto ahora sí me meto actualizo me meto aquí y ahora veo que ahí tengo todas las todos los archivos y todas las carpetas lo único que pasa es que me los ha mezclado todos bueno Vale pues si no quiero que me los mezcle todos voy a tocar un poco el programa vale Y le voy a decir no para vale para Ok perfect Bueno voy a el programa original y voy a hacer otra petición y voy a decir a ver y voy a decir Take this program and for each folder saved On config A right list of folders to save First or instead of saving all contents on the same folder create subfolders with F save folder cont vamos a ver si esto hace lo que debe vale vamos a probarlo en primer lugar sobre el local y a continuación lo en producción copio en local pego el config del local es a ver uno nuevo html medium aquamarine ftp config ah es al ready Open Pues a ver Dónde está ah aquí vale hokar salmon databases Vale pues voy a ejecutar primero en local para comprobar si va bien y si va bien lo ejecutamos en producción Vale entonces ahora a continuación nos vamos al servidor nos vamos a actualizar 16 Uy 16 sí ahora Vale y veo que tengo databases y hoc carsa light salmon vale con lo cual ahora sí puedo ir a github puedo actualización subcarpetas puedo hacer un Push puedo hacer un no esto no puedo hacer un Pull sudo gitp y ahora como os digo eventualmente en plan a lo bestia yo ahora podría venir y editar el config en el servidor y decirle Mira sabes qué quiero que me copies toda la carpeta html Vale y toda la carpeta html y luego también igual Quiero la carpeta etc de archivos vale Yo que sé O sea la carpeta que la carpeta etc de configuraciones de virtual Host quería decir vale con lo cual vengo por aquí ahora sudo python 3 eh medium aquamarine le doy a enter conectando y a muerte vale Y cuando digo a muerte lo que quiero decir es que en primer lugar voy aquí actualizo recuerdad que recordad que el servidor lleva una hora de retraso entonces 10 o sea 1518 Esta es vale Y tengo en html y tengo cadet Blue y tengo medium Green y si voy a actualizando veréis como que tarde lo que tarde o sea que tarde lo que tenga que tardar pero sé que me lo va a hacer vale ahora ya obviamente pues lo único que me queda es meter esto en una en un Chon en el cron del Root y por ejemplo decirle que se ejecute cuando yo quiera o sea es decir que se ejecute una vez al día una vez a la semana una vez al mes que se ejecute de forma manual cuando yo lo quiera que me quite las últimas copias de seguridad más antiguas o no O lo que quiera vale pero esta pieza como veis es interesante de hecho el otro día cuando hice el cadet Blue y lo guardé en el mismo equipo pues alguien me dijo Oye pero qué pasa si Peta el ordenador Pues sí vale correcto porque hacer una copia de seguridad en el mismo servidor pues es un mecanismo hacer copia de seguridad pero luego otro mecanismo diferente y eventualmente complementario consiste en pues hacer una copia de seguridad en remoto vale de la misma forma Yo podría replantear este Script para que en lugar de conectarse a un servidor se conectara a dos a tres a los servidores que te dé la gana e hiciera una copia de seguridad en espejo múltiple vale es decir si por lo que sea te plantas en un momento que estás en una organización que tiene tres servidores pues Oye no hay ningún problema quiero decir metemos una Ray de servidores en la archivo de configuración y lo copiamos donde haga falta quiero decir que si os fijáis voy a actualizar a ver cómo va Esto está ahora con sig Green si os fijáis y sig Green Qué está haciendo Ah mira ahora ha pasado a Dark Slate Blue vale Y si os fijáis lo que está haciendo es ir chino Chano lo que le haga falta como si está una hora haciendo copia de seguridad pero de esa forma yo duermo seguro o sea duermo tranquilo sabiendo que el sistema está haciendo una buena copia de seguridad de todo vale Así que vamos a ver bueno esto por aquí lo voy a dejar corriendo ahora os voy a dar pues media hora de descanso hasta la siguiente clase de inglés que es de 5 a 6 y luego ya pues a las 6 retomamos la clase y hacemos dos horas de programación y una de proyecto interdisciplinar también pues así hablamos un poquito del tema de exámenes y el tema de entregas de final de trimestre y eso el otro día Ya comenzamos a hablar pero un poco para volver a reiterar sobre ello y que quede claro y todo eso vale Así que bueno pues vamos allá bueno me dejo esto corriendo vamos a ver ahora está en crimson actualizo vale vemos como ya va guardando aplicaciones y ya está lo que le cueste quiero decir que si le he pedido toda la carpeta v2 W y quieras que no hay unos cuantos proyectos en la carpeta W pues le va a costar Pero bueno no pasa nada que le cueste lo que haga falta otra cosa que os digo otra cosa que os digo es que eventualmente yo podría meter otro paso en el medio que fuera primero comprime la carpeta a un archivo tar y luego trasvasa el archivo tar al servidor Pues por qué no vale o sea lo que quiero deciros es que se claro Sí Fran por eso vale la idea es que así Ahora luego en algún momento entre programación y proyecto interdisciplinar hablamos de los exámenes y así empezamos a preparar qué es lo que Vais a tener que hacer en los exámenes para que todo el mundo venga con el chip correcto yo Fran Siempre os voy a decir lo mismo vale digo lo mismo forever and Ever Y es que si vosotros habéis hecho el proyecto no tenéis que preocuparos del examen pero aparte de deciros esa premisa que siempre va a ser igual Pues ahora luego concretamos un poco más las pautas y Así sabéis exactamente Cómo preparar para el día Exacto del examen vale Así que vamos a parar de momento