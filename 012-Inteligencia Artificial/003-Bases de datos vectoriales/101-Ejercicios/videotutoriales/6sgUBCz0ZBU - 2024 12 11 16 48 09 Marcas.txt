Vale ahora a continuación Vamos a entrar dentro de idle es un programa que o sea idle Perdona python es un programa es un lenguaje de programación que guarda muchas sorpresas y sirve para mucho más de lo que parece por lo tanto yo a continuación voy a hacer lo siguiente me voy a el proyecto vale me voy a el proyecto en la última versión hasta el momento lo voy a llevar a la carpeta de htdoc porque supongamos que está publicado en html me lo voy a guardar como proyecto y me lo pego aquí Ah No espérate todo esto me lo pego aquí y el 91 me lo cargo Así que supongamos que tengo una carpeta de proyecto bien a continuación yo voy a hacer un nuevo software lo voy a llamar un momento que te lo digo a ver lo voy a guardar en dam lo voy a guardar en eh Primero me voy a ir a programación en programación me voy a ir a Mira a persistencia de objetos a ver utizar avanzada de clases no quiero a gestión de bases de datos Vale y aquí me voy a hacer un proyecto donde seleccionad un color vale seleccionar un nombre de color de css3 a ver css colors vale No sé la página es esta que os estoy mostrando voy decir para que podáis ver caded Blue e ese me ha molado no sé dónde está caded Blue fantástico me quedo eso vale Y voy a crear a ver hedit me voy aquí me voy a programación me voy a mantenimiento e no A ver no sé dónde estoy aquí voy a crear un proyecto llamado cadet Blue dentro de cadet Blue Por cierto no lo quiero aquí lo quiero en idel voy a crear nuevo archivo me voy a guardar como me voy a bar me voy a w html dam me voy a Primero me voy a programación me voy a eh base de datos me voy a proyectos cadet Blue y 001 librería os Y esa librería es muy importante Así que digo import os bien una vez que importo la librería os a continuación puedo hacer cosas puedo En definitiva gestionar vale puedo eh trabajar con el caray Puedo trabajar con el sistema vale Puedo trabajar con el elementos de sistema operativo y por tanto voy a copiar una carpeta bien no en primer lugar voy a hacer una carpeta si tengo permisos Claro que obviamente se me tiene que haber dado permisos antes así que eh python os create folder lo que va a ser el comando mkb vale utilizo El Comando mkb y digo osmk bir Y entonces por ejemplo en la carpeta designada vale Cuál es la carpeta designada Pues en Home ubuntu home José Vicente voy a crear una carpeta llamada backups en Home José Vicente todo minúsculas José Vicente y backups copia de seguridad como quieras Si yo ejecuto una vez esto 002 crear carpeta de copia ejecuto le he dado f5 ha pasado de mí ejecuto e Hola Qué pasa aquí vale la primera vez que he ejecutado ha dado correcto pero la segunda vez que he ejecutado me dice file exists vale Ya existe la carpeta José Vicente backups me vengo por aquí caray me vengo por aquí y compruebo como antes no existía pero ahora existe la carpeta backups Así que a continuación para que no me dé error cada vez que intenta volver a crear la carpeta digo 03 y try except Así que digo try intenta hacer esta carpeta except voy a hacer así directamente print la carpeta ya existe continuamos f5 y me dice la carpeta ya existe continuamos y ya no me da un error una vez que tenemos esto a continuación una de las operaciones que quiero realizar dentro de esa carpeta va a ser crear una subcarpeta con la fecha de hoy para eso primero 004 importo librería por tanto importo Time y la continuación dentro de ese try Eh no perdona dentro de ese try no fuera de ese try Quiero crear una carpeta o bien con el unix apoc o bien con la el día la hora el minuto lo que sea vale entonces si yo pongo Time punto espero un poco y aparecerá por aquí vale get daylight c Time local Time vale strf Time en fin y si cojo Time pun Time me da vale si cojo print Time pun time me da este número de aquí que es la era unix vale pero yo entiendo que este número de aquí pues no os hace mucha ilusión porque no es un número muy procesable vale bien entonces digo python Time get hms Perdona yms caray y m d H m s Vale entonces daytime vale importamos daytime Y ahora a continuación quiero esto de Aquí vamos a ver Now daytime y quiero Ahora quiero que me imprimas print Now y print format date f5 vale Este es el Now y este es el format date bien con lo cual yo ahora digo vale esto es ahora y esto es ahora a continuación digo vale oc época es Time pun Time si me permitís lo voy a redondear round para quitar los decimales Así que fecha compuesta es igual a fecha más un guion vale un guion o un guion bajo vosotros decidís punto apoc como esto es un número voy a decirle que me lo convierta a un String Así que al final de todo esto print fecha compuesta f5 y now is not defined Perdón no es Now es ahora Vale y la fecha compuesta es esta de aquí con lo cual si ya he construido la fecha en la que estoy haciendo una copia de seguridad construyo fecha ahora a continuación voy a hacer y guardo una carpeta creo una nueva carpeta claro voy a hacer un mcir no debería darme error vale todo puede ser Así que backups más fecha compuesta voy a ir metiendo comentarios intento crear la carpeta de backups en el caso de que de error eh saco un mensaje por consola ahora atrapo el tiempo actual lo formateo en un formato humanamente entendible obtengo la época la era unix creo una fecha compuesta imprimo la fecha y creo un directorio con la fecha compuesta si yo ahora fijaos que la carpeta backups está vacía vale si yo ahora ejecuto esto Pues ahora se acaba de crear una nueva carpeta con Por una parte la fecha en un formato humanamente legible y por otra parte la fecha ya que estamos vale a la vez al mismo tiempo la fecha en un formato informáticamente más fácil de procesar si yo vuelvo a ejecutar este código veremos Cómo se crea una segunda carpeta vale se crean tantas carpetas como sea necesario bien a continuación un momento voy a ver a continuación lo que voy a hacer es utilizar otro de los métodos de python para copiar una carpeta dentro de otra Así que a continuación 007 copio una carpeta dentro de otra eh aquí python os copy folder into another Ah sh útil Bueno pues Vale pues sh útil bien importo sh útil teóricamente podría hacer esto de aquí Claro que no está mal que en un momento dado rodeos de TR except para comprobar si todo ha ido bien vale recordad Por cierto que esto este Script que estoy haciendo es un Script que está destinado a ser un Script ciego es decir un Script que se ejecuta el solito cada x horas y yo no lo veo vale por tanto ahora analizaremos cómo tratar las excepciones con un programa que es ciego bien entonces digo source folder origen es barra eh vwww html proyecto destino es igual a literalmente esto de aquí es esto de aquí que es la carpeta que acabamos de hacer así que dentro de sh utils copy Ah sí vale pues igual se ha quedado frito vale sí puede ser Entonces cuando eso pasa pues voy a parar la compartición de pantalla voy a volver a compartir pantalla y ya está Vale con lo cual pues nada vuelvo ahora por ejemplo estoy volviendo a python vale confirm Espera que no veo el chat confirm cuando podáis que ahora veis la pantalla de python vale Ok Venga pues si se vuelve a colgar decímelo vale Y ahora a continuación utilizo de la librería sh útil la función copy Tree vale realmente el Core de este programa es esta línea pero claro nos hace falta Todo esto para preparar que esa línea funcione correctamente por supuesto vale Así que origen destino y ya está Vale y cuando digo ya está quiere decir que lo voy a probar pulso f5 e e vale vamos a ver file exists Okay Claro qué ocurre Pues que aquí el sistema intenta crear de nuevo la carpeta Vale Voy a mutear el mkd porque aquí claro como la carpeta de destino no exe O sea existe no deja vale f5 Okay ya está vamos a comprobarlo me voy a backups veo que ha hecho un último backup y a continuación copio y veo que está dentro la carpeta admin con todo el config con todo el crud eh está la carpeta Front con todos los módulos Y con todo lo que yo tenga pero es que si a continuación veis que hay cuatro carpetas vale pero es que si a continuación pulso f5 veo que tengo una quinta carpeta y en esa quinta carpeta está toda la información que tenga que estar con lo cual ya tengo por aquí una primera versión del Script que automáticamente lo que hace es la carpeta de origen y pegarla en la carpeta de destino como os podéis imaginar este Script combinado con un Chrome Tab donde el Chrome Tab ejecute esto cada lo que a ti te dé la gana cada minuto cada hora cada 6 horas cada 12 horas cada semana cada lo que te dé la gana realmente Vale pues te va a hacer una copia de seguridad de tus proyectos Pero sabemos que un proyecto no es solo la programación sino que también es la base de datos por lo tanto mira aquí sí que voy a mantener este mkd y por tanto ahora en la fecha compuesta voy a hacer barra programación porque ahora Quiero una copia de seguridad Espera que 008 programación en una carpeta Vale ahora a continuación vuelvo a ejecutar me vengo por aquí me veo que ha hecho una nueva copia de seguridad y si ahora pincho aquí dentro veo que tengo programación y ahí dentro tengo la programación Qué quiere decir esto pues esto lo que quiere decir obviamente es que a continuación lo que voy a hacer es que haré que python cree otra nueva carpeta llamada base de datos Y en base de datos va a guardar un dump de la base de datos vale y así esto luego lo podéis utilizar o bien para hacer vuestra copia de seguridad de forma manual o bien para hacer vuestra copia de seguridad de forma automática vale Eso ya depende de vosotros bien Vamos a hacerlo y ahora 009 creo una carpeta para la base de datos Así que eh aquí está vale mcir vale me cabir eh fecha compuesta más barra base de datos Okay vamos a no Ah venga Okay bien base de datos vamos a pulsar f5 todo correcto y veo que ha aparecido una nueva carpeta que tiene una carpeta llamada programación y que tiene una carpeta llamada base de datos que ahora mismo es está vacía vale base de datos está vacía bien Vengo a continuación y ahora quiero hacer un mysql doom desde python Así que esto fuera Vale chpt y mysql doom from python copy doom to a specific folder vamos a ver sub process vale Bueno pues Vale bien eh tengo Quiero subprocess quiero ejecutar subprocesos Así que 010 importo sub proceso a continuación meto mis datos vale Y entonces digo servidor es local Host usuario es ahora veremos contrasena es ahora veremos y base de datos es ahora veremos entonces la base de datos es proyecto Apple vale Y ahora a continuación pues vamos a ejecutar un doom vamos a ver momentín make dears vale make de no hace falta porque lo hemos hecho madre de Dios vamos a ver si do folder Ya lo tenemos backup folder no hace falta do file name no hace falta y doom file path no hace falta vale esto no hace falta porque nosotros ya lo tenemos comand es lo que queremos vale Ah file path espérate Okay Vale El Comando es este esto es el servidor esto es el usuario esto es la contrasena Y esto es la base de datos vale que es el comando mysql doom que haríamos si lo ejecutar en la línea de comando Así que 011 llamos al proceso y decimos este esta sintaxis no me hace mucha ilusión entonces digo archivo es igual a open Y entonces digo José Vicente backups fecha compuesta base de datos barra eh No sé vale exportación sql mismo vale Y ahora con el archivo No claro vale no esto no aquí damp file d file es esto de aquí Dónde estás d file vamos a verlo vale arranco un subproceso le lanzo El Comando y me lo guardas en el archivo esto es ya os digo que chat gpt me lo rodea a todo contra except con por si acaso con no sé qué con si existe Me parece muy bien vale o sea muy bien por chat gpt yo de momento lo que quiero hacer es el código lo más directo posible y luego a tiempo de rodearlo con traject steps y con protecciones Pues siempre estamos vale Así que vamos a ver se hecho útil punto copi no hace falta y ya está yo creo que ya Así que si todo va bien Bueno vamos a decirle archivo. Close que siempre vale siempre es buena costumbre y vamos a darle a ver qué pasa Va f5 Okay Vale no sach file or directory me dice no sach file Por qué Porque en archivo tengo que darle dos punos W es decir tengo que decirle abro el archivo en modo escritura vale f5 Okay parece que lo ha hecho parece que lo ha hecho correctamente Así que vamos a ver a continuación que eh vengo por aquí me voy a backups veo que hay un backup aquí al final y veo que en la carpeta de base de datos Pues hay un archivo llamado exportation sql que ocupa 7.9 meg porque qué ocupa 7,9 megas pues Porque recordad que hemos metido ahí unas cuantas imágenes y recordad que las imágenes Pues hacen que al final la base de datos pese qué se va a hacer lo que está en la base de datos pues no está en la programación Así que y tengo por supuesto la carpeta de programación Así que como veis de momento Ahora hay que mejorarlo muchísimo por supuesto pero de momento tengo un Script que está siendo capaz de crear una copia de seguridad de las carpetas este Script lo que haría es empezar a crear copias y copias de seguridad de forma infinita pero este Script se puede modificar como vosotros queráis Cuando digo de copia infinita quiero decir que al final O sea me haría copia de seguridad hasta llenarme el disco duro vale bien otra cosa que podría hacer por ejemplo como comentaba Fran es Conectarme a un servidor o bien de Google Drive vale no tanto como Google Drive porque está muy petado por a una cuenta de ftp es decir a un servidor remoto Vale entonces yo lo que voy a hacer con esto es lo siguiente vamos a ver una vez que tengo todo esto un momento Primero me lo copio en local Vale y digo eh python copy folder no Bueno sí vale Sí copy folder to ftp voy a de ver porque esto lo que voy a hacer ahora requiere mucha de vida bien y veo que hay un módulo porque en python hay módulos para todo vale llamado ftp Así que importo 012 importo ftp lip com compruebo vale todo bien Por cierto podría poner comentarios los que me faltan carpeta de origen carpeta de destino copio la carpeta Ok eh datos del servidor y ahora ejecuto El Comando preparo El Comando de copia creo un archivo de destino ejecuto el proceso y cierro el archivo porque siempre es una buena costumbre bien Así que una vez que hago esto ahora a continuación y he comprobado que el ftp le no me da error no debería eh dónde estás Aquí no vale ahora vamos a ver Remote folder crea el directorio remoto si no existe Vale pues Espérate Pero dónde me estoy conectando Aquí está Vale Voy a bajar para que lo veáis Okay servidor ftp ahora vemos esto usuario ftp contraseña contrasena ftp eh ahí tengo un problema y es que eso vale Y es Que prácticamente todos los servidores de ftp actuales pues me exigen utilizar ftp vamos a ver ftp No espera with sftp sobre ssh compar mico Pues vale Si no tengo para mico que tal vez no tenga para mico vamos a verlo vamos a importar paramiko no hay paramiko así que eh pip install pip 3 install par mico Okay vale Y sudo aunque estoy en el mismo usuario Pero vale Okay Ah sí Bueno da igual el usuario vale Okay me sirve f5 vale Y ya tengo para mico instalado bien Vamos allá no baja vale para mico carpetas Okay servidor ftp puerto ftp las librerías eh A ver te cuento hay oficiales de python y hay librerías que puede crear cualquiera Y tú descargarlas pero para que las librerías lo digo porque eso de que lo pueda crear cualquiera suena en cierta parte Hawai y en cierta parte inseguridad vale las librerías que te descargas a través de pip han sido revisadas por los creadores de python por tanto no puedes subir cualquier cosa y por tanto no te puedes descargar cualquier librería que te fastidi el ordenador Vale entonces eh Puerto ftp usuario ftp y contrasena ftp bien Ahora cogeremos datos reales local folder carpeta local y carpeta remota la carpeta es esta la carpeta remota es esta bueno fecha compuesta claro fecha aquí va a ver vamos a probarlo ahí a ver qué pasa si podemos subirlo al rif porque vale okay Para mico ssh client vale con lo cual para mico Quiero el Host en el puerto con el usuario con la contraseña Vale ahora Quiero crear un cliente cftp quiero utilizar la función de upload folder to sftp el folder es la carpeta local y lo subo a la carpeta remota sftp Close y ssh Close claro tiene que existir vale un ftp real por tanto yo en este caso que voy a hacer Es que voy a crear de forma temporal un ftp real vamos a ver eh Click vale Hosting bueno primero en file fila me voy a conectar a ese Hosting me voy a crear una carpeta llamada backup no existe backup vale Y ahora voy a crear un Hosting voy a crear un usuario de ftp y Okay Vale Amparo Eva esto ya no hace falta ya no están usando estos usuarios son del año pasado Vale y venga y Amparo vale Okay vale creamos una nueva cuenta eh contraseña Pues tame un do 3 dó vale vamos a verlo la contraseña estame un 2 3 dó clase dam directorio Pues el directorio quiero que sea en backup vale en backup y ya acordados la contraseña por tanto la contraseña es Dame un 23 el servidor es este de aquí es decir es un servidor real Okay el puerto es el 22 siempre es el 22 y el número de usuario es este de aquí si esto va bien que Yo calculo dudo mucho que funcione la primera vale pero Vamos a intentarlo si esto va bien pues lo que va a hacer es hacer una copia de seguridad y luego el contenido de esa copia de seguridad y subír Melo al sftp vamos a comprobarlo f5 Okay upload folder to fsp is not defined Ah sí okay Claro vale Por qué Porque eso es una función Aquí está bueno voy a como esto es un poco rollo voy a copiarla entera A ver la pongo por aquí arriba luego la puedo externalizar a otra parte vale Es que aquí lo que hace es iterar elemento a elemento de la carpeta e ir subiendo archivo a archivo y carpeta a carpeta en la carpeta lo cojo la función ya hecha porque es un poco rollo le doy f5 vale está subiendo archivo y ya está O sea ya está quiero decir que solo tengo que esperar a que el ftp acabe de crear vamos a comprobar que me sube tanto los archivos como la base de datos subiendo exportación y ya está el Script ha finalizado ahora a continuación me voy al ftp me voy a la carpeta backup y veo que me ha creado un directorio y veo que en el directorio me ha puesto tanto la base de datos como la programación y ya está vale Así que pues un poco que veáis demostrado que no solo podemos crear una copia de seguridad de una carpeta no solo podemos crear eh una un Tum de la base de datos también podemos subir con ftp todo esto automatizado vale Y con la productividad optimizada gracias al uso de librerías donde python tiene infinidad de librerías para hacer lo que nos dé la gana esto se podría hacer en php pero es que el lenguaje más natural para hacer ese tipo de cosas es python y de la misma forma que creamos una web también o sea es que la otra mitad de crear una web es crear ese tipo de utilidades para asegurarte que tu página web está protegida Vale entonces voy a comentar un poco el código eh datos de conexión al sftp carpeta de origen en mi ordenador carpeta de destino en el ftp Y entonces arranco un cliente ssh acepto la clave de licencia me conecto Espera voy a bajar esto porque en una línea es un poco duro de leer ahí me conecto por ssh abro una conexión sftp en el ssh subo recursivamente cier el sftp y cierro el ssh insisto y asunto solucionado Vale pero no quiero acabar aquí quiero más cosas esto es 013 subo por ssh voy a hacer una cosa voy a eliminar el usuario del ftp ahora comentaré también el código vale para que no me quede un agujero de seguridad entonces aquí classe dam backup vale elimino este usuario Okay eliminar vale Y ya y ahora pues este código obviamente os lo dejo por aquí comentado para que en el futuro pues obviamente pongáis vosotros vuestra vuestros datos vuestra información vale Y ahora a continuación 04 comento la parte de ftp es decir eh voy a poner un doc String y voy a poner un doc String es decir desactivo esta parte para que se quede durmiendo pero la tendréis en el repositorio para cuando queráis simplemente para volver a activar y poner los datos de vuestro servidor y ahora a continuación a medida que yo voy haciendo copias de seguridad locales pues me encuentro que se me empieza a llenar el servidor es decir se me empieza a llenar el servidor o eh o lo que sea vale o el ftp o el Google Drive o lo que sea y yo digo por ejemplo quiero guardar copias de seguridad pero solo quiero guardar las cinco últimas vale Y cuando digo solo quiero guardar las cinco últimas lo que quiero decir es que vosotros podéis hacer lo que os dé la gana la guardar cinco últimas guardar las 10 últimas guardar par impar guardar yo que sé vale las cinco últimas pero me quiero quedar una de cada semana es decir podéis hacer lo que os dé la gana bien para ello yo a continuación ahora 015 repasar las subcarpetas de una carpeta Y entonces digo la carpeta es la carpeta de destino momentín espera quieto Aquí está fecha compuesta Y entonces digo carpeta copias es igual a esto de aquí Así que ahora utilizando la librería os get list of folders in folder un momento voy a hacer un scand esto un list vale Y entonces digo eh carpetas es igual a os ldir de carpetas copia entonces digo for carpeta in carpetas print carpeta y eh y y perdón y aquí y f5 vale Y tengo la e quieto no no me estás contando programación y base de datos no fecha Ah Sí perdón backups vale Okay f5 las carpetas son estas de aquí ahora a continuación yo digo Vale pues Quiero la fecha EPOC es igual a eh carpeta punto split de el guion bajo y me quedo con el número uno print fecha apoc Vale y tengo el fecha época Cuál es el fecha época actual el fecha época actual es round Time con lo cual tengo para cada carpeta la fecha de la carpeta y la fecha actual la fecha de la carpeta y la fecha actual vale Así que ahora a continuación momentín 1703 1711 17 31 vale pero aquí estará ahora lo veré vale la 31 será prácticamente AC enada y entonces yo vengo y digo lo siguiente vamos a ver si fecha époc es menor espera esaa si ABS de fecha EPOC menos round de Time pun Time es menor no es mayor que no sé 60 Segundos por 10 minutos vale es decir si la diferencia de tiempo entre la fecha de ahora mismo Perdona la fecha de la carpeta y la fecha de ahora mismo es de hace más de 10 minutos en ese caso quiero eliminar la carpeta e quieto el Espera que python no tiene los paréntesis o sea estos paréntesis Sí pero este paréntesis no vale Y pues lo que quiero es quitar la carpeta vale con cuidado siempre que en python eliminamos algo Hay que hacerlo con mucho cuidado y mucho respeto Entonces vamos a ver aquí vale chat gpt python remove folder ya os digo con cuidado r medir vale digo osr medir home José Vicente backups más carpeta si todo va bien si todo va bien madre mía Qué nervios tengo es que siempre que se hace un remove un delete un remove th vale hay que tener mucho cuidado porque quieras que no estamos quitando cosas vale estamos borrando cosas f5 ok Qué pasa String and in muy bien fecha EPOC Qué es Pues será que fecha EPOC no es un entero por tanto voy a poner un entero y ya está Vale f5 ahora qué pasa directory not empty claro es que directory not empty efectivamente vale delete espérate Sí pero he utilizado RM qué he utilizado Ah no RM Ah ahí ahí RM Tri O sea más peligroso todavía pero venga hemos venido a jugar aquí RM f5 No tiene Ah es que es sh utils s Perdón es sh utils que ya lo tenía importado por arriba vale Y es sh útil punto rm3 f5 Ahora sí Y entonces Mirad habían un montón de carpetas pero yo ahora vengo aquí hola e Ah bueno Espérate eso son las y la última carpeta es de las 1727 por debajo de las 1727 no hay nada por debajo de las 1727 lo he eliminado vale de hecho ahora a continuación Mira si queréis vale voy a decir que por 5 minutos ejecuto y Mirad lo que pasa en esa carpeta ejecuto f5 y Mirad lo que ha pasado en esta carpeta vale hay menos carpetas con lo cual En definitiva de lo que se trata un poco de lo que os estoy enseñando ahora es de que veáis lo que llevo días diciendo y es que nos hayamos metido en php no quiere decir ni mucho menos que hayamos abandonado python al contrario vale Cuanto más e Cuanto más grande se haga nuestro proyecto más riesgo tenemos de perder información porque claro antes cuando teníamos una mini página web pues es como Oye pues si se pierde la página web pues se pierde la página web ya está para lo poco que nos había costado Pues tampoco pasaba nada pero claro Cuanto más tiempo pasa más compleja es la página web más tiempo le dedicamos Especialmente cuando la pongamos en un servidor real pues Oye podremos preocuparnos y podremos no dormir por las noches y podremos pensar Oye qué va a pasar qué ocurre si me hackean la página web qué ocurre si el servidor se cae qué ocurre si me entran qué ocurre y lo que sea Vale pues un poco la idea es deciros que eh Yo solía decir esto os sí no perfecto o sea un momentín para borrar secretos de forma automática lo que no entendido es lo de borrar secretos porque copia de seguridad Sí pero qué quieres decir con borrar secretos o quieres decir borrar cosas del disco duro que no interese sabes no sé O sea hay muchas más aplicaciones con respecto a la que Ah vale Ya te Pillo vale tú estabas pensando en otra aplicación diferente Pero sí En definitiva con Chrome Tab o sea Chrome Tab ejecuta lo que tú quieras ejecutar cada x tiempo y esto lo que hace Es que hace lo que tú quieras hacer una sola vez vale ese lo que quieras hacer pues puede ser Buscar en tus carpetas y eliminar cosas que no te interesen o incluso podría ser borrar la cach de Chrome si no te interesa mantener la cach porque con los meses se va haciendo gigantesca Yo qué sé O sea quiero decir que yo os lo estoy enseñando aplicado a un contexto muy concreto que como es un servidor web pero luego obviamente pues lo podéis aplicar y lo podéis utilizar por supuesto a lo que queráis vale bien Vamos a ver vamos a ver y ya puestos vamos a eh os voy a enseñar otra de las cosas que molan mogollón de python y que no es que no tengamos en php pero hacer lo que os voy a enseñar ahora en python es s sencillo pero en php pues no lo es tanto bien Vamos allá vamos a vale voy a cerrar por aquí vale Y voy a hacer algo que en su momento ya hice bien antes me habéis dicho proyecto cadet Blue vale decidme otro color css vamos a hacer otro proyecto en css vale No sé el color que queráis Igual me diréis alguno que ya tengo pillado para otro proyecto vale vosotros decidme y ya os digo yo no indigo ya lo tengo pillado Lo siento vale indigo Mirad si entráis en mi ftp veréis que índigo ya lo tengo aquí pillado para un proyecto que bastante an un momento por aquí hay dodger Blue y tomato vale tomato No sabía que existía tomato es que bueno si es color rojo pqrs tomato vale Ok y dodger Blue a ver dod Blue Es que yo cogería dod blue pero es que me gustan mucho los colores azulados verdosos vale pero es que al final me dejo todos los colores cálidos con lo cual pues vamos a el color tomato vale vamos a crear el proyecto tomate para crear el proyecto tomate eh Me voy a voy aquí me voy a hacer un archivo nuevo me voy a crear el proyecto tomato luego tengo que hacerme una lista de los colores que voy usando para no duplicarlos Claro bien y eh Me voy a crear aquí en dam en primero en programación en gestión de bases de datos proyectos y tomato ay no tengo creado a qué rollo primero programación gestión proyectos tomato Vale y subo y proyectos y tomato y 001 os voy a enseñar una librería que creo que gustar mucho llamada mat plot Le bien eh No sé si la tengo instalada vamos a verlo import no eh No no Espera que tiene su sintaxis especial python import mat plot lead y me dirá importar mat plot le as plt per que te lo digo lo sabía esto Ah p plot Eso es lo que me estaba dejando bien Vamos a ver si tengo mat plot Liv instalado f5 y parece que sí bien me la habrá instalado alguna otra librería Ah por cierto otra cosa que quería hacer yo es a ver list of all css3 colors ya sí los basics pero los alis Blue ya pero bueno má Vale me da igual a ver un momentín y me voy a ir apuntando en una hoja de cálculo los que voy utilizando para no duplicarlos vale Okay y ya está así vale Estos me los voy a copiar me voy a ir a Drive Sí creo que sí pero hoy la idea no es solo instalarla Efectivamente es para crear gráficos sino la idea es utilizarla para algo concreto bien eh Alice Blue vale he utilizado Alice Blue Sí he utilizado no acuerdo la verdad Blue Violet Dark cian he utilizado crimson cadet Blue Dark kaki y del resto me tengo que acordar índigo eh Orange también había usado pero creo Ah sí Orange aquí está y ahora tomato vale Okay veremos Creo que me estoy dejando alguna Pero vale bien entonces Ah y no crimson a los de segundo Sí vale correcto Okay creo que alguno me dejo Pero bueno ya veremos bien y ahora una vez que tenemos esto lo que quiero es eh crear un gráfico de vamos a verlo eh A ver un momentín vale lo hicimos esto ya lo teníamos hecho a ver lo hicimos para crear un archivo de texto con los el rendimiento del equipo Espera que te lo digo vale python get System load only processor okay muy bien importo PS útil 002 importo útiles de procesos vale Y ahora cpu load Muy bien carga y eh print carga f5 no sé por qué hoy el f5 está raro aquí vale 15 con1 13 con2 vale lo que sea bien Ahora a continuación 003 guardo en un archivo guardo en un archivo quiere decir que archivo es igual a Open carga txt vale Y en modo pend archivo. write carga y archivo Close por tanto f5 eh write must B String No pasa nada Pues te lo convierto a String Okay bien Vamos a ver si es cierto que en esa carpeta existe un archivo llamado carga vale y 14,1 muy bien vuelvo a ejecutar Okay y 14 con1 Bueno sí porque aquí tengo que encadenar con un contrabarra n para que me baje de línea así que f5 y Vale 13,8 y f5 y vale 13,6 la primera parte lo que hace es escribir abrir un archivo y cargar eh la el rendimiento del sistema Pero ahora a continuación esta parte es espera escribo esta parte Bueno ahora pondré comentarios línea a línea y ahora digo archivo es igual a Open carga txt en modo read Ahora quiero leerlo y digo líneas es igual a archivo readlines Así que print líneas f5 y tengo bueno tengo las líneas con el contrabarra n no Mola nada bueno no pasa nada porque puedo hacer varias cosas por línea in líneas línea es igual a línea pun str replace creo que es replace contra barra n con nada y esto lo quiero en entero es decir le quito el contrabarra n y lo convierto a entero print líneas eh dos puntos falta e invalid literal un momentín vale Sí python String replace vale old New Okay a ver línea replace Ah ya pero no me ha reemplazado un pimiento vale Ya Vale pues limpias es igual a esto y ahora línea es igual a int línea A ver f5 aquí está problema Ah hostias Ah perdón no puede ser int claro no puede ser int vamos a poner float claro Vale y limpias punto apen línea con lo cual print limpias y ahora sí paso de tener una lista con strings a tener una lista pues un poquito más limpia con números flotantes qué es lo que quiero ahora Bueno pues lo que quiero ahora es generar un eh una gráfica de barras por ejemplo pero no quiero generar la gráfica de barras en cómo te diría yo en para verla en pantalla sino que lo quiero guardar vamos a probarlo vengo por aquí y digo vamos a ver okay mat plot Live simple Line Chart Quiero El ejemplo más sencillo que en toda mi vida pueda vale claro 0 1 2 3 45 vale with only one list of Data eso posición natural eso es lo que quiero Vale pues plt pun plot quiero plotear limpias ya está así que f5 bueno y p plot pun show Espera que te lo digo plot punsh f5 y ahí lo tenemos vale desde el 14 por de carga hasta el 13,2 y me va diciendo el rendimiento las últimas veces que lo he ejecutado Quiero poner el máximo y el mínimo vale índice valor title eso me da un poco igual eh quiero plot grid eso sí que Mola Así que plot grid y quiero eh set min value 0 Max value 100 porque así por defecto lo que hace mat plot le es que me hace un autozom a la Gráfica que está Guay para muchos casos pero en este caso no vale Así que esto es Ah mira aquí plot y limit de 0 a 100 y no quiero x limit Así que f5 Ok vale eso es lo que tengo Eso es lo que quiero y por lo tanto Bueno luego por ejemplo puedo guardar en el eje X La fecha vale Pero lo que tengo por tanto es una gráfica del rendimiento del procesador en los últimos minutos otra cosa que puedo hacer por ejemplo es que me puedo abrir como os digo estos días lo hicimos la otra vez me puedo abrir Blender puedo abrir a ver Blender aquí puedo abrir Blender y Vale y cargo algo en cpu Okay vale Y entonces con esto pera voy a ponerle 4096 poder ya a ver va algo más duro a ver venga a ver un material Si no cargo algún proyecto que tenga por ahí persona coche Mira coche ya está ahas sí agua también vale hace que se ralentice entonces cpu tiro por aquí vale Ok Y entonces ahora ejecuto vale Y me lo guarda vaya usa más cpu vale Okay Vale y f5 y sale la Gráfica y ahora continuación cierro Blender y ahora vuelvo a ejecutar y comprobamos que es cierto que el sistema detecta vale detecta cuando el consumo de cpu sube pero esto como ya os digo pues eh me está haciendo una gráfica ahora mismo que me la Está sacando en una ventana cosa que está super guay pero yo no quiero esto yo lo que quiero es que me lo guarde en el disco duro Bueno pues esto me lo puede guardar en el disco duro Así que 005 guardo figura Cuando digo figura quiero decir que se llama literalmente save fig la instrucción y pongo carg cpu jpg así que f5 no ha ocurrido nada vale parece que no ha ocurrido nada pero en la carpeta me voy a tomato y en la carpeta ha aparecido un archivo llamado carga cpu jpg archivo que yo Por supuesto abro y tengo un jpg esto que quiere decir pues esto quiere decir que yo ahora a continuación me puedo ir vamos a ver Mira voy a hacer algo rápido con chat gpt vamos a ver html load jpg and show it on screen Center with a title using flexbox create professional Looking css Y eso quiere decir por tanto que yo o sea que los scripts que creo de servidor no tienen por qué ser scripts ciegos sino que pueden ser scripts que se Ejecutan de forma automática mediante un cron pero ese Script me puede dar un resultado visible esto quiere decir que me voy a hedit me voy al proyecto tomato me hago un archivo nuevo Index html y yo pincho por aquí me voy a aquí esto es rendimiento del servidor y la imagen es carga cpu jpg si ahora me voy a local Host me voy a dam me voy a Primero me voy a programación me voy a proyecto no me voy a gestión de base de datos proyectos tomato y hago así pues veo que tengo la Gráfica de rendimiento del servidor que luego creándole de servidor para cuando yo quiera consultarla y por supuestísimo ahora lo que voy a hacer es crear un Chrome Tab donde en el Chrome Tab Pues voy a llamar a ese archivo de python Entonces vamos a verlo vamos a comprobarlo Oh vamos a ver vale momento que es guardo figura este archivo propiedades esto es abrir carpeta padre No yo lo que quiero es copiarlo pero ya creo que no ya sí pero no a ver Esto es lo que quiero Ah vale Ok Muy bien Vamos a ver espera crado execute minute y ya sabéis que el hecho de que est tan escondido pues no Mola mucho pero bueno lo que hay vale Okay Vale cron B vale al final del todo pongo esto Ah mira con los caracteres de escape fantástico bien y pego Okay guardo salgo con un ta list Ok vale Y ya está así que me aseguro de que tenga permiso de ejecución Sí y ya está claro No estoy registrando errores bien mal hay que vale tomato Y lo que sea Pero bueno no estoy usando entorno virtual pues vamos a esperar Ahora me voy aquí al servidor esto es la Gráfica que tenía hace un momento acordaos que aquí al final a la d hay dos puntos más entonces recargo voy a probar no de momento no momentín si no lo meteré en el Chrome Tab con sudo Vale pero vamos a ver si se ejecuta con el Chrome Tab de usuario recargo No todavía no H V a ver voy a recargar No pues yo creo que tendré que meterlo en el de sudo Chrome Tab e vale me voy abajo del todo eh Me copio Esto vale otra cosa que digo es que no hace falta el user Bin Oh Sí vale no hace falta el user Bin porque con python 3 me vale Así que control o control x sudo Chrome Tab l Vale y vamos a verlo a ver installing New chom Tab vale vamos a esperar un momento no eh espera un momento porque esto dónde me está guardando dónde me está guardando por claro creo que ya sé dónde está el problema está en que aquí en la carpeta le tengo que decir Guárdame esto en aquí porque si no creo que me lo está guardando en la carpeta de la cual se está ejecutando el Script no vamos a verlo esperamos un par de minutos al final es un tema de rutas ya sabéis que el crontab siempre cuesta un poco de hacer funcionar pero una vez que funciona pues ya se queda ejecutándose para siempre por supuesto de la misma forma que he hecho un análisis de rendimiento de cpu puedo hacer otro análisis de ram y realmente puedo hacerlo en el mismo archivo incluso vamos a ver No todavía no pues ya se Au para para Qué ha pasado por qué tienes dos archivos Ah a tienes dos archivos porque me lo estás guardando en carga txt vale pues lo mismo carga txt usa el de esa carpeta vale un segundo porque sab que en alguna parte del disco duro me ha creado ahí un archivo txt igual está en la carpeta etc o user a ver por supuesto yo aquí luego con matplot Li puedo personalizar e la Gráfica pues por ejemplo para que en lugar de ser de una línea sea de barras si supera el 80% que me pinte la barra de rojo para saber que tengo una sobrecarga en el procesador Yo qué sé Luego también puedo usar librerías Pues de correo electrónico o de ftp o de lo que sea para decir si el servidor supera el 100% de carga Envíame un correo electrónico vale cosas así vamos a ver voy a recargar Vale ahora sí Bueno ha vuelto pero qué pasa aquí pero me sigue poniendo dos puntos no me cuadra eso no me cuadra porque eso quiere decir que sigue haciendo la Gráfica con el archivo de texto correcto pero deberían aparecer más puntos ya vamos a ver recargamos No todavía no Qué cosas Bueno pues ahora calculo que en algún momento aparecerá todo esto ya sabéis que desde el punto de vista de el sistema informático en el que vamos a trabajar pues son scripts que tendréis que instalar y poner a funcionar en vuestro servidor para demostrar que no solo sois capaces de hacer un deploy sino que también sois capaces de pues instalar herramientas sobre el servidor que os permitan tener un control y un mantenimiento y os permitan asegurar la integridad del proyecto otra cosa que os voy a decir vale vamos a hoy al final parece que vamos a hacer un poco de tarde de python vale otra cosa que os voy a decir otra posible utilidad voy a dejarme el proyecto tomato ahí por ejemplo por ahí Li Bueno no sé igual para el Chrome Tab Es que tampoco me Mola que el Chrome Tab esté ahí funcionando sin yo saberlo vamos a ver otra cosa Vale que podemos hacer otra utilidad del servidor e insisto utilidades de servidor hay millones e qué te iba a decir yo qué te iba a decir yo voy a parar el Chrome Tab paro el Chrome Tab y ya está lo dejo aquí durmiendo control o control x y ya está bien otra de las cosas contra las cuales me quiero proteger aparte de copia de seguridad es que quiero detectar Si alguien me ha corrompido si alguien me ha editado si alguien me ha infectado los archivos de mi proyecto web cómo lo puedo saber Bueno pues una forma de saberlo es mediante una cosa que se llaman hashes que de hecho muchas veces en internet lo habréis oído a continuación yo me voy a crear otro proyecto Así que decidme otro nombre de color css porque vamos a crear un nuevo proyecto Mira espera el que había hecho antes dodger Blue vale voy a crear el proyecto dodger Blue me lo voy a poner en la lista de aquí vale me lo voy a poner en la lista de colores utilizados dónde estás página y Uy eh A ver reciente hoja de cálculo sin título vale proyectos colores y ahora voy a usar do y Blue do ahí bien Ahora a continuación voy a vamos a ver vale voy a crear pero con python un archivo nuevo me lo voy a guardar en la carpeta de bar w html dam primero programación gestión de bases de datos proyectos dodger Blue bien 001 importo os Así que import os a continuación sabemos que tenemos el listado de directorios listado de directorio quiere decir que carpeta es igual a bar ww html y proyecto ahora a continuación digo carpetas bueno espérate s carpetas es igual a os.dir carpeta Y entonces digo for carpeta esto es ruta y esto es ruta carpeta en carpetas print carpeta Así que vengo por aquí Así que vengo por aquí y ejecuto Espera que hoy no sé por qué Aquí vale ejecuto Y me dice que tengo Front admin y back a continuación voy a hacer lo siguiente vamos a ver sí pero 003 recursivo con ruta completa Okay esto es por aquí no get all files recursive show full path vale okay Y esto es vale Así que print y tengo un listado de todos absolutamente todos los archivos que tiene el proyecto La idea es la siguiente en un momento dado cuando un proyecto se pone en marcha puede cambiar la base de datos puede cambiar la carpeta de imágenes si hay carpeta de imágenes pero los archivos del código fuente de un proyecto una vez que el proyecto está publicado No ya en desarrollo obviamente porque es el proyecto está en desarrollo somos nosotros los que estamos cambiando el código constantemente no me refiero Cuando el proyecto ya está publicado en el servidor teóricamente los archivos no deben cambiar bien pues lo que voy a hacer en este caso va a ser para cada uno de los archivos calcular su Hash el Hash es una mezcla entre la fecha de creación del archivo y el contenido la longitud del archivo vamos a por ello vamos a por ello y ahora digo Ok tomar vamos a ver fecha de creación y longitud en bytes Así que hago así get creation no last modification time date and bytes vale Y aquí copio pego f5 y para cada uno de los archivos vale para cada uno de los archivos lo que voy a hacer es que me voy a guardar esta información dentro de un Jason Es decir me voy a guardar la información dentro de un archivo que yo bueno que tenga una estructura definida que tenga una estructura esperable vale Así que por tanto Ah a continuación formateo 005 me lo guardo como un J son Y entonces digo vale Ok esto no hace falta y el por Ah sí vale esto es por 40 para el separador fantástico bien Y entonces digo registro es igual a lista registro punto pen creo un diccionario y digo ruta es ruta completa tiempo es tiempo Ah tiempo modificación fecha vale tamaño bytes ahora importo J son y digo al final del todo aquí al final del todo digo archivo es igual a registro a Open registro pun Jason en modo write en modo escribir bien y digo jsdom en el archivo vuelco el registro con indent es igual a 4 y archivo. Close el es igual a cu Igual me lo va a escupir Ah tamaño Qué pasa aquí que falta una coma venga indent Ya decía yo que el indent me lo iba a escupir a ver indent Ah fantástico es indent no eh A ver a ver Espera espera que dice que tampoco está bien js doom registro archivo claro lo he escrito al revés registro en archivo vale No is not sería la B espérate a ver me extraña mucho que diga eso Ah daytime Ah sí correcto punto str Ah Wow vale fecha modificación Ok bien y si todo va bien Ahora me voy a hedit no sé dónde está hit me voy a dodger Blue y tengo un jas que guarda como una especie de freeze vale como una especie de eh proyecto congelado donde yo por ejemplo hago un deploy y al hacer un deploy en ese momento digo free vale o sea hazme una imagen porque como esté el proyecto ahora mismo es como tiene que estar qué es lo que voy a hacer a continuación Bueno pues a continuación lo que voy a hacer es leer ese proyecto o sea leer ese archivo y elemento a elemento voy a ir viendo si hay alguna modificación o si haber cuidado por aquí bueno utf8 Vale Esto es lo de menos voy a hacer tamano vale me da un poco de rabia que el utf me machaque las cosas Pero bueno Okay tamano bien pues ahora a continuación lo que quiero es lo siguiente vamos a ver python check If file exists 006 compruebo si existe porque si existe Léelo pero si no existe créalo Y si file pa exist Vale entonces Ok Vale y digo Si archivo si registro j en ese caso Haz una cosa en caso contrario haz otra Aquí voy a poner print existe vamos a leerlo str bueno Vale archivo es igual a registro js y archivo exist momento no me queda Ah no no no ruta archivo esto es ruta archivo Okay path is not defined Ah from p le import pa Okay existe vamos a leerlo vale no existe momento dónde estás estoy en dodger Blue no existe lo creo vale no existe lo creo ahora existe vamos a leerlo existe vamos a leerlo lo que quiere decir a continuación Es que voy a leerlo y voy a comparar la lista con respecto al archivo entonces Leo el archivo y digo archivo es igual a Open en modo read json load archivo Y esto es diccionario es igual a j son load archivo. Close Aunque para leer tampoco hace mucha falta y print diccionario f5 vale Y ahí tenemos el diccionario esto quiere decir que tengo print diccionario y print dónde estás y print registro vale print el diccionario está ahí está escondido y ahora print registro qué diríais que voy a hacer Pues voy a ir uno a uno vale voy a ir elemento a elemento voy a comparar elemento a elemento para comprobar si ha habido algún cambio o no ha habido algún cambio Es decir lo que estoy haciendo aquí es leer la carpeta y luego la voy a comparar con lo que tengo en el registro pun json ahora a continuación 007 repaso lista contra lista es un proceso que computacionalmente es muy extenso pero lo hace automáticamente python bueno automáticamente si le decimos que lo haga claro y digo for diccionario in diccionarios y ahora digo for registro es que registros bueno for dato in registro entonces digo si diccionario de qué diccionario punto creo que es punto diccionario punto ruta es igual a dato pun ruta di print Ok f5 esto es Ah diccionarios claro es que es Ah es que es diccionario for entrada in diccionario venga has no attribute ruta no es ruta si es ruta Sí vale pues igual es porque no lo quiere en esta sintaxis y lo quiere en esta sintaxis dato ruta Okay es OK es Okay Vale bien ok quiere decir que está encontrando coincidencia Y entonces ahora digo sí entrada de bueno está aquí de fecha es igual a dato de fecha and entrada de tamao es igual a dato de tamano en ese caso eco Ok pero en caso contrario eco no es ecoprint Perdón ya estoy yo con la mente en php pero en caso contrario print el archivo coma entrada ruta ha sido modificado vamos a probarlo f5 y me dice Ok Ok vale Yo ahora a continuación lo que voy a decir es que en lugar de tanto Ok 008 lista de incidencias el print Okay no voy a hacer nada voy a poner un pas y voy a aquí crear una variable que va a ser incidencias es igual a 0 si hay una incidencia incidencias más igual a 1 y ya está y al final del todo al final del doble bucle for print han ocurrido incidencias coma incidencias f5 voy a quitar el print vale porque es un poco traumático f5 han ocurrido cero incidencias vale Pero ahora a continuación vamos a forzar incidencias para forzar incidencias yo ahora a continuación puedo hacer lo siguiente me voy a ir a dónde está hedit No está me voy a ir a hedit recargar vale me voy a ir a proyecto y en Front en el módulo en el bloque un archivo en este vale o en php no sé dónde sea vale aquí voy a poner virus lo cual quiere decir vale que pongo virus como que queriendo decir que alguien me ha insertado algo sin mi permiso vale alguien se ha metido en mi servidor sin mi permiso por lo tanto ahora ejecuto de nuevo el Script de python y si lo he programado bien f5 y me dice han ocurrido una incidencia el archivo bar proyecto from módulos blo php ha sido modificado y ahí lo tenéis vale con lo cual ahora ya sabéis que podemos actuar de muchas formas podemos guardar un registro en un archivo de texto para que el administrador lo consulte cada x tiempo se puede desde python enviar un correo electrónico al administrador para que pues este Script haga un repaso no sé sabes cada hora cada día cada semana cada lo que te dé la gana por esa carpeta Y si encuentra una incidencia le envíe un correo electrónico al administrador y le diga e atención alguien te ha cambiado algo en el vale en el servidor O de hecho incluso dentro de que en principio lo que debería ocurrir es que un administrador se debería conectar al sistema y debería restaurar la última copia de seguridad que insisto vale Eso debería hacerlo una persona humana Eso debería estar bajo supervisión humana pero también puedo hacer que el sistema dado que la copia de seguridad me la ha hecho el sistema pues puedo hacer que el sistema automáticamente en cuanto detecte un archivo modificado se vaya a la última copia de seguridad busque la versión sana de ese archivo la copie encima de la carpeta y por tanto machaque al cambio al virus que me haya intentado insertar cualquier persona vale externa todo eso ya os digo o bien con supervisión humana o bien sin supervisión o bien avisando por correo al administrador o bien lo que sea vale pero como llevamos unos cuantos días con python Pues un poco parece que Perdón lamos unos cuantos días con php quería decir pues parece que nos hemos dejado un poco olvidado a python y parece que python de repente ya no nos sirve para nada no absolutamente que no vale esto que estoy haciendo hoy pues como poder se podría hacer con php porque técnicamente se podría hacer con php pero la magia de python es esto de aquí la magia de python es que tienes un montón de librerías disponibles si la librería que estás buscando no es está en tu sistema Te la puedes instalar de forma muy sencilla con lo cual pues yendo al esquema vale vamos al super esquema esquema sagrado vale acordaos que esto es lo que os he enviado antes por correo Vale entonces Esto es lo que llevamos trabajando desde el principio es decir eh el tema de trabajar en el entorno de desarrollo y en el entorno de desarrollo a partir de aquí pasar al entorno de producción hacer el deploy que hemos comentado anteriormente Bueno pues ahora estamos haciendo esta parte que Espera que se me ha apagado el monitor estamos haciendo esta parte que tenemos aquí abajo realizar programar una serie de utilidades tal que en un momento dado pues eh De vez en cuando estas utilidades se ejecuten y hagan insisto vale lo vuelvo repetir y hagan absolutamente lo que queramos Cuando digo absolutamente lo que queramos lo que quiero decir es que Eh Pues he puesto hoy tres ejemplos de cosas que se pueden hacer con python pero es inimaginable lo que se puede hacer vale no os podéis imaginar la cantidad de cosas que se pueden hacer con el lenguaje de programación python no puedo no digo que se pueda hacer absolutamente de todo pero sí que hay un montón de cosas que sí que se pueden hacer bien Vamos a continuar extendiendo el Script de Ah el Script de antes vale el de un momentín el de tomato vale guardo figura Okay bien y vamos a ampliarlo un poco más voy a beber un poco un momenti en cuanto a horas teóricamente en qué clase estamos a ver espera semana vale en cuanto a ahas Pues voy a hacer una cosa la grabación de antes