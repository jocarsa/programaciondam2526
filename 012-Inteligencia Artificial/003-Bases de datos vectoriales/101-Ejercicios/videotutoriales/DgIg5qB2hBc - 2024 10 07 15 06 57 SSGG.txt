Pues que en muchos de vosotros ocurre al contrario que es insisto justo lo que me preguntaban ayer los de primero eh Y es que cuando uno se pone a grabar Eh Pues claro si tú has hecho el trabajo 25 minutos No son suficientes porque tú quieres contar un huevo de cosas que has hecho en el trabajo yo Siempre os cuento creo que os lo conté el año pasado y si no os lo cuento este que eh yo por ejemplo el proyecto final de carrera pues yo estuve 6 meses trabajando sin parar en ese proyecto y me enfadé mucho cuando me daban 15 minutos para exponerlo y era como cómo te voy a contar el trabajo de 6 meses en 15 minutos Vale entonces qué ocurre si estáis grabando vídeo y os pasáis de los 25 minutos No pasa nada porque Cuanto más dure el vídeo más cosas me vais a contar y cuantas más cosas me contéis evidentemente siempre que las cosas sean pertinentes a la práctica quiere decir que más prueba tengo de que habéis trabajado vale por tanto grabar más en el vídeo no da hay ningún problema Yo sé que algunos de vosotros preguntáis lo de si es problema grabar más porque a veces en educación secundaria en el instituto si te dicen que quieren que hagas un resumen de una página como te pases de una página te van a penalizar porque el objetivo es aprender a sintetizar vale me parece muy bien por el Instituto por educación secundaria pero no es el objetivo aquí es que si os digo 5 minutos es porque hago una estimación muy a ojo pero mi objetivo no es que os ajusté a 25 minutos mi objetivo para que lo tengáis claro es que me demostré que vosotros habéis hecho ese código vale con lo cual mientras se cumpla ese objetivo por mí podéis grabar un vídeo de 30 35 40 minutos os hace falta y no hay ningún problema y no va a haber ninguna penalización igual que el año pasado por otra parte luego eh Y ya para acabar y ahora empezamos ya con la materia eh Blanca comenta que vais agobiados lo cual eh o sea no me extraña quiero decir no me extraña en el sentido de que todos los años es igual estamos en segundo son cinco asignaturas técnicas el año pasado de alguna forma podríamos decir que las mías eran las duras pero eran tres y luego teníamos pues dos asignaturas de Amparo que eran un poquito de descanso vale este año ocurre igual las asignaturas que el año pasado impartía Amparo este año también las imparto yo pero es igual a los de primero Pues en programación lenguajes de marcas y vas de datos les meto caña y ya pues en entornos de desarrollo y en sistemas informáticos descansamos un poquito más el problema que tiene el segundo es que no hay tiempo para descansar es decir el problema que tiene segundo es que son cinco asignaturas técnicas muy fuertes y muy potentes desde el primer día hasta que llega febrero de hecho la gente cuando llega a febrero en segundo digo y acaba los exámenes la gente es como puf ya me he quitado esto de encima ya me he quitado las asignaturas luego viene evidentemente las fcts y el tfg que es también temas de los cuales hablar vale pero ya os digo que todos los años la gente cuando acaba segundo conmigo acaba muy agobiada y acaba con ganas de pegarse un buen descanso porque estos dos trimestres son a saco vale una vez que digo esto Una vez que digo esto yo también todos los años digo lo mismo eh De hecho Ah no Mirad eh No justo hoy Ah No espera no que viene en la hora siguiente en la hora siguiente viene Ah no debería estar aquí Bueno debería estar por aquí Beatriz que es alumna de Sevilla Entonces yo siempre digo lo mismo Esto no es el cole no hay por qué aprobar todo el curso a la vez no es que si no apruebas repites no esto es un ciclo formativo de grado profesional lo cual quiere decir que bueno te icamente para aquellos que estáis digamos en casa de vuestros padres viviendo có diría yo entre comillas de la nada vale como yo cuando tenía esa edad ojo cuidado aviso Entonces en ese caso para esas personas Pues sí que yo suelo decir que lo normal es que os saquéis el curso entero Porque si estáis agobiados pues Oye jodéis porque no tenéis Nada mejor que hacer ahora a esas personas pues que ya sois más adultos que trabajáis que tenéis una casa que tenéis una familia que tenéis Pues eso un trabajo y una obligaciones Pues yo a esas personas les digo a ver eh yo o sea sé que hacer todo eso y llevar este ciclo formativo puede ser muy agobiante Entonces yo siempre digo escuchad no estáis obligados a sacaros todas las asignaturas en este curso y no pasa nada y la prueba la tenemos en Beatriz que justo hoy no está hay que joderse pero lo digo porque está todos los días siempre que tenemos clase pero Beatriz hizo la mitad de asignaturas hace dos años ni siqu era el año pasado hace dos años y pues como tenía temas de que se estaba yendo a vivir con su novio y tal y eh Y trabajaba Y supongo que todavía sigue trabajando de informática pues Oye pues llegó un momento que no podía con todo y no pasa nada y se sacó una serie de asignaturas hace dos años y ahora está haciendo las que le quedan y no pasa nada vale con lo cual Cuando digo no pasa nada eh No digo rendir vale no O sea yo os digo intentad pelear intentad conseguir ese objetivo de hacerlo todo compatible Y hacer que todo sea posible y sacaros el ciclo además de vuestra vida intentarlo luchad pelearlo pero si no podéis tranquilos que no pasa nada que la asignatura que nos apruebe este año se aprueba el año que viene y ya está vale lo digo por eso porque si me decís que es que vais agobiados yo os digo es normal pero también os digo que yo tengo un temario que dar y no puedo dar menos de ese temario en ciertas ciertos aspectos y que a veces puedo aflojar un poco pero un poco quiero decir que yo tampoco puedo aminorar el ritmo entonces entiendo que el ritmo que llevo insisto eh Para las personas que estáis trabajando o tenéis obligaciones familiares domésticas yo que sé cargas lo que sea Vale pues entiendo que estaréis agobiados y admiro mucho a las personas que estáis haciendo esto además de llevar lo otro pero bueno ya os digo intentad lo y si en algún momento el agobio supera que sepáis que esto no es todo o nada Esto no es o apruebas todo el curso o te vas a la no esto es tú aprueba lo que puedas y lo que no apruebes pues se aprueba el año que viene y no hay ningún problema vale bien Bueno pues voy a empezar voy a ir empezando José Vicente puedo dañ un pequeño Matiz s desde la vista de nosotros vale porque cuando a es que es algo que Igual ayuda mucho tamb la motivación de del grupo sabes lo que te quiero decir Claro cuenta porque a la hora de grabar el vídeo por lo menos a mí y a dragos por ejemplo nos está pasando que grabamos el vídeo y cuando hemos grabado el vídeo es cuando decimos que realmente estamos aprendiendo mucho porque cuando explicas el vídeo sí explicando claro y te das cuenta de que realmente sabes hacer muchas cosas no eso motiva mucho a seguir por eso que a la hora de hacer el vídeo yo creo que motiva mucho y eso puede ser también un Pilar importante a la hora de avanzar en el grado Sí No desde luego yo todo aquello que sea refuerzo positivo teniendo en cuenta que durante estos meses van a haber cómo te diría yo no ya directamente refuerzos negativos porque yo no os voy a dar refuerzos negativos pero sí que va a haber mucho trabajo que hacer y va a haber muchas cosas que aprender y mucho código que desarrollar Y eso en cierta forma pues es presión sobre vosotros vale cuantos cuantas más estrategias de refuerzo positivo como la que acabas de comentar mejor porque insisto porque cada uno de vosotros es un mundo y hay gente que no necesita motivación porque va pam Dale que te pegó Pero hay gente que sí que puede necesitar de vez en cuando esa motivación y ese refuerzo positivo y ese ánimo para seguir vale Yo siempre digo que al final el objetivo es llegar antes o llegar después pero llegar entonces sí vale igual hay gente que se está agobiando porque yo también siempre he dicho que es un poco el resumen de lo que tú acabas de decir que una cosa es aprender y otra cosa es sentir que aprendiendo que debería ir de la mano pero a veces no es así vale a veces estás aprendiendo pero no te das cuenta del agobio que llevas encima y cuando por lo que sea paras Y en este caso por ejemplo pues haces algo como lo que acabas de decir es cuando te das cuenta de que dices estoy avanzando poco a poco vale pero est estoy avanzando Vale entonces todo aquello que podáis compartir a ese respecto para ayudar a los compañeros a que todo el mundo se agobie lo menos posible pues mejor que mejor vale Así que sí vale Bueno pues vamos a empezar hoy bien Hoy curiosamente eh lo que viene es más o menos no ya flojet vale pero sí entendible veréis Mirad voy a cerrar por aquí ahora luego os pongo lo de Los criterios de evaluación y me voy a ir aquí vale me voy a ir al proyecto me voy a ir a eliminación vale me voy a ir a cliente Voy a darle a jarsa Y le doy a login fijo en 5 segundos y Mirad vamos a ver vale Y pincho en cualquiera de los iconos Okay Vale y teníamos esto la semana pasada vale estábamos haciendo habíamos hecho por una parte un visualizador de tablas habíamos hecho por una parte esto de aquí que es el Select vale es del crud digamos es el readid es la r habíamos creado también la papelera que del crud es el delite con lo cual técnicamente por aquí por esta parte eh Ya sabéis que lo que nos queda es el create el insertar y el update vale el actualizar Y evidentemente pues con respecto a lo que vimos el año pasado de Cómo crear el superc controlador Pues osis a la idea de que esto pues al final tarde o temprano va a funcionar vale bien una de las alternativas es hoy hacer el create vale y el update pero voy a un poco reiniciar vale me voy a ir a otra parte del desarrollo de esta aplicación de gestión empresarial y voy a ir a algo como ahora veréis completamente diferente Pero complementario veréis cuando yo creo un sistema de gestión empresarial Por una parte yo sé que como veis os acordáis teníamos un login y luego del login teníamos un escritorio y luego del escritorio donde elegimos aplicaciones pues tenemos como el panel vale donde estamos ahora mismo dónde aplicaremos el crud voy a poner por aquí crud y así entendéis qué es lo que estamos haciendo Y dónde vamos bien Ahora Bien dentro de un sistema de gestión empresarial en un momento dado siempre va a ser necesario algún tipo de operación un momento que voy a poner algún tipo de operación aquí de entrada y salida es decir cuando trabajamos en un sistema de gestión empresarial yo tengo clientes vale estoy trabajando ahora mismo con una tabla de clientes y yo sé que en un momento dado de la aplicación voy a tener que voy a tener que meter una serie de clientes por ejemplo en este caso yo tengo ya como veis por aquí una tabla con clientes estoy desarrollando esta aplicación en este momento Así que yo sé que el cliente va a llegar un momento cuando yo implante esto que me va a decir Oye qué guapo pero ahora yo tengo ahora que vamos a implantar esta aplicación tengo una hoja de Excel con 1000 clientes y los quiero meter cómo los meto vale o si nos vamos al temario Uy Espera que he cerrado el temario o si nos vamos al temario veremos que en el temario hay una parte que es la que Hoy empezamos a introducir vale que es generación de informes vemos que tenemos por aquí eh informes y listados de la aplicación tenemos consultas de acceso a datos vamos a trabajar un poquito con esto de aquí bien cuando eso llega no solo Vamos a necesitar meter información te digo Excel porque Excel es algo muy común vale porque norment todas las empresas tienen listados en Excel como al revés es decir cómo voy a necesitar sacar información del programa puede ser en Word puede ser en PDF puede ser en Excel puede ser en un montón de formatos Así que hoy como ya tenemos claro vamos teniendo claro No está acabado vale Pero vamos teniendo claro el login vamos teniendo claro el escritorio vamos teniendo claro el crud al escritorio le falta un montón de diseño pero es que eso es lo de menos o a mí siempre me ha parecido que es lo de menos porque a tiempo de meter css siempre estamos La pregunta es cómo hacemos esto en este caso bien Voy a dibujar un icono de un documento Vale y vamos allá y lo que os quiero enseñar hoy es que en un momento dado un sistema informático no tiene por qué estar en un solo lenguaje de programación vamos a crear un ecosistema donde yo en este caso lo que quiero es ser capaz como habéis visto en el temario de poder meter y poder sacar archivos por ejemplo os pongo un ejemplo Y ahora veréis por qué os pongo Este ejemplo en formato xls bien eh y digo insisto el formato xls porque es el gran clásico de las empresas el gran clásico de hasta ahora he estado trabajando en Excel ahora voy a implementar un CR m Pero toda la información que tengo la tengo en Excel bien qué es lo que ocurre cuando yo quiero porque yo este crm este rp este sistema de gestión empresarial vale de momento no es nada de momento es una base lo estoy desarrollando con el stack php mysql Por qué Pues porque en un momento dado al principio del ejercicio yo os he justificado momentín que vale que le ponga relleno y le quite trazo yo os he justificado que pues hacer una aplicación con este stack de tecnologías a día de hoy es muy conveniente en el sentido de que la aplicación está disponible en tiempo real en modo multiusuario para cualquier usuario vale Pero qué ocurre en el momento en el que yo quiero trabajar con Excel Bueno pues html y css directamente te olvidas javascript mayormente también porque javascript es algo que ocurre en el cliente pero el procesamiento de un archivo de Excel sería algo que ocurre en el servidor php Aquí estaríamos empezando a hablar el problema es que php tiene un soporte muy malo para trabajo con archivos de Excel y yo lo que quiero al final es mysql s vale Yo lo que quiero es el contenido del Excel y meterlo dentro de una base de datos mysql qué es lo que voy a hacer pues lo que voy a hacer es que básicamente Aquí voy a meter python y Cuando digo que voy a meter python lo que quiero decir es que eh el lenguaje que más facilidades nos va a dar Insisto que si intentáramos hacer esto con php sí que la clase de hoy se complicaría una barbaridad Pero Vais a hacerlo Vais a ver que hacerlo con Excel va a ser prácticamente perdon hacerlo con python quería decir va a ser Prácticamente todo disfrute vale pero claro se puede mezclar una aplicación que tenga html css javascript phpm sql con python sí por qué no se puede sin ningún problema siempre que el servidor lo soporte por supuesto en este caso estamos trabajando en un servidor de desarrollo con lo cual en el servidor de desarrollo técnicamente podemos meter lo que nos dé la gana ahora mismo de hecho ya tenemos metido python entonces lo que voy a hacer por lo tanto es una herramienta y por eso dentro del proyecto de momento lo voy a poner organizado de una forma que igual no os gusta pero me da igual porque luego cada uno de vosotros se lo va a poder organizar como quiera literalmente como quiera Así que sistemas de gestión empresarial me voy a proyecto me voy a eliminar definitivamente y voy a hacer una carpeta llamada 023 utilidades así que hasta el momento yo tenía una carpeta llamada cliente que va a ser lo que el usuario vea nh html en su navegador una carpeta llamada servidor que son los microservicios tú no llamas directamente a servidor sino que es cliente el que Llama a servidor mediante microservicios Por cierto que aquí dentro del servidor dentro de un par de semanas meteremos el controlador la clase php que estamos haciendo en acceso a datos Pero como esa clase no está todavía madura pues hoy todavía no la metemos a ver si hay suerte si la acabamos mañana y o la acabamos o la avanzamos lo suficiente mañana y así ya en la clase del lunes que viene me metemos el controlador de acceso a datos aquí dentro de sistemas de gestión empresarial bien Por lo tanto voy a crear una carpeta llamada utilidades y esta carpeta utilidades va a tener Pues eso utilidades para el administrador es decir utilidades para no ya el cliente final sino para que un administrador de la aplicación pueda hacer importaciones y exportaciones dentro de utilidades igual que en cliente creamos aplicaciones creamos módulos Vale pues yo aquí lo que voy hacer es que en utilidades voy a crear una subcarpeta llamada Eh pues importación vale o importador yo que sé bien a continuación me voy a ir a idle en este caso vamos a estar trabajando con idle vamos a ver cómo trabajamos esto vamos a crear un controlador y ahora veremos si le creamos una interfaz en html o una interfaz en idel o yo igual lo hago de una forma vosotros en casa lo podéis hacer de otra Vale ahora lo hablamos bien yo aquí a continu voy a crear un archivo nuevo me voy a ir a la carpeta inicial me voy a ir a bar html dam segundo sistemas de gestión empresarial proyecto y utilidades importador vale voy a crear 001 leer archivo de Excel Entonces quiero comentaros que eh existe una librería en python que es fantástica llamada pandas Así que import pandas as pd vale pd puede ser lo que vosotros queráis le voy a dar f5 simplemente para comprobar si tengo pandas instalado en este equipo que debería y si no lo tengo Pues con un pip install pandas Se puede instalar Así que f5 y no me da error lo cual quiere decir que tengo ya pandas instalado vuelvo a insistir que si alguien no lo tiene instalado es pip install pandas y solucionado vale Y se instala pandas y yo ahora a continuación Mirad voy a crear eh aquí libre Office voy a crear unos clientes vamos a ver voy a cerrar esto no guardar vale quiero calc Sí pero no eh No quiero uno nuevo y esto fuera no vale Y esto Quiero una hoja de cálculo Okay vale Y ahora atención Mirad lo fácil sería sacar la exportación de la base de datos localhost phpm admin lo fácil sería Esto es crimson lo fácil sería ir a clientes y decir Bueno pues voy a crear una tabla de Excel llamada eh nombre apellidos email dirección código postal y tal vamos a empezar haciéndolo así pero ahora luego lo complicar entonces voy a crear nombre apellidos lo voy a hacer fácil y ahora luego lo hago difícil más que lo hago difícil lo hago real email dirección y ya está bueno y ya está y creo que había una más dirección código postal población país vale código postal población país bien a continuación lo que voy a hacer es meter unos datos de prueba vale Así que pues voy a poner por aquí Jos viicente carratalá email info @ jara.com dirección la calle de José Vicente código postal 4600 población Valencia y País España bien y ahora a continuación quiero hacer una utilidad tal que me lea un archivo de Excel que no tenga eh un registro sino que tenga 1000 registros si quiero y me los meta en la base de datos Yo sé que algunos de vosotros me diréis bueno es que de hecho aquí en php My admin tienes una utilidad que es importar Y aquí desde importar puedes importar archivos de Excel Sí pero no quiero utilizar phpm admin porque ya sabemos que existe lo que quiero es ser capaz yo de programar un importador y que de hecho mi importador haga cosas que php my admin no hace vale Y así un poco pues entender cómo funciona esto así que me voy a guardar Esto me voy a Ah no puedo vale muy bien me voy a documentos escritorio Perdón me voy a eh clientes punto bueno Me lo voy a guardar como Excel me lo podría guardar como ods a mí me hace mucho más ilusión el formato ods que el formato Excel pero como lo más normal en las empresas es el formato Excel Pues voy a hacerlo como lo encontraréis en las empresas no usar formato Excel bien Entonces cierro por aquí me vengo por aquí un momentín y ahora voy a pasar del escritorio clientes me lo paso aquí a esta carpeta muy bien a continuación ahora una vez que Leo el archivo de Excel 002 leer contenido con pandas y a continuación digo eh contenido es igual a pdop creo que es pdop y digo clientes. xlsx y print contenido creo recordar que era así y si no ahora recurriré a hgpt y no Ah no ppd load vamos a ver pues no hay load pues me extraña ya mucho Pero vale va Vamos a verlo entonces eh vamos a ver python pandas Uy python pandas load xlsx vamos a ver me extraña que no fuera ni load ni Open Pero vale Ah re exel fantástico muy bien ahí lo tenemos re Excel lo di f5 Ok vale qué te pasa aquí me falta el open x vale No solo tengo que importar Panda sino pip install Open p XL así que me voy a sacar un editor voy a hacer un pip instal momentín a ver sudó sí pero no es que estoy buscando anterior Pero bueno da igual voy a ver sud pip install Open p XL y tengo que decirle vamos a ver el Force packages Así que python pip install without environment vale venga s no esto no with Force break packages Esto bueno Vale vamos a decirle ignor install Okay instalo okay for reinstall no vale venga esto Este es el que yo quiero quieto vale esto aquí os enseñaré trabajar con environments ya está y vale Ok perfecto entonces hago así f5 y si os fijáis lo que ocurre en esta pantalla es que estamos cargando el contenido del archivo xls dentro de un programa de python y ha sido tan sencillo entre comillas como instalar un par de dependencias de python importar la librería leer Excel e imprimir el contenido vale Y ya está ahora una vez que hago esto y una vez ya he comprobado que en python por eso en este esquema os he puesto hacer esto en python Más que nada porque esto en python es como mil veces más sencillo de hacerlo que en cualquier otro lenguaje para buscar la combinación de tecnologías que siempre nos sea más provechosa y más productiva posible bien Ahora yo quiero eh meter esto en un diccionario Vale entonces vamos a ver yo quiero leerlo con más precisión Entonces esto as dictionary Vale entonces vamos a ver aquí to dict me voy a 003 a diccionario y le digo Aquí diccionario print diccionario f5 y el resultado es este de aquí si nos fijamos en este caso nos dice que el nombre vamos a imprimir el nombre vale el nombre es cer José Vicente Bueno es un diccionario un poco extraño Pero no pasa nada print diccionario de bueno de Quiero todas las claves Pero vale voy a empezar por nombre y me dice el nombre es cer José Vicente Vale pues digo Vale pues Ahora dame el índice y me dice José Vicente vale Ahí tengo el dato a continuación lo que puedo hacer es navegar por cada una de las claves del diccionario por tanto Yo vengo por aquí y 004 navego por las claves Por qué Pues porque el diccionario puede tener una longitud desconocida y digo for clave in diccionario print clave y me dice nombre apellidos email dirección código postal población país fantástico porque ya tengo los nombres de las columnas de Excel que en este caso Insisto que por simplicidad coinciden con las columnas de My sql vamos a hacerlo primero fácil y luego lo complicamos un poco vuelvo a insistir que no lo voy a complicar porque me guste complicarlo sino que lo voy a complicar Simplemente porque el Excel que te pasan nunca tiene que ver con la base de datos donde lo vas a meter y por tanto lo real es que no coincida bien Así que vengo por aquí y digo 005 eh saco los datos de las claves y digo print diccionario de clave de cero Si queremos podemos decir clave coma diccionario de clave de cero f5 nombre José Vicente apellidos carratala sánches email info jarsa dirección la calle de José Vicente código postal 4600 población Valencia Entonces como veréis con unas pocas líneas de código destripamos un archivo de Excel y lo destripamos de una forma segura dadme 10 segundos que me voy a levantar a encender el aire acondicionador porque empiezo a tener un calor que te cagas un momentín que ahora vengo Vale entonces antes de continuar voy a comentar esto 006 comentarios y ahora vamos a la segunda parte de la parte contratante que es meter en base de datos y digo importo esta librería para instalo esta librería para poder leer una gran cantidad de orígenes de datos entre ellos Excel instalo esta librería para poder leer archivos nativos de Office que nos guste o no A mí no me gusta pero es lo que hay pues son muy comunes ahora importo la librería y Leo el contenido del archivo de Excel lo convierto a diccionario de python Por qué Pues porque a python le va a resultar mucho más fácil trabajar con un diccionario de python que con un archivo de Excel vale se llama dataframe el contenido viene en un formato que se llama dataframe Pero simplemente lo convertimos a diccionario y vosotros Vais a trabajar también mucho más sencillo con esta línea PR diccionario saco el contenido en la pantalla para ver qué sale a continuación con print diccionario de nombre de cero compruebo que puedo acceder a cada uno de los datos Y ahora a continuación digo Bueno pues ahora repaso clave a clave el diccionario y saco Su contenido por pantalla simplemente para demostrar que puedo hacerlo vale simplemente para demostrar que tengo un control muy duro sobre el contenido de Excel Vale entonces ahora qué voy a hacer Bueno pues si ya estoy demostrando que lo puedo leer ahora a continuación lo que voy a hacer es meterlo dentro de mysql cómo lo voy a meter dentro de may sql bueno primero vamos a formatear una petición sql entonces comienzo formateo de la no me voy a conectar todavía a mysql simplemente voy a simular una petición y digo creo una variable llamada petición y le digo insert into voy a decir de momento clientes Ahora luego lo haremos Dinámico ya sabéis primero lo hacemos estático y luego lo hacemos Dinámico y digo Val y voy a decir nula y aquí es d empezamos a meter cosas y digo para cada una de las claves petición más igual a Espera que te lo digo Aquí pongo unas comillas más clave no perdona aquí va clave más igual comillas y aquí va diccionario de clave de cero es decir esto que he puesto aquí arriba no lo vemos bien no os preocupéis voy a darle print y vamos a ver qué ha salido Ah y al final me falta cerrar el paréntesis Así que petición más igual a cierre de paréntesis print petición f5 momentín Ah cuidado no puede concatenar int vale No pasa nada voy a decirle que es String lo convierto a String el típico problema de conversión de tipos y encadenamiento en python y ocurre esto insert into clientes values nul nombre es igual a José Vicente apellidos es igual a carratalá Oh Me falta una coma Me falta una coma aquí después tiene que ir una coma hago así insert into clientes valius null nombre José Vicente apellidos c las sanchis email inf bajo carsa dirección en la calle de José Vicente y así vale Y lo que acabo de hacer es formatear una petición de insert para la base de datos voy a limpiar un poquito esta petición Pero evidentemente qué haré a continuación pues lanzar esta petición contra la base de datos vale además quiero que os fijéis En que si yo en un momento dado si yo en un momento dado me vengo a la hoja de cálculo y Pongo aquí nombre Juan García Martínez email juan@ara.mil.ar guardar vale No sé por qué me dice que alguien lo ha modificado yo ahora guardo recargo y veis que tengo espera qué ha pasado momentín quién me lo ha modificado Ah claro espérate vale porque yo lo he guardado venga yo lo he guardado en el disco duro en el escritorio clientes y tengo que guardarlo aquí reemplazar Ahora sí vale me voy a python ahí f5 así y eh No espérate José Vicente por qué sigo teniendo por qué sigo teniendo vamos a ver Ah muy bien nombre José Vicente la calle de José Vicente Ah y tengo dos vale para cada uno de ellos tengo dos tengo el cer que es José Vicente y el uno que es Juan vale de momento estoy leyendo únicamente el cero Bueno pues tengo que modificar este código para que se convierta en eh pues por ejemplo 0 y1 Vale pues Hala 008 modifico el código para dos peticiones Y entonces digo vamos a ver aquí for i in Range de 0 a un Vale ahora hablamos de esto y aquí digo clave de I y clave de I ejecuto y me da vamos a ver un insert para clientes de o a dos ahí me da un insert para José Vicente y otro insert para Juan Vale ahora veremos que evidentemente esto puede ser eh Dinámico vale Yo puedo detectar Cuántos elementos exactamente tengo bien antes de insertar en la base de datos deciros que si intento insertar me va a dar error porque tengo esa coma por ahí colgando que es la última coma de lo último que engancho con la petición Y esa coma no es una sintaxis legal de sql entonces hay un truco ahora pondré nuevos comentarios hay un truco que consiste en quitar el último carácter python remove Last character from String vale Y aquí esto y aquí y le digo petición es igual a petición -1 Vale entonces esto es actualizo un momen creo el inicio de una petición de inserto ahora le añado al insert cada uno de los campos del diccionario le quito el último carácter cierro con el paréntesis imprimo la petición a ver qué tal imprimo la petición f5 y ahora sí ya no tenemos esa coma horrible con lo cual ahora ya llega el momento en el cual puedo Conectarme a la base de datos e insertar el resultado pero antes de conectarme a la base de datos pues lo que quería era evidentemente formatear la petición y que vierais que lo de conectarnos a la base de datos ya es pues prácticamente lo último bien entonces 009 Me conecto a la base de datos entonces vengo por aquí al clásico pues python Connect to mysql and insert y ya Entonces vamos a ver sí my sql conector python ya lo tengo instalado vale Ok no quiero el error voy a hacerlo en modo sencillo vale conexión es igual a mysql connector donde el Host es local Host el database es crimson el usuario crimson y el password de crimson vale Y ahora cursor es igual a conexión cursor que ya sabéis que para conectarnos una base de datos siempre hace falta vale execute many no execute y digo cursor execute técnicamente el execute en este caso serviría pero bueno voy a tirar execute y conexi comit vale si esto va bien si esto va bien Esto es conexión vale si esto va bien Ahora comentaré voy a comprobar Primero me voy a la base de datos compruebo que el último cliente es el que tiene el identificador 28 y ahora a continuación si tú ha ido bien le doy a f5 okay insert query no es insert query es petición Okay Vale f5 Data is not defined eh Hola ostras insert query Data no es petición y punto vale Okay con lo cual Mirad yo tenía hasta el momento hasta el cliente 28 pero yo continuación le doy a recargar y ahora tengo e se me ha metido todo cero qué fuerte bueno pues vamos a ver por qué se me ha metido dos clientes pero no se han metido correctamente de hecho se ha metido todo cero vale Por qué nombre es igual a José Vicente apellido es igual a car sanchis email es igual a esto valius Ah no sí los valius son correctos Qué cosas un momentín voy a ejecutarlo a manoy ejecutarlo a mano porque no me cuadra que se haya metido todo cero insert into vale le doy a continuar Sí y a 00 ostras Wow Por qué Espera voy a hacer una plantilla de insert y ya está Ah values no valies no sí V sí vali sí valius Qué cosas a ver vamos a esto vamos a ejecutar nombre José Vicente apellido es igual a cart sanchis email es igual a esto tiene pinta de ser correcto a ver nombre apellidos pero me inserta cero vale voy a hacer una cosa voy a invertir las comillas ya que tal vez puede ser por eso Entonces vamos a ver aquí invierto la comilla Esta es sencilla Esta es doble Esta es sencilla y por tanto Esta es sencilla Esta es doble Y esta es sencilla esta da igual la voy a poner como sencilla f5 vale me voy a la base de datos me voy a clientes me inserta ceros madre mía eh momentín A ver porque es execute comit principio creo que está correcto pero vamos a comprobarlo Stream diccionario no petición petición print petición no me hace falta el Nan a ver si el caso es que si yo hago así y yo hago así insert into clientes values print petición me voy a local Host me voy a sql hago así le doy a continuar y por algún motivo me está metiendo ceros ostras no parece ser problema de python vale Claro otra cuestión es que vale otra cuestión es que aquí en la clave no le pongo la clave vale no le pongo la clave f5 unterminated qu una comilla sencilla f5 vale Y ahora sí como no le estoy pasando el nombre de las columnas pues ahora sí ya me mete los dos datos correctos de todas formas Ahora nos daremos cuenta de que nos van a hacer falta los números de las columnas bien qué ha ocurrido pues lo que ha ocurrido es que de momento he introducido dos clientes desde la base de datos de tal forma que Mirad de tal forma que si yo ahora vengo aquí me voy a clientes veo que tengo ahí al final dos clientes voy a eliminar los que no me hagan falta veis que los estoy eliminando utilizando la misma herramienta de eliminación que utilizamos el otro día y ahí los tenemos vale ya hemos completado vamos a de hecho volver a la base de datos vamos a recargar para comprobar que nos hemos cargado los ceros directamente desde la aplicación con el delete que hicimos el otro día y pues ya tenemos aquí los datos bien esta ha sido una primera importación pero ahora hay que hacerla más completa voy a comentar el código antes de continuar 010 comentamos el código y digo importo el conector de mysql importo conector de mysql me conecto a la base de datos bien creo un cursor y eh Ya está y ejecuto la petición y eh lanzo la petición pero claro esta importación ha funcionado por la sencilla razón de que en primer lugar el Excel el archivo de Excel tenía los mismos nombres de columna y Segundo los tenía igual de organizados es decir los tenía en el mismo orden Eso quiere decir que si yo ahora intento hacerlo mismo por ejemplo Mirad vamos a ver me voy a dónde estás aquí por qué estoy pintando en qué momento estoy pintando Porque se ve que le he dado aquí a pintar pero no quiero pintar pues estoy pintando fantástico Es que no quiero pintar sabé que le he dado okay Si es que me parece fantástico pintar pero es que no quiero pintar vamos a parar vamos a rearranque vamos a hacer algo más complejo veréis vamos a ver está abriéndose Sí ahora a continuación lo que voy a hacer Es que voy a cambiar los campos de sitio y una vez que cambio los campos de sitio les voy a cambiar además el nombre dirección del cliente apellidos del cliente email del cliente código postal país del cliente y nombre del cliente y población del cliente esto empieza a ser más real esto empieza a ser más parecido a lo que os vais a encontrar en una empresa real Cuando tengáis que hacer una importación y es que los campos no van a coincidir el orden no va a coincidir las cabeceras no van a coincidir vale el caso que había hecho anteriormente era un caso un poco ideal qué es lo que vamos a tener que hacer aquí Bueno pues vamos a hacer un mapeado es un archivo mediante el cual puede ser un archivo de texto puede ser un csv mediante el cual le decimos qué campo del archivo de Excel corresponde Con qué tabla de la base o sea con qué columna de la base de datos voy a guardar me lo guardo en Excel me lo vuelvo a poner en la carpeta correspondiente vale clientes y lo lanzo bien y ahora a continuación me voy a hacer un archivo de texto me voy a hacer un archivo de texto en segundo en sistemas en proyecto en utilidades en importador y voy a llamarlo mapeado pun csv puede ser lo que queráis literalmente así que me voy a mapeado csv y digo el campo que en el Excel Espera que lo he cerrado momento el campo que en el Excel se llama nombre del cliente en la base de datos se llama nombre el campo que se llama apellidos del cliente se llama apellidos el campo que se llama dirección del cliente se llama dirección el campo que se llama email del cliente se llama email el campo que se llama código postal se llama creo recordar CP me parece y población lo tengo no y el campo que se llama población del cliente se llama población y ya está y creo que ya está Ya los tengo todos 1 2 3 4 5 6 7 No qué me falta nombre población país del cliente vale país vamos a leer este archivo me voy a ir a idle si lo encuentro por aquí vale 011 leemos el archivo de mapeado import pandas sí okay Y python read csv to a dictionary vale Sí pero no lo voy a hacer más sencillo import csv esto luego import csv diccionario es igual a esto y ahora Open ahí y archivo es igual a esto es mapeado y aquí csv reader es igual lector csv es igual a csv reader de archivo Y por último aquí for fila in lector csv print fila Ok vale nombre del cliente apellidos del cliente nombre dirección un momento eh Hola Esto es un poco raro no esto no a ver qué esto nos da pero Ah vale Perdón que me he equivocado yo el escribirlo es esto es Excel com mysql vale vamos a verlo Ahora sí vale lo que en Excel es el nombre del cliente en mysql es nombre lo que en Excel es apellidos del cliente en mysql es apellidos lo que en Excel es dirección del cliente mysql es dirección vale por tanto como vemos por ahí El lector csv ahora es un diccionario de hecho es una array que contiene diccionarios vamos a imprimir print lector csv y veremos que es una array vale Y bueno en este caso es una rray que nos sirve como Pues mira vamos a ver ahora verás eh cómo lo llamo mapeado es igual a lista y le digo mapeado punto append fila print mapeado y literalmente como veis ahí tengo una lista con el mapeado vamos a poner comentarios importo librería para trabajar con csv ahora creo un diccionario vacío abro el csv en modo lectura cargo sobre el diccionario el contenido del csv creo una lista vacía y para cada una de las filas del csv añado el diccionario a la lista y lo imprimo para comprobar que todo va bien siempre bien Ahora qué ocurre Pues que ahora lo que voy a hacer es fusionar los dos códigos fusionar el que tenía antes con este que tengo ahora porque el código que tenía antes funcionaba pero era un código un poco tonto en que en cuanto el código Se separe un poco de lo que es la tabla de mysql el código va a fallar pero este código es más inteligente porque tiene el mapeado y por tanto sabe qué columna de Excel corresponde a qué columna de mysql Vale entonces vamos a probarlo Vamos allá y ahora hago lo siguiente vamos a ver voy a traer el archivo voy a realizar una fusión leemos el archivo de mapeado comentamos el código Ok correcto muy bien Ahora formateamos petición antes de conectarnos a my sql si queréis formateamos petición voy a beber y digo import pandas aspd de hecho me traigo la línea con comentario y todo vale Y digo vamos a ver aquí contenido es igual a clientes vale Ok esto es si queréis voy a hacer grandes secciones para que el código lo entendáis cargo el mapeado de Excel a mysql enter vale Ahora leo Excel y Leo Excel Vale y vamos a print diccionario Pero bueno está claro lo que tenemos Aquí el problema Está print diccionario Mirad f5 En que si yo imprimo el diccionario me dice vamos a verlo por aquí me dice voy a poner print cosmético porque es que si no veo dónde acaba una cosa dónde acaba la siguiente ahora lo veo mejor vale dirección del cliente apellidos del cliente claro yo eso no puedo meterlo en mysql pero aquí arriba si os fijáis tengo que dirección del cliente en Excel equivale a mysql dirección entonces como estáis viendo ahí pues tengo la correspondencia y por tanto puedo mapear vale por tanto puedo decir qué parte del Excel corresponde a qué otra parte de mysql Entonces en este caso Vamos allá vamos a buscar la correspondencia vamos a buscar la correspondencia Ahora leo Excel 03 repaso el diccionario Vale y digo for clave in diccionario print clave hago esto y me dice dirección del cliente apellidos del cliente email del cliente y tal Vale y digo clave es más si queréis Pongo aquí clave Excel para entender bien lo que estamos haciendo clave Excel esto de aquí ahora valor print y pongo valor de esa clave dos puntos coma diccionario clave de momento voy a poner cero clave Excel dirección del cliente valor de esa clave la calle de José Vicente clave Excel apellidos del cliente valor de esa clave carratala sánches vale Ya casi lo tenemos ahora qué nos falta Pues nos falta saber cuál es la clave no en Excel sino en mysql Entonces cómo hacemos eso vamos a verlo porque esto igual aquí arriba lo que voy a hacer es que el diccionario vamos a ver mapeado punto apen no mapeado voy a hacer un diccionario y voy a decir mapeado de a ver Valentín aquí a ver mapeado de Excel Ok mapeado de Excel es igual a mysql creo que no momento fila voy a hacer una cosa voy a hacer print fila y así me aseguro de lo que tengo print fila Okay perfecto fila de Excel es fila de Excel es igual a fila de mysql y print mapeado esto ya no me hace falta el que nunca se cierra esto de aquí okay Ahora sí espera Ahora sí vale Y ahora digo print la columna coincidente de mysql es eh mapeado de clave vamos a ver si ha funcionado bien y dejadme que ponga un separador visual vale clave de Excel dirección del cliente valor de esa clave la calle de José Vicente la columna coincidente de may sql es dirección Entonces ahora sí ya tengo todo para saber qué campo del Excel es qué dato hay en el campo Pero dónde lo tiene que meter dentro de mysql pongo comentarios y lo metemos dentro de mysql vamos a verlo Vale pues voy a poner los comentarios aquí pongo los comentarios y Okay Venga pues creo un diccionario vacío Okay ahora rimo el diccionario solo para verlo imprimo el diccionario y ahora para cada clave en el diccionario imprimo el nombre de la clave imprimo la clave de Excel imprimo Su contenido y imprimo la columna correspondiente en mysql en un programa real no se haría tan pero lo estoy haciendo así de verboso para que entendáis lo que está ocurriendo pasito a pasito vale Y esto es un separador visual y ahora ya ahora a continuación lo que voy a hacer es 014 inserto en mysql entonces me copio la conexión y el cursor vale conexión a mysql conexión a sql okay okay petición es esta de aquí vale pues voy a hacer lo siguiente petición es igual a insert into clientes identificador vales nul Vale qué he hecho con esto aquí es donde la cabeza os va a explotar un poco lo voy a comentar inserto quita para allá que no caray vale va Qué pasa aquí que me falta una comilla vale inserto un cliente vacío Por qué vamos a ver vamos a verlo vale vamos a ejecutarlo le doy f5 Sí por qué Pues porque me hace falta el import mysql connector Vale qué ha pasado Table crimson clientes does not exist clientes con minúsculas vale F nombre doesn't have a default value pero no he insertado nombre En qué línea estás nada el error a ver petición insert into clientes values null a ver un segundo que ejecute esto contra la base de datos Okay Fil nombre ya Es que no quiero insertar nombre vale sql insert Ah no sí sí insert en tu clientes identificador values null vale vamos a ver insert into cliente values null creo que es porque ahí está porque clientes quiere ser not nul no OK le he dado guardar vale lo que quiero es insertar un cliente vacío ar un cliente vacío luego para cada uno de estos Campos actualizar Eso sí se me ha quedado frito se me ha quedado frito se me ha quedado frito voy a recargar sudo service apach 2 restart Vale ahora vuelve a cargar crimson vamos a verlo voy haciendo una cosa voy formateando las peticiones mientras esto arranca vamos a ver esto no esto de hecho lo puedo quitar Y dónde estás aquí esto fuera esto afuera print petición Más que nada porque quiero imprimir las peticiones para que veáis vale para que simul esos qué es lo que va a ocurrir Ok y ahora digo petición es igual update clientes set y ahora aquí está la cuestión set mapeado clave igual a valor punto y coma a ver igual a diccionario de clave de cero voy a print petición me falta un we eh qué te ocurre que quieres que sea String lo convierto en String lo convierto en String okay Y entonces en primer lugar inserta un cliente vacío a continuación va a pedir Cuál es el identificador de ese cliente y por tanto set o sea update clientes set dirección es igual a la calle de José Vicente set apellidos es igual a carrat sanchis set email es igual a info @ jarsa set igual a lo que sea vale va a actualizar todo eso que tenemos en la pantalla antes de eso vamos a ver cómo Va sql pues nada sigue frito No ya está Vale vamos a estructura vale predeterminado nul vamos a ver si esto es la solución que creo que sí Entonces momentín porque ahora ejecuto y ahora me dirá Field apellido enault value vale Eso quiere decir que tengo que modificar vamos a ver vale nulo previsualizar sql Okay sql change apellidos ok no te cuelgues Ay May sql tiene estas cosas que es que de vez en cuando se queda frit tisimo por nada entonces voy a reiniciar local Host php my admin eh reiniciado Apache Me voy a ir a sudo mysql u Root vale use crimson vale eh Show tables okay Y entonces eh alter Table clientes vamos a verlo y aquí también se queda frito Qué raro que para un alter table se quede frito pero bueno query abor Ay qué rollo voy hacer una cosa igual acabo antes si consigo que funcione pH admin y rehago la tabla pero para eso tengo que hacer que funcione php ad Ah no ap2 no my sql Ok venga crimson Okay crims me voy a cargar clientes Okay Vale y voy a crear una nueva tabla clientes igual a cabo antes clientes nombre apellidos no me acuerdo email dirección población CP me falta algo pero no sé qué es nombre apellidos dirección email CP población país marchar marchar entero 255 255 este es índice primario autoincremental y aquí lo puedo nule vale Yo creo que ya este no yo creo que ya le doy a guardar muy bien Ahora todos admiten el valor nul con lo cual si todo va bien le doy a f5 unown identificador Qué dices No he puesto identificador soy un crack Vale pues un momentín agrego una columna al comienzo de la tabla claro este a ver Mira qué liada que hecho aquí eliminar Ok vale eliminar se queda frito Ok estructura nombre eliminar se ha quedado frito no otra vez eliminar el desbloqueo vale r Ay señor va r crimson iniciando clientes estructura me cargo clientes Ok creo una nueva tabla llamada clientes de ocho Campos y este es identificador entero 255 índice primario auto incremental vale esto es nombre apellidos email dirección población CP y país marchar bar charar marchar Caray que desafortunado lo mal que se está portando la base de datos hoy vale todo es nule menos el identificador Obviamente con lo cual si todo va bien guardar Ok venga y si ahora todo ya está bien okay Vale Eso quiere decir que Acabo de crear Ahora sí venga por fin un primer cliente con identificador uno con nombre nul apellidos nul email nul dirección nul población todo nul vale porque ahora quiero averiguar a continuación 015 ahora averiguo el ID del cliente vengo por aquí y digo okay petición es igual a Select from clientes Select identificador from clientes order by identificador des limit 1 eso qu quiere decir Dame únicamente el último identificador que acabo de meter Así que python mysql Select fetch all sí Ok venga este es esto es cursor execute petición resultado es igual a cursor fetch all print resultado vale me dice dos es decir el cliente que acabo de insertar es el número dos quiero resultado de cer ok tres ahora con lo cual identificador es igual a TR vamos a ponerlo Dame únicamente el último dador que acabo de meter ejecuto la petición obtengo el resultado creo un identificador vale Y ahora a continuación update clientes we identificador es igual a má String identificador Vale ahora sí si todo va bien si he metido el identificador 4at Eso quiere decir que update cliente set dirección la calle de José Vicente we identificadores igual a número 4 set apellidos es igual a carratala sanchis identificador es igual a número cuat y así con cada uno de los campos Así que ahora sí ejecutamos Y si todo va bien f5 me voy a la base de datos Y en clientes tengo el cliente número cco José Vicente carratala sanchiz inf jocsa la calle de José Vicente Valencia 4600 país pero vale Y con esto empezamos a acabar el ejercicio Esta es la recta final del ejercicio pero la idea de esto es que si os dais cuenta hemos importado en mysql a partir de un archivo de Excel donde los nombres de columna no coinciden pero hemos hecho un archivo de mapeo y donde el orden de las columnas no coincide Incluso el número de columnas podría no coincidir y no pasaría nada vale porque hemos hecho un Script que nos ha costado Pues un buen rato de desarrollo y nos ha costado ar unas cuantas neuronas por nuestra parte pero una vez que lo hemos conseguido tenemos un Script que importa prácticamente cualquier cosa es decir donde el archivo de Excel puede tener cierta flexibilidad porque no pasa nada porque luego lo vamos a poder meter correctamente dentro de mysql bien únicamente me quedaría a continuación por aquí pues el ver que estamos metiendo todo el rato la clave cero es decir estamos metiendo el primer registro de la base de datos así que por ello vamos a verlo 016 ahora averiguo la longitud de los datos Cómo puedo averiguar la longitud de los datos pues vamos a ver eh vamos a ver si tenemos la forma más sencilla que tengamos de hacerlo How to know How many Lines in Excel file not Counting headers a ver que me dé la respuesta más sencilla posible voy a de ver Ah no eso es esto es lo que quiero Perfecto entonces esto por aquí vale líneas es igual a contenido vale Okay un momento y no aquí vale Esto es lo que quiero Vale y conexión cursor okay mi contenido o contenido global es igual a read Excel clientes con lo cual líneas es igual un momento líneas es igual al n de contenido y entonces digo for I in Range de 0 a líneas meto todo esto dentro del for y aquí donde pone un cero vamos a ver Okay Ok aquí donde pone un cero pongo una I si esto ha ido bien creo que sí y ahora comento lo que falta Okay Vale José Vicente y Juan y si esto ha ido bien me vengo aquí y José Vicente y Juan lo cual quiere decir que ahora a continuación Yo podría venir por aquí y decir dirección una calle más apellidos eh Martínez López email del cliente su email @ email.com código postal un código país eh yo que sé alem nombre del cliente gerhard población del cliente enen vale guardo me lo paso ya sabéis del escritorio a la carpeta correspondiente vale me lo paso del escritorio la carpeta correspondiente y ahora a continuación si ejecuto tenemos tres inserciones lo cual quiere decir que me voy a la base de datos recargo y tengo aquí gerhard marínez López su email @email.com una calle más de enen en Alemania vale lo que lo cual quiere decir que si os fijáis hemos hecho algo que incluso es más potente que lo que hace php my admin porque lo que hace php my admin como no coinciden las columnas no te va a entrar en la importación pero con lo que hemos heo nosotros Sí vale entonces vamos a ver que me queda por Leo el contenido del archivo de Excel Ahora quiero saber Cuántas líneas tengo que importar y por lo tanto y por lo tanto hago un bucle for hago un bucle for para asegurarme que eh pongo tantas líneas como sea necesario vale que repito el proceso Tantas veces como sea necesario bien qué me quedaría por hacer Bueno pues por ejemplo en este caso yo aquí eh tengo un archivo digamos de línea de comandos y quizás no nos costaría mucho eh hacer una pequeña interfaz de usuario como las interfaces de usuario que hemos hecho hasta ahora sobre todo en una gran medida son de tipo web pues vamos a meterle una pequeña interfaz de usuario de tipo teca inter Y así pues Tendremos una aplicación que podemos llamar en ventanas vale vamos a verlo y 017 crear interfaz de usuario Y entonces digo from o import tc inter astec y por ejemplo por aquí por abajo digo ventana es igual a tk.tk ventana min Loop lo cual quiere decir que importo y creo una interfaz de usuario a continuación lo que voy a hacer es eh vamos a ver tk Button en la ventana text Define el archivo de entrada punto pack pad x es ig 10 pad y es = 10 esto qué quiere decir pues que crea un botón de definir el archivo de entrada vale a continuación le digo action es igual definir Pues claro definir tiene que ser una función con lo cual le digo Def definir es print Ok definimos archivo de entrada f5 vale Okay Ah perdón action no es actiones command vale Y defin Okay definimos archivo de entrada vale a continuación digo a ver tk Label text es igual a primero carga el archivo de Excel Vale ahora tk Label ahora indica el nombre de la tabla en la que vas a importar punto pack Y entonces tk punto entr es en la ventana Esto va en la ventana Espera que aquí me faltan un montón de cosas ventana coma text es igual a esto y eh Y text variable es igual a nombre tabla me dirá que nombre tabla no existe Okay nombre tabla is not defined por lo menos empezáis a ver la interfaz de usuario Así que digo eh nombre tabla es igual a tk String bar creo que es así no Ah Sí perdón y punto pack OK ahora indica el nombre de la tabla en la que vas a importar Y por último ahora ejecutamos y voy a crear un buton que diga Vamos allá command Vamos allá y defino una función llamada Vamos allá le doy f5 vale primero carga el archivo de Excel ahora ponemos el código para que lo cargue Define el archivo de entrada luego el nombre de la tabla donde se va a importar Y a continuación Vamos allá vale podría por ejemplo también poner Dime el archivo que contiene el mapeado para la importación vale Yo que sé eso ya evidentemente como os podéis imaginar podemos Añadir con poco esfuerzo más tantas variables como podáis pensar Vale entonces ahora 018 creo variables y digo archivo Excel o ruta archivo Excel es igual a noun vale Y ya Okay entonces global ruta archivo Excel y ruta archivo Excel es igual a tk Ask for file momentom te inter Ask for file venga tú puedes no quiero eso pero vale va file diogo vale esto para empezar esto y ya está file dialogo Ask for ask Open file name lo cual quiere decir que cuando le doy a definir me dice dónde está el archivo vale le digo es el archivo clientes xls no lo pone pero lo ha seleccionado ahora le doy a clientes que es el nombre de la tabla en la que lo voy a importar Y por tanto ejecutamos vale Cómo ejecutamos Bueno pues 019 llamo a la función un momento que se me ha apagado el monitor llamo a la función con parámetros Y entonces le digo vamos allá es esto Vamos allá es esto vale Vamos allá Ok con la ruta archivo Excel Ok no hace falta incluso puedo decirle global esto es muy guarro Pero vale Y esto es esto ruta archivo Excel y esto es nombre tabla get nombr tabla. get y nombr tabla. get Y esto es Rut archivo Excel vale con esto lo que he hecho Si ha ido bien que seguro que algún error he cometido es convertirlo en Dinámico f5 vale invalid syntax Perdón madre mía tengo la cabeza php y lo he puesto con puntos por algún motivo vale vamos a ir cambiando a vamos a probar Define el archivo de entrada el archivo de entrada es clientes xls Define el nombre de tabla voy a poner ggg Vamos allá muy bien insert into gggg identificador values null fantástico crimson ggg doesn't exist OK ahora en lugar de decir ggg voy a decir clientes Vamos allá y ahora sí importa los clientes correctamente Y si ahora me voy a la de datos pues compruebo aparte de que he importado un montón de veces vale compruebo que todo se ha importado Bien voy a vaciar Okay está vacío vale con lo cual defino el archivo de entrada que es clientes defino la tabla de mysql donde voy a importar que se llama clientes le doy a Vamos allá y ahora me voy a mysql le doy a clientes y veo que tengo los clientes desde la hoja de Excel correctamente importados dentro de la base de datos vale con esto finaliza la clase de hoy entonces eh vamos a ver si nos queda algo por comentar que Seguro que sí 020 comentarios y entonces creo una ruta vacía de momento está vacía vale mensaje estático en pantalla pero Traigo a la función la variable global y le igualo el valor de abrir un archivo con decer es decir el ask Open file name lo que hace es que te Abre esa ventanita de di qué archivo quieres y el archivo que tú quieras te lo mete la ruta vale Te lo mete en esa variable ahora vamos allá esta función solo se ejecuta cuando pulsamos el botón final Traigo eh qué ha pasado traigo la variable global mensaje estático y ahora ya a importar vale Y por aquí me faltaba esto ya sabéis que es lo típico de tk inter que no tiene mucho misterio lo he intentado hacer lo más sencillo que he podido que es creo una ventana defino una variable para el entry de tc inter es un rollo porque hay que hacerlo con ese tipo de variable pero es lo que hay es lo que manda tecin no es porque yo quiera creo una etiqueta creo un botón creo una etiqueta creo una entrada o sea un input digamos para entendernos creo una etiqueta creo un botón un tobón no un botón e impido mediante el Main Loop impido que la ventana se cierre cuando el programa se ejecuta fuera de python y ya está Entonces cuál es el objetivo cuál es el sentido de lo que hemos hecho en la clase de hoy pues el sentido de lo que hemos hecho en la clase de hoy es que entendáis que en un sistema de gestión empresarial en el cual todavía estaremos trabajando muchísimo dentro de phpm sql pero si os interesa pueden existir de hecho suelen existir utilidades adicionales para realizar cosas que no interesa hacer en la interfaz principal Generalmente la importación en masa de clientes No es algo que haga el usuario desde la interfaz principal es algo que hace el administrador desde la parte de atrás ahora por qué ha sido python Pues porque tiene la librería que es muy sencilla de trabajo con XL con xls Por qué le hemos hecho una interfaz al final pues porque sí podríamos no haberla hecho podríamos haber manejado el programa mediante línea de comandos Por qué le hemos hecho una interfaz con tc inter cuando podríamos haber hecho una interfaz web Pues podría os haber hecho una interfaz web es decir el concepto es que cuando hacéis un sistema de gestión empresarial podéis crear utilidades que manejen que operen directamente con la información o sea el objetivo no es tenéis que hacerlas en python no tenéis Por qué hacerlas en python podéis hacerlas con lo que queráis el objetivo no es que penséis que tenéis que hacerlas con tkinter no lo de tk inter ha sido para darle un poquito de formita visual a la aplicación vale la idea es que sepáis que en un momento dado puede ser muy normal como ya os digo la importación de clientes es lo típico vale que en una aplicación empresarial Pues tengáis que programar aplicaciones adicionales al propio uso desde el Front de la aplicación bien pues como os digo con esto finaliza la clase de hoy de sistemas de gestión empresarial ahora haré un Push e yo creo que hoy no voy a tener problemas de subir vídeos pero los Voy subiendo ya vamos a ver