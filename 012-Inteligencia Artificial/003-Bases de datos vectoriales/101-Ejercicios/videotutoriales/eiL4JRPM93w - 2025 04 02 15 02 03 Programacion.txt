bien pues vamos a ir Empezando voy a abrir un editor de texto y iniciar vale Y yo siempre digo y no es que lo diga yo vale es que realmente es así que eh el desarrollo de aplicaciones forma parte de El concepto más global llamado informática y la informática si os fijáis realmente es el tratamiento de la información tratamiento de hecho Generalmente utilizando medios automatizados a través de medios automatizados de la información eso qué quiere decir pues eso quiere decir que en la informática Generalmente lo importante no es el programa Lo importante es la información ahora mismo eh os puede parecer que esto no es así os puede parecer que lo que os cuesta un montón de crear es el programa y eh y parece que el dato entra solo vale el dato es algo que el usuario ya va metiendo y se almacena en la aplicación y ya está pero con el tiempo os daréis cuenta de que de la misma forma que pasa en fotografía lo que vale es la fotografía la cámara no vale para nada vale puede parecer que no es así porque decís una vez que me he comprado una cámara puedo hacer tantas fotografías como quiera y las fotografías no cuestan dinero y es cierto que las fotografías no cuestan dinero de la misma forma que meter datos No Cuesta dinero pero lo que vale realmente es la fotografía no es la cámara tú tienes una fotografía de No lo sé de tu familia de tus hijos de lo que sea se te pierde esa fotografía se borra esa fotografía se destruye esa fotografía y tú no puedes regenerar esa fotografía puedes hacer otra quizás a veces no pero no puedes regenerar esa fotografía en cambio la cámara se te rompe y tú vas a la tienda y te compras otra igual o mejor la cámara tiene unos pocos años Te dirán mira esa cámara ya no se fabrica pero ahora tenemos esta otra que es mejor vale Así que pero con la fotografía no te pueden en la tienda no te van a dar esa fotografía es única y si se borra ya no existe por tanto con el tiempo os daréis cuenta de que la fotografía tiene mucho más valor que la cámara de la misma forma que la información Aunque ahora mismo no os lo parezca pero la información tiene más valor que el programa informático se te borra pues haces otro y probablemente cuando hagas otro Será mejor que el que hiciste la primera vez pero el dato si se borra puede ser bastante traumático de esta forma la asignatura de bases de datos en primer curso y luego ya que estamos acabando el primer curso pues vamos también un poco hablando de lo que ocurre en el segundo curso la asignatura de acceso a datos en el segundo curso Son asignaturas son módulos profesionales que tienen como objetivo eh mostrar a los alumnos diferentes vías para almacenar la información de forma persistente Y de forma que sea fiable que resulte fiable en el uso en el primer curso en el primer curso sobre todo nos centramos en sql en las bases de datos relacionales basadas en el modelo relacional lo cual quiere decir que los datos contenidos en las bases de datos guardan o pueden guardar relaciones entre ellos Por qué Pues porque el modelo sql intenta ser una solución para problemáticas que se dan en la vida real el modelo sql no es algo inventado para fastidiarlos sino que el modelo sql dice a ver si en la vida real en la lógica de negocio de muchos empresas Pues hay datos que están relacionados pues vamos a construir un sistema de gestión de base de datos que replique de forma informática estas relaciones entre los datos vale por tanto como os digo el lenguaje sql pues intenta ser una solución a un problema que luego resulta que pues bueno es innegable que el objetivo del lenguaje sql es resultar lo más sencillo posible y yo creo que en gran medida se consigue en el sentido de que eh si sabes inglés ya casi sabes ese huele Pero bueno pues luego inevitablemente el lenguaje se va complicando y al final acaba teniendo muchos recovecos vale de tal forma que en primer lugar lo que vamos a hacer hoy es una eh revisión un repaso también antes de profundizar y una organización de los conceptos que conocemos más los que vamos a ver entre hoy y mañana acerca de sql la sintaxis de sql de hecho se puede organizar esto os lo conté el primer trimestre pero no hemos vuelto a hablar de ello voy a abrir esto por aquí vamos a ver formas de organizar las sentencias sql vale Y está el lenguaje debl está el lenguaje vale vamos a ver y no me refiero a esto no no me refiero a lo de ddl y todo eso o sea me estaba poniendo diferentes formas de organizar los comandos en sql no me refiero a eso vale me refiero a esto de aquí bien entonces a partir de Aquí vamos a empezar viendo que tenemos el ddl o lo que es el lenguaje de definición de datos cuando hablamos de definición de datos hablamos de que antes de empezar a introducir datos en una base de datos hay que Definir la base de datos qué comandos encontramos Bueno pues encontramos el comando create database create Table vale database Table View sirve para crear entidades eh entidades existentes vale No puedo create algo que yo me invente no vale entidades dentro de la base de datos También tenemos lo hemos visto alter para alterar la estructura de una entidad existente alter Table hemos visto de vez en cuando vale sabemos que la alteración de estructuras de base de datos Pues a ver no es recomendable Pero bueno no hay más Remedios lo que hemos comentado muchas veces de que teóricamente diseñamos una base de datos en entre comillas en papel y lo que diseñemos luego lo implantamos informáticamente peres es la teoría en la práctica pues van surgiendo cambios a medida que la aplicación se pone en marcha y la gente la empieza a utilizar vale tenemos Drop en algunas bases de datos se hace con delete por ejemplo delete en el secitec no hay Drop que nos sirve para eliminar eh dejar caer entidades de la base de datos por ejemplo para borrar tablas enteras Vale cuando en algún momento por los motivos que sea pues eh necesitamos borrar una tabla entera no Borrar el contenido sino borrar la tabla en sí misma vale la estructura yo siempre suelo decir que pues a mí las operaciones de create no me dan ningún miedo las operaciones de alter me dan bastante respeto y las operaciones de Drop pues me dan mucho miedo mucha precaución porque estamos hablando de Borrar datos vale Y luego hablamos de truncate que es vaciar una tabla o una entidad de forma rápida y muchas veces reiniciando las claves podríamos decir que en cierta forma no es lo mismo vale pero en cierta forma es un atajo para un delete a todo bien vemos por lo tanto que antes de meternos en las propias los propios comandos de trabajo con la base de datos Pues hay una cosa que es el ddl vale Y el ddl como comentamos es el lenguaje mediante el cual definimos los datos bien eh tenemos a continuación el dml que es manipulation donde dentro del lenguaje dml por ejemplo aquí eh chat gpt me está diciendo que tenemos los comandos crud que son Select para read insert para create update para update y delete para delete algunos autores defienden que existe el grupo dql que es Data query Language en el cual está situado Select y insert update y delete es el dml vale lo digo porque cada autor defiende una cosa son diferentes formas de organizar la misma información vale con lo cual pues Si alguna vez lo veis como que ML es insert update y delete y dql es Select Pues bueno es otra forma de verlo vale No es que sea contrapuesto simplemente es otra interpretación otra forma de organizarlo vale esto ya lo conocemos Vale crud pues son las operaciones más comunes para trabajar con bases de datos son el 95 por del tiempo dentro de una base de datos desde el primer trimestre he dejado Claro que trabajar crud es lo principal que tenéis que hacer vale No quiero que os aprendáis create de memoria no creo que no quiero que os aprendáis alter de memoria no vale la pena porque no todos los días alteras tablas de la base de datos pero sí que es conveniente aprenderse de memoria Pero porque lo utilizas vale No porque te lo estudias sino porque solo de utilizarlo inevitablemente te lo acabas aprendiendo de memoria Vale pues aprenderte insert Select update y delete simplemente vale es lo único que las únicas cuatro cosas que quiero que aprendáis de memoria Pero insisto de utilizarlas vale No de poneros a memorizar que no tiene ningún sentido vale luego hay una cosa muy importante dcl que es control o lo que es lo mismo acceso a la información cuando trabajamos con bases de datos es muy importante controlar quién accede a la información a qué accede Y cómo accede tenemos El Comando gr para otorgar permisos y tenemos El Comando revoke para quitar el otorgado anterior de permisos una vez más el gr no me hace falta que os lo aprendáis de memoria porque no todos los días se dan y se quitan permisos teóricamente es algo que ocurre muy de vez en cuando el gr lo haces al principio de la aplicación y ya está vale Pero lo que sí que me importa obviamente es que tengáis en mente que existen comandos para otorgar y para revocar servicios bien Y a partir de aquí mira ves Mira eh Data query Language algunos actores lo separan de dml vale lo que os decía antes bien a partir de aquí eh tenemos el eh transaction control Language aquí es donde amos un poquito lo nuevo entre comillas de hoy y de mañana que es tcl que es eh transaction Uy vale Qué es transaction que son transacciones en sql Qué son transacciones vale trans acciones son acciones en paquete que eh requieren ser completadas para ser fijadas en la base de datos vale por ejemplo tenemos comit nada que ver con el comite github es otro concepto diferente vale que confirma tenemos rollback que hecha vuelta atrás tenemos vamos a ver save Point como los videojuegos para crear un punto de restauración Y tenemos set transaction para propiedades vamos a ver yo vengo ahora mismo del mercadona de un par de bebidas y unos Donuts y tal y cada vez que tú en el supermercado tú pones comida en la cinta tú inicias una transacción implica que yo pongo comida en la cinta a continuación la persona que esté atendiéndome en el lineal de la caja pasa los productos marca los productos los suma me da un importe y yo a partir de ahí lo que hago es que saco un medio de pago físico o digital y realizo un pago y una vez que se confirma que el pago es correcto o bien el billete que yo he entregado es verdadero vale no es falso es de curso legal o bien la operación digital no es declinada Es decir es aceptada tarjeta de crédito o lo que sea en ese caso Se confirma la transacción y la persona que hay en el lineal me deja retirar me deja llevarme los productos qué ocurriría si yo pongo los productos y por lo que fuera en un momento dado declinar a mi tarjeta de crédito o mi billete no fuera verdadero Pues que la persona del lineal diría tu medio de pago no es válido por tanto retiro los productos de lineal no te los puedes llevar vale eso es una transacción es una un intercambio de información en el cual se realizan una serie de acciones y solo cuando las acciones son exitosas es cuando Entonces se completa El proceso y si durante el proceso hay alguna de las acciones que no es correcta pues se hace un rollback y al hacer un rollback se deshacen los cambios es decir yo pongo los artículos el medio de pago de fallido pues se retiran los artículos y ya está Vale nosotros hasta el momento lo que hemos estado haciendo muchas veces es Oye inserto oye retiro Oye elimino qué ocurre si en algún momento cuando un conjunto de operaciones es más complejo que simplemente un insert algo falla pues o problema ya estaba hecho el cambio vale con lo cual pues una de las herramientas que vamos a ver entre hoy y mañana Es que en sql no es que sea obligatorio usarlo siempre pero si en un momento dado te ves que tienes un conjunto de operaciones que requieren Pues que te selecciono que te inserto que elimino y unas dependen de las otras es para decir Oye pues que sepas que existe el concepto de transacción vale más cosas que existen dentro de sql bueno por último dql vale vamos a ir a local Host vamos a ir a php my admin vamos a ir a rot y Estuvimos viendo el otro día ayer que tenemos más cosas por ejemplo mi empresa vale Estuvimos viendo que tenemos como entidades tenemos las tablas en las tablas guardamos información es la entidad Por defecto para trabajar la información dentro de las bases de datos en sql a lo largo de los meses hemos visto que tenemos vistas las vistas básicamente son eh algo que ocurre cuando realizamos consultas de tipo Select a una base de datos Y esas consultas son complejas por ejemplo acumulan muchos join podemos guardar esas consultas en forma de vistas y ahora con esto a continuación voy a poner unas cuantas cosas más y analizaremos vale de para qué quiero crear una vista cuando yo por ejemplo en el lenguaje de programación puedo poner una sentencia muy compleja de Left join left join es decir se queda guardado Bueno pues se puede quedar guardado en un Script en php en python en node donde quieras Vale ahora hablamos de ello bien más cosas que tenemos por ejemplo procedimientos lo que se llaman procedimientos almacenados que además pueden tener parámetros de entrada y de salida los procedimientos almacenados equivalen conceptualmente evidentemente no sintácticamente a las funciones dentro de los lenguajes de programación además aceptan parámetros lo que nos permite personalizar el comportamiento de los imientos lo cual una vez más nos lleva a la pregunta de para qué quiero algo que se parece a una función cuando en un lenguaje de programación tengo un soporte extensísimo para funciones es más tengo objetos Vale y de hecho en las bases de datos en sql por lo menos en May sql no hay algo como objetos como clases ayer estuvimos en empezando a ver que también tenemos triggers eh gatillos que eh a esto lo llama eh Espérate que te lo digo no rutinas son procedimientos almacenados disparadores vale disparadores los disparadores son acciones condicionales como las estructuras de control del flujo de la información de tipo condicional If Else If una vez más bueno actúan cuando se dan una serie de circunstancias concretas insisto como el If cuando se dan una serie de circunstancias concretas en un lenguaje de programación el If atrapa esas condiciones dentro del paréntesis Y si validan como ciertas Pues ejecuta otro bloque de código vale Y qué más tenemos también eventos vale tenemos eventos y poco más realmente tenemos eventos que son acciones que se realizan de forma puntual o de forma periódica similar a lo que conocemos como cron en sistemas unix Linux Ejecutan tareas de forma Autónoma y programada por ejemplo para mantenimiento una vez más nos podemos preguntar qué sentido tiene hacerlo dentro de sql cuando ven cualquier sistema unix Linux donde básicamente vuestro equipo de desarrollo muy probablemente estará en Windows pero el servidor que contraté muy probablemente estará en Linux cuando en el servidor ya Vais a tener soporte para eventos bien la cuestión es la siguiente esto que voy a comentar no es una imposición ni siquiera es mi opinión personal simplemente os informo de tendencias en el desarrollo de aplicaciones y vosotros A partir de ahí pues ya elegís la que queráis o elegís la que más os convenga para cada proyecto concreto eh una tendencia consiste en mantener toda la lógica en la programación en el lado de la programación y usar las bases de datos solo para eh almacenar datos digamos un concepto bastante estático sin embargo otra tendencia ya os digo que no es ni mejor ni peor que la anterior otra tendencia consiste en que dentro del gestor de base de datos se ejecuten tantas operaciones como sea necesario para realizar una gestión completa H hasta el punto que se pueda y dinámica de los datos Y proporcionarle al lenguaje de programación es decir transportar los datos desde la base de datos hasta el lenguaje de programación ya masticados es decir ya preparados Oye hay que hacer un join entre tablas pues se hace en la base de datos no se hace en el lenguaje de programación vale todo esto como veis son como os digo Son herramientas que vosotros en un momento dado podéis utilizar o podéis no utilizar en este caso lo que voy a hacer va a ser desarrollar una serie de eh de operaciones Entre hoy y mañana sobre una base de datos para crear un sistema de gestión empresarial otra vez una vez más eh empezamos un poco a avanzar lo que en el curso que viene veréis no solo en acceso a datos sino también en una asignatura que se llama sistemas de gestión empresarial vamos a por ello antes de ir antes de ello voy un momento a mi y Hub para insisto confeccionar un mapa lo más completo posible de sql vamos a ver sql vale sql tenemos tipos de datos esto es un repositorio mío del año pasado vale Ah bueno Espérate bueno fundamentos Ok Esto está claro vale vamos a hablar también vamos a hacer un repaso de los operadores vale operadores cláusulas funciones nada que ver con los procedimientos almacenados claves foráneas join Y bueno bas ya hemos hablado de ello y exportación e importación Vale y importación OK Vamos a ver qué más tenemos por aquí tipos de datos hablamos también de los tipos de datos Ok operaciones nada fuera esto es otra cosa procedimientos transacciones y disparadores vale el objetivo un poco es no dejarnos nada vamos a intentar no dejarnos nada en el ejercicio que vamos a hacer Entre hoy y mañana aprovecho para decir que aprovecho para decir que las bases de datos sql constituyen una forma de guardar la información vale sobre todo segundo curso también estaremos trabajando con otro formato como es el jas que nos propone otra forma de guardar la información el formato sql para guardar información durante décadas ha sido el estándar a día de hoy pues los formatos basados en objetos como insisto el jas a través de deb similares Pues bueno poco a poco le van comiendo terreno a sql pero poco a poco vale porque por mucho que el formato son sea muy Guay pero sin embargo Todavía siguen existiendo un montón de casos en los cuales el lenguaje sql te resuelve mejor la papeleta que el formato basado en objetos vale por tanto sql no tiene pinta de que vaya a ser un lenguaje que vaya a morir en los próximos años y por tanto mi recomendación es aprender bien sql vale todo el cariño que le pongáis sql Pues luego lo Vais a recuperar bien Así que vamos a diseñar una base de datos de una empresa y vamos a intentar aplicar el máximo número de conocimientos de estos que estamos trabajando aquí de tal forma que en el ejercicio que vamos a hacer Entre hoy y mañana vamos a intentar llevar a cabo vamos a intentar llevar a la práctica esta tendencia que consiste en intentar hacer lo máximo posible dentro de la base de datos e intentar hacer entre comillas lo mínimo posible dentro de eh la programación aprovecho para deciros que en estas semanas anteriores vosotros habéis visto que yo soy bastante fan lo tengo que reconocer de sec kulite por la simplicidad más que nada y por la facilidad No es que sea fan de sec kulite soy fan de lo sencillo pero en el ejercicio de hoy y de mañana pues tengo que ir a mysql Más que nada porque eh mysql es la base de datos que a día de hoy pues yo creo que tiene mejor rendimiento mysql o María deb como lo queráis ver entre gratuidad Vale y prestaciones evidentemente hay otras bases de datos que incluso podemos decir que son más potentes como Oracle o Microsoft sql server que insisto tienen todavía más funcionalidades que mysql o Marí db pero también tienen un coste asociado vale Y aparte son bases de datos propietarias con lo cual pues ya sabéis que soy bastante precavido y más en estos días con respecto a esa cuestión bien Entonces vamos allá vamos a empezar diseñando lo que sería un erp que es un Enterprise resource planning que es una aplicación de gestión empresarial vamos a empezar por lo sencillo Vale entonces para ello me vengo por aquí esta mañana le estado dando bastante esto de monday aquí me van desapareciendo y apareciendo cosas esto de monday Qué es ahora bueno da igual ya lo veré bien entonces me voy a los tres mini ahora me ha dado curiosidad queé poñer es esto de monday Uh Qué curioso monday ok Ah okay chat gpt pero Sad interesante pues no mejor que no hoy es wednesday así que ahora luego Probaré esto ayer no lo tenía pero en fin da igual ahora luego Probaré algo que esté triste bien entonces en este caso Quiero crear un rp en mysql usando el mayor número de características funciones de mysql pero vamos a ir poco a poco en primer lugar y me lo voy a ir guardando voy a voy a cómo voy a llamar esto Pues no lo sé vamos a crear vamos a ver vamos a sacar los colores de proyectos vamos a ver uno que esté libre no Dark salmon ya lo tengo cogido es un software para fichaje de personal Vale pues no sé Dark turse yo creo que lo tenía pillado a ver medium turqu Oh sadel Brown vale sadel Brown es un rp hecho en mysql así que me voy a giub me voy a repositorios me voy a New me voy a hocar sel Brown vale readm cre repository aquí guardo no sea que se me corrompa vale me voy a ghub me lo clono a ver sabel Brown y aquí vale bien entonces pero vamos a ir poco a poco en primer lugar eh Quiero los comandos sql esto es muy importante en la clase de hoy los comandos sql para crear un conjunto de tablas básicas que podrían ser comunes a cualquier empresa vale O sea quiero algo que sea muy polivalente quiero clientes productos pedidos Y probablemente líneas de pedido vale algo así bien con lo cual algo que tenga cualquier empresa vale con lo cual le doy aquí a Play vale no le he dicho el modelo de datos voy a dejar que me lo gestione el sistema y yo Mientras tanto me voy a ir a hedit me voy a ir a sadel Brown vale me voy a ir a Bueno voy a crear una carpeta llamada sql dentro de sql voy a crear comandos sql voy a hacer la letra más grande que esta mañana me la puesto pequeña y vamos allá eh create Table clientes vale Y me pone una serie de características bien Me pone en este caso el los foreign Keys lo que hemos comentado anteriormente el on delete cascade an update cascade Vale y líneas de perido Okay fantástico vale copio pego y además en este caso también lo que voy a hacer es ejecutar Oye comandos sql Ah Espera que no estoy yo comandos sql Vale ahora sí esto fuera Okay perfecto vale okay Okay perfecto pero claro También quiero los comandos sql para crear la base de datos se llamará sadel Brown y garantizar acceso total a un usuario llamado sadel Brown con contraseña sadel Brown vale más importante todavía bien entonces en primer lugar aquí arriba creación de la base de datos vamos a ver Okay perfecto vale Vamos allá copiamos pegamos y ahora sí voy a poner aquí pues ya sabéis no separadores y tal creación de las tablas iniciales si os fijáis en Qué lenguaje va a estar hecha esta aplicación pues no se sabe todavía vale Simplemente estoy creando un modelo de datos en sql y así como en estas semanas anteriores Pues muchas veces hemos hecho el create Table If not exists insertado dentro de un Script php y todo eso pues hoy no vale hoy lo que quiero es que toda esta información todo este procedimiento de momento al máximo posible sea lo más agnóstico posible con respecto al lenguaje de programación y luego al final ya veremos en Qué lenguaje de programación lo implementamos Pero que sea lo de menos vale entonces eh Vamos allá Yo creo que ya igual por el tipo de contraseña o la seguridad no lo sé Pero bueno vamos a verlo me voy a local Host voy a quitar un momento esto Aunque Bueno luego igual vuelvo eh Me voy a local Host me voy a sql pongo por aquí y ya está Vale y en este caso pues como veis lo que estamos haciendo es utilizar el lenguaje de definición de datos bien le doy a continuar Okay parece que todo ha ido bien vale me voy a la base de datos ad del Brown y una vez que tengo la base de datos a del Brown os dais cuenta de que no he tocado prácticamente ningún botón todo lo he hecho sql Vale pues Ahora a continuación voy a crear las tablas Así que hago así me voy a sql está ahora Sí Dentro de sadel Brown tendría que decirle use sadel Brown le doy a continuar vale Y ya tengo dentro de sadel Brown Pues un conjunto vamos a refrescar un conjunto de tablas previamente creadas aquí como ya os digo antes de hacer nada más en php My admin no es necesario entrar en mysql en la tabla en la base de datos perdón vale tendría que decir use shadel Brown con este Comando estoy simulando que yo estuviera en un entorno a línea de consola puro y duro vale bien y uso del Brown Así que una vez que tengo esto Una vez que tengo esto ahora a continuación lo que quiero vamos a verlo eh vamos a hacer una tienda vale vamos a poner datos de ejemplo yo os pregunto qué vamos a vender no tengo ni idea prop ponedme algo vale Si no pongo lo típico que se pone siempre que es una tienda de ropa deportiva pero proponerme algo que sea políticamente correcto y tal Aunque en este curso muy políticamente correctos ha habido cursos anteriores donde la gente cada vez que preguntaba decían barbaridades pero no sé Vale entonces voy a decirle Dame o mediante consultas de tipo insert Dame de ejemplo para poblar en Las Cuatro Tablas que me has indicado Vale y la empresa vamos a decir que será de venta de artículos deportivos todos ellos ficticios de la marca jarsa vale Y así pues que no haya datos de Adidas ni nada de esto por ahí por la tienda OK Vamos allá en este caso evidentemente como siempre os digo pues una gran ayuda e chat gpt para no pasarnos a la media tarde haciendo insert zapatillas de 50 de no sé que no sé cuántos sino que le decimos lo que queremos y tardando menos de lo que tardaríamos nosotros pues me genera un montón de consultas insert para insertar datos aquí Mientras tanto voy a meter otro meas separador creación de un conjunto inicial de datos un conjunto inicial y ficticio de datos Vamos allá bien insertar datos en la tabla de clientes Así que copio la tabla de clientes eh insertar datos en productos copio la tabla de productos insertar pedidos en la tabla de pedidos insertar pedidos y eh vamos a ver Ah esto es Okay confirmado vale Y dos camisetas insertar datos en la tabla de líneas de pedido y vamos allá bien pues si todo va bien si todo va bien Vamos a ver okay vale si todo va bien eh Pues voy a copiar y pegar voy a intentar copiar y pegar a la bestia no creo que haya ningún problema porque parece que el orden de creación es el correcto así que me vengo por aquí en sadel Brown me voy a sql pego Por aquí todos los inserts le doy a continuar y todo parece correcto lo cual quiere decir que si ahora me voy a clientes pues veré que ha creado unos cuantos clientes por defecto me voy a líneas de pedido y aquí está el problema Vale y veo que ha creado unos cuantos pedidos vale confirmado y tal Ahora me voy a pedidos Vale y vemos como tengo pedidos ya creados y a continuación me voy a productos bien una vez que tenemos esto a continuación estamos trabajando con tablas estamos insertando datos en Tablas a continuación yo por ejemplo supongamos que lo que quiero es de cada uno de los productos para cada uno de los productos averiguar qué líneas de tiene ese o sea Perdona para cada uno de los productos no para cada uno de los pedidos quería decir así que de esta forma lo que quiero es crear una petición left join que una diferentes tablas para ello voy a hacer lo siguiente vamos a ver sql no aquí ahora utilizando join quiero crear una consulta que dado bueno que para los pedidos me dé los datos completos de cada línea eh Bueno cliente pedido producto y datos de la línea de pedido y en un sistema de gestión de bases de datos donde los datos están repartidos en múltiples tablas pues evidentemente cobra eh importancia la realización de peticiones sql mediante joins vale donde los joints lo que hacen es cruzar los datos de las tablas y darle sentido a tablas como esta tablas que parece que no tienen nún sentido Pero sí que tienen sentido porque ahí lo que tenemos son foreign kys vale lo que tenemos son claves externas a otras tablas Así que vengo por aquí le doy a copiar le doy a pegar le doy a continuar y veo que esta consulta le da sentido a toda esa información y dice Mira Juan Pérez vale que tiene estos datos pues hecho este pedido que está confirmado que tiene un total ID de línea cantidad el subtotal el producto vale Y tiene y la descripción y todo esto está genial vale vamos a hacer un poco un repaso de lo que estamos haciendo de operaciones espera aquí uno creamos la base de datos dos asignamos permisos tres creamos tablas cuatro eh insertamos datos de ejemplo ahora cco le damos sentido a los datos haciendo join entre tablas pero problema perdemos los datos los joins son volátiles en el sentido de que tengo un join que Mola mogón vale Voy a apuntarlo por aquí por supuesto join join vale hago un join la operación todo lo compleja que sea necesario pero hay un problema y es que en el que yo hago clic en cualquier parte realmente pues pierdo esta información acabo de perder el join es una pena porque en este caso el join me lo ha formateado chat gpt pero hay veces que un join pues te puedes tirar media tarde para formatear correctamente un join para que luego le hagas clic a cualquier sitio y lo pierdas y creedme me ha pasado a todo el mundo le ha pasado pienso bien entonces una herramienta para guardar vistas complejas son las V así que de esta forma digo Okay perfecto luego vamos a crear una vista para almacenar esta consulta entonces las vistas sirven para esto sirven para que cuando tienes una consulta que es compleja pero es super útil y la quieres guardar para el futuro pues te la guardas como una vista vale por aquí seis mediante vistas podemos guardar las consultas complejas que queramos conservar Cuando digo que queramos conservar quiero decir que hay veces que haces una consulta compleja y dices Bueno pero ya está ya no me sirve para nada más Pero hay veces que dices consulta la quiero utilizar más adelante todo lo que yo quiera Vale pues entonces me vengo por aquí me voy a sql fijaos que donde pones Adel Brown daos cuenta de que solo hay tablas por el momento solo hay tablas vale Así que hago así le doy aquí le doy a continuar y fijaos que entonces la información Se ha reorganizado aparecen tablas y aparecen vistas voy a copiar esto en el editor Vale y vistas y de esta forma yo siempre que quiera voy a poder hacer clic aquí vista líneas de pedido y ya está y el programa ya recuerda de hecho si le doy a vista y le doy a editar el programa recuerda toda la petición vale o sea que en cualquier momento la podemos volver a recuperar la podemos modificar mediante un alter de hecho y podemos hacer lo que queramos las vistas son Guay vale porque las vistas como hemos visto la redundancia me permiten eh guardar peticiones de tal forma que si yo el día de mañana en una aplicación quiero esto Quiero ver la información pues yo simplemente en el lenguaje de programación le diré Select all from vistas de no sé qué no sé cuántos vistas línea pedido completa no le tendré que decir Select y no sé qué y left join no vale Yo haré un Select all from vista y ya está y por tanto la Esta es la cuestión el ejercicio de hoy y de mañana la dificultad la complejidad se queda en la base de datos vale se queda donde realmente le corresponde como suele decirse al César lo que es del César es decir el tratamiento de la información a quien realmente trata la información que se supone que es la base de datos ya os digo que esto no pretende ser una verdad absoluta solo pretende ser una eh el presentaros una metodología vale que luego vosotros utilizaré o no bien pero esta vista es muy bestia en el sentido de que eh claro yo en un momento dado puedo decir es que yo en un programa informático hay veces que quiero ver todos los registros por ejemplo un listado de pedidos Pero hay veces que cuando yo selecciono un pedido Quiero ver los datos únicamente de ese pedido vale No quiero verlo todo esto en un lenguaje de programación es una función que acepta el parámetro vale tú dime qué pedido quieres ver mediante un parámetro de la función y según el parámetro que tú ya me hayas dicho yo te voy a mostrar un pedido u otro de esta forma eh yo lo que voy a hacer en este caso aquí de pedido vale Yo lo que voy a hacer en este caso es utilizar ese recurso que insisto no reemplaza a las vistas Ahora veréis cuando diseñen la aplicación que hay veces que querré vistas y hay veces que querré procedimientos almacenados vale Yo lo que quiero ahora a continuación es crear mediante procedimientos almacenados yo puedo realizar operaciones similares a las vistas realmente no es cierto con procedimientos almacenados puedo hacer mucho más que con las vistas pero aceptando parámetros qué voy a hacer ahora pues voy a decir mira ahora Quiero un procedimiento almacenado que si yo le doy el número de pedido me de únicamente las líneas de producto las líneas de pedido corres a ese producto a ese pedido Perdona es decir parámetro de entrada es el número ID de pedido enter en este caso estamos asumiendo que la propia clave primaria es el número de pedido cosa que no es que sea correcta e incorrecta puede ser correcta para este ejemplo para otros ejemplos puede no ser completo pero ya está No pasa nada bien así que en este caso creamos un procedimiento vale adaptamos el comportamiento copiamos nos venimos aquí procedimiento almacenado eh línea de ido no procedimientos almacenados vale no eh No pero quiero que contenga los mismos datos que la vista vale porque si no me va a dar claves si yo no quiero claves Yo quiero datos finales vamos a verlo vamos a ver ahora sí vale Ok esto es otra cosa bien creamos procedimiento vale me vengo por aquí me voy a sql démonos cuenta que tenemos tablas y vistas vale Así que creo procedimiento me voy a continuar y entonces ocurre lo siguiente vale eh voy a refrescar y al refrescar ahora en sadel Brown vemos que tenemos procedimientos tenemos tablas y tenemos vistas Y si yo ahora a continuación me ha aparecido algo por ahí y si ahora a continuación me voy a procedimientos veo que tendré un procedimiento llamado get líneas pedido completa y en este caso voy a ejecutar voy a ejecutarlo realmente se debería ejecutar desde el lenguaje de programación pero aquí dentro puedo simular una ejecución ejecuto qué pedido quieres ver quiero ver el número uno continúo pues mira ahí tienes el número uno vale Y ahora quiero ejecutar otra vez y quiero el número dos continúo me dice Mira pues aquí tenes las líneas de pedido del número dos De hecho si os fijáis crea un parámetro y a continuación llama a un procedimiento almacenado es decir call procedimiento almacenado utilizando un parámetro lo cual evidentemente quiere decir que me ahorro tener que hacer todo el join y intercalar un eh caray intercalar un parámetro encadenando cadenas con literales y variables y construir una sentencia sql dentro del lenguaje de programación no vale la idea es que el lenguaje de programación se quede lo más sencillo posible y que toda la información todo el tratamiento de los datos esté dentro de la base de datos bien Ahora a continuación vamos a eh realizar una transacción vale una transacción que derivará de cuá el cliente quiera insertar un nuevo pedido dentro de la aplicación la transacción se parece a lo que os he comentado antes vale que consiste en por ejemplo imaginemos que creo un nuevo cliente y el nuevo Cliente va a pedir productos Vale y va a insertar líneas de pedido y va a insertar pedidos eso qué es pues tres inserts Imagínate que el primer insert falla es como ostras pues no continúes haciendo lo demás porque el primero ha fallado o insertas un cliente pero el segundo insert falla Oh ya habías insertado un cliente con lo cual la operación se ha quedado a mitad de hacer vale entonces para esto y aquí es donde ahora veremos vale vamos a ver ahora eh okay perfect Now create a transaction simulating eh creating a customer New customer a eh A qué a order and order Lines y ya está prepare to make a roll Back If something fails vale con lo cual vengo por aquí Okay ocho y digo mediante transacciones puedo preparar de forma monolítica diferentes peticiones por ejemplo una compra y hacer rollback en el caso de que algo falle que en principio Pues en la teoría nada tendría por qué fallar Pero bueno ya sabemos que una cosa es la teoría y otra cosa es la práctica bien así que en este caso creamos un procedimiento almacenado ya que estamos chat gpt me ha hecho el favor de meterlo dentro de una transacción lo cual es Guay vamos a ver e Espera que se ha quedado frito vale eh aquí ahora voy a decir transacciones Vale y transacciones bueno se ha quedado frito vamos a verlo no sé si se me ha quedado frito todo internet vosotros me oís Sí parece que sí que hay internet Vale pues habr quedado frito chat gpt vamos a ver están ellos vale error Ok reintentar me ha pasado se ha quedado frito bueno no pasa nada aparte Ah vale Okay parece que el teléfono está fallando Bueno ya tiene bastante carga vamos a quitarlo vale vamos a ver vale Oh vaya ya sí pero vale en este caso lo que hace es que coge el Last digo OK Pero por favor conviérteme en un procedimiento almacenado eh que acepte el número de parámetros suficientes como para eh crear todos los datos de forma correcta es decir Tendremos que crear Pues un cliente nuevo con sus datos tenemos que definir pedidos productos No lo sé será un procedimiento almacenado Guay vamos a ver claro vale Okay me está proponiendo una simplificación Que de momento la voy a aceptar que es que eh en cada pedido haya una línea de producto vale Ok vamos a empezar por ahí y luego si acaso más adelante ya lo ampliaremos para que pueda aceptar un arreglo vale un conjunto de líneas de pedido Okay entonces démonos cuenta de que tenemos un procedimiento almacenado que tela los parámetros que acepta pero bueno lo que tiene vale de esta forma le doy a copiar y al pegar transacciones De hecho aquí lo voy a ejecutar le doy a continuar y si me voy a procedimientos ahora tengo crear pedido con cliente le doy a ejecutar momentín le doy a ejecutar y veo que tengo una rutina Donde tengo los datos de cliente tengo el ID de producto la cantidad y el precio unitario no haría falta a ver De hecho me está haciendo dos productos producto uno y producto dos bueno Vale me da igual lo que sea producto unitario yo creo que no es correcto porque debería venir indicado en el producto a ver a ver si producto ya tiene el precio a ver I think that unitary price as parameter of the of procedure is not correct since prices are already product Table vale es decir yo voy a decir cuántas unidades de ese producto quiero voy a decir qué producto quiero pero no tengo que meter el precio porque el precio ya lo sabe la base de datos vamos a ver okay se ha mencionado el coste de descuento No yo no he mencionado eso vale esto Mejor dime el ide de producto y dime la cantidad que quieres vale Ok Esto está mejor entonces voy a primero reemplazar esa transacción voy a eliminar la transacción crear pedido con cliente eliminar vale me voy a sql creo una nueva un nuevo procedimiento almacenado y ahora al ejecutar ahora sí dime los datos del cliente y dime producto uno y cantidad producto 1 y el programa ya sabrá Cuál es el precio cuando yo inserte la información vale Perfecto pues vamos allá otra cosa que quiero otra cosa que quiero por ejemplo es que cuando yo selecciono un pedido pues vamos a ver vamos a decírselo ahora le digo Ok perfect now I would like to create another procedure T When I Select pedido ID Give Me A the information about the customer the information about de eh order c total sum of products in the order de tax to apply 21 por IVA europe y e total o subtotal Plus taxes igual a total that information Will Go customer and order Data on top on header and totals on foter On A Future implementation of and use of Proc vale de momento no lo estoy haciendo pero e para pero le estoy avisando de qué para qué quiero yo todo esto voy a recargar vale vamos a poner esto bien y ahora a continuación vamos a hacer un evento vamos a verlo si yo creo que el chat gpt está un poco frito a veces pasa lo que pasa es que no quiero abandonar esta conversación más que nada porque le he dado toda la información de lo que estoy haciendo otra cosa es que en una nueva conversación pues lo que puedo hacer por ejemplo es meterle toda la secuencia de sql que para eso la estoy copiando para que otra conversación de chat gpt o el chat o dips o lo que sea pues puedan digamos saber qué es lo que estoy haciendo vamos a verlo vale Okay perfecto vale Okay y procedimiento datos de pedido vale Y local Host y sql y pego y continuar y tal vale Y ahora le digo ya tengo esto pero yo quiero que esto sea esto se convierta en una eh aplicación con usuarios vale por tanto ahora quiero hacer lo siguiente Ok perfect I would like to make application on top of this database later We Will a Table for users create initial user full name José Vicente carratalá email info @josé carratala comom user jarsa password jarsa a b c create a proceder to check login to check If user and password are correct return true or false vale Y ya está es decir en lugar de hacer la típica validación que hacemos siempre en php de te pido Devuélveme si es más que no sé cuántos es que sí y todo eso es como no vamos a hacer esa validación en la base de datos de tal forma que será la base de datos la que pregunté Oye existe este usuario sí o no dame verdadero O dame falso vale Así que vamos a crear por aquí usuarios Y entonces creo tabla usuarios inserto usuario inicial creo un procedimiento para validar login creo procedimiento para validar login y ahora aquí abajo Ah utilizar procedimiento vale Ok y Select login Ok vale Okay perfecto muy bien y vamos a hacer esto el Cómo utilizar el procedimiento Así que ahora hago todo esto yo creo que lo puedo hacer todo a paloseco menos el último evidentemente Y sql le doy a continuar todo correcto Vale y check login bien así que Okay no perdón cuidado check login esto ejecutar vale esto y esto le doy a continuar e Qué pasa Uh a ver a no Tiny int Hola a ver vale eh fallo a ver parece que hay un problema de colaciones entonces vale aunque sean de utf8 mb4 Okay entonces cómo solucionarlo Okay y Sí vale para ahora no meternos a cambiar colletion vamos a tocarlo directamente en el procedimiento y ya está vamos a ver no Ah paso tres vale Okay perfecto Pues eliminamos el procedimiento que no pasa nada eliminamos el procedimiento recreamos el procedimiento sí okay Vale perfecto y procedimiento y login y plu plu continuar Oh Ahí va la columna usuario en we y es desconocida qué ha pasado a ver la columna usuario no veo cuál es el problema en Where username When username no veo por es incorrecto username no sé vamos a hacer una cosa voy a llamarlo directamente desde parámetros porque yo creo que aquí my sql se está equivocando o sea pH ad Perdón continúo la columna usuario tía pero qué pasa jarsa por qué me dice usuario a ver procedimiento login editar we usuario okay we usuario es como que me la ha traducido Será posible a ver check login fuera sql Aquí no hay usuario vale procedimiento check log editar Ah esto es otra cosa Vale ahora aquí espera vale Cómo se utiliza Ay leches Cómo se utiliza Ah espera no sé por qué Aquí check login sql vale bueno otra cosa a ver qué tengo en los collections Ah vale Okay Ay vamos a cambiar las colaciones para lo cual me hará falta alter Table Pero bueno ya está pues hacemos Table y ya está Vale pues vamos a cambiar colaciones y esto entonces hacemos esto okay Todo cambiado teóricamente todo cambiado a unicode vamos a verlo y por tanto si ahora va bien volvemos a llamar al método Okay perfecto y dice login Ok 1 y si ahora hago así hago chucu fluc fluco y me devuelve cero vale con lo cual pues insisto nosotros vamos a llamar a un método a una procedimiento y la eh la base de datos es la que nos va a decir sí o no bien a continuación lo que quiero es crear un evento para esta base de datos vale para que pues cada x tiempo se realice una copia de seguridad de la base de datos Así que para ello digo vale Okay Now it works perfect Now please create an event repeat each one hour to create a full backup of the database y Ok venga Así que venimos por aquí vamos a crear vamos a actualizar un poco el código vale transacciones Ok puedo utilizar eventos para el caso de que quiera eh crear acciones repetitivas en el tiempo vale Okay y bueno ya ahora hablaremos también de triggers de disparadores vamos a ver okay okay into out file vale bar backups shel Brown vale está bien necesita el privilegio file en principio lo tengo creo que lo tengo vale Y okay vale Y aquí esto date format fantástico Esto es lo que quería esto exportar tabla clientes bueno no me lo está haciendo en un sql pero me vale Okay y crear un evento que invoque el procedimiento Okay Vale entonces eventos y ahora esto es procedimiento de copia de seguridad vale vamos a ejecutarlo vamos a definirlo Okay bar backup sel Brown vale Ok y creamos un evento y creamos un evento cada one hour vamos a dejarlo y crear evento Vale y creamos evento hacemos así continuamos an expected esto qué quiere decir Vale tengo procedimientos get Back Up del Brown Ah Espérate Espérate primero se cumple la condición me voy a otras ubicaciones me voy a backs me voy a sadel Brown no puedo bien vale entonces abro un terminal aquí Ok sudo madir sadel Brown Ok vale sud ch mod 777 men r Brown vale vamos a probar a crear el evento ahora tu aquí pego vale vamos a verlo continuamos unexpected error Bueno vamos a hacer una cosa vamos a hacer una cosa me voy a la base de datos me voy a crear un evento voy a crear un nuevo evento nombre del evento backup sadel Brown enable tipo recurring ejecutar cada one hour y inicio hoy vale inicio ayer Ok Ok y final yo que sé el final del mes vale definición la definición va a ser col sadel Brown y vamos allá continuar pues ya está Vale ha habido algún error indeterminado pero no pasa nada create event okay No aquí vale Y ya está no creo que haya hecho ya una copia de seguridad vamos a comprobarlo no todavía no vamos a dejarlo corriendo y ahora Luego lo vemos vale y vemos que pues tenemos una base de datos mysql que ahora está llena de colorines y de iconit y de movidas como tenemos tablas vistas procedimientos y eventos Y ahora yo creo que ya vamos llegando a lo entre comillas lo último vale vamos a poner un Trigger donde por ejemplo vamos a ver pues por ejemplo Eh sí Okay a ver un momento en productos Sí el precio Ah Oh Wow interesante puedo hacer un Trigger por ejemplo para que cada vez que se compre un producto que quite un elemento del stock vamos a verlo a ver si me deja hacer ese Trigger sería un Trigger interesante vale para no tener que calcular eso mediante programación entonces Ok perfect Now create a Trigger so that cada vez que se ha ejecutado un pedido iterate over products in that order then go to the product Table and in column stock substract as products in the order es decir update stock básicamente vamos a verlo insisto una vez más es algo que podríamos hacer en hasta ahora haríamos en un lenguaje de programación que es Dime cuántos productos has comprado Vale pues vamos a la tabla productos Dime cuántos productos hay Pues entonces te voy a quitar x actualízalo haz un update madre mía qué rollo Vale entonces vamos a ver eh Trigger cada vez que neces una l de pedido actualiza el stock vale Pero yo creo que sí yo creo que sí Ok Sims about right B Let me ask would that Trigger would be triggered con eh dónde estás Eh procedimientos crear pedido con cliente esto a ver sí correcto on Esto procedure execution vale para asegurarnos porque si no para qué vale más que nada para asegurarnos que el procedimiento se lleva bien con el otro procedimiento Okay perfecto Vale pues Venga pues vamos a por ello así que me gusta vamos a ponerlo por aquí vamos a ponerlo crear eh gatillo Vale y lo pongo por aquí continúo vale Okay y en el archivo de texto recordamos que los gatillos nos permiten automatizar tareas bien dadme 5 minutos de descanso por favor