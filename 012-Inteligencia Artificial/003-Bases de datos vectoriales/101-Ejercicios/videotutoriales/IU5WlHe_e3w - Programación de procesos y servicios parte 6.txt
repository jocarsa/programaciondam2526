pero pues voy a volver un paso atrás voy a index y lo voy a duplicar convirtiéndolo en index 3 un poco para buscar una mejora en el rendimiento del programa informático así que vamos a verlo vamos a cargar index 3 tanto en el navegador como en el editor vamos a cargar index 3 ahí tenemos el juego de la vida vale ahora vamos a cargarlo también en el editor bien y con esto vamos a ver si podemos simplificar algunos cálculos para hacer que el por qué es que el software que hemos hecho antes no es demasiado no rinde demasiado bien así que parece que vaya más rápido si nos damos cuenta si comparamos index 2 y lo comparamos contra index 1 pues casi parece que vaya más rápido index uno que index 2 pues hemos conseguido que sea multinúcleo pero no parece que ya hemos conseguido que sea muy eficiente voy a cerrarlo todo voy a apagarlo de nuevo y entonces ahora lo que voy a hacer es lo siguiente vamos a ver estoy aquí lo que voy a hacer es convertirlo en una matriz unidimensional pero más sencilla entonces ahora lo que voy a hacer es lo siguiente tengo aquí el datos canvas vale tengo aquí por aquí voy a crear una variable llamada pixel que es igual a un niño array y entonces ahora lo que voy a hacer es decirle al sistema que para cada uno de estos casos en lugar de decir esto y esto por aquí vale lo que voy a hacer es decirle al sistema que pixel punto pus y voy a decir a ver javascript array pus y pues vale si esto es falso en ese caso voy a decir 0 en tres antes de hacer nada más antes de ser nada más lo que voy a hacer es con sole log y voy a decirle al sistema que quiero sacar pixel recargo fuerte porque no se ha enterado de los cambios fantástico index 3 ahora sí pues lo que tengo como podemos ver es una matriz de números y ahora lo importante es que lo que voy a hacer a continuación es sumar y voy a hacer lo siguiente vamos a ver representa la información vale voy a hacer lo siguiente pixel si píxel a píxel link esto ya no lo multiplicó por 4 esto es se llenó los cuatro edificios esto ya no es 4 esto ya no es 4 y ahora a continuación lo que voy a decir es que número vivas es igual vamos a verlo una vez más igual hay el if me lo quito porque el if consume bastantes recursos vamos a ver lo bueno de hecho aquí voy a reemplazar todos estos grandes 2 3 4 5 6 7 y 8 esto es menos anchura esto es anchura + 1 esto es menos 1 esto es más 1 esto es más anchura menos 1 más anchura sin nada y más anchura más 1 y así lo que estoy haciendo es leer directamente bueno pues entonces ahora lo que hago vamos a ver es decir datos canvas que no quiero getty mex data bien esto va a dar un error no pasado y entonces ahora hago lo siguiente me vuelvo a el juego de la vida wikipedia y voy a ver qué es lo que ocurre a ver cuáles son las reglas dónde estás allí ver y dijo pixel es igual a 0 el píxel está muerto entonces voy a decir si pixel está muerto y además pixel y además número vivas es igual a 3 en este caso pixel day es igual a 1 y entonces digo pixel day es igual a 1 se está viva y también es cierto qué número vivas es igual a 2 si palabras número vivas es igual a 3 en ese caso pixel day es igual a 1 en caso contrario pixel day es igual a cero y él ahora por tanto esto fuera vamos a ver estos canvas es igual al contexto lo que sea vale y entonces vengo y realmente esto no hace falta hacerlo en cada iteración del bucle datos canvas ahí vamos a empezar a ahorrar tal y como decía anteriormente y entonces vengo aquí y digo sí bueno sabes qué datos canvas a ver cómo lo puedo hacer datos canvas dato de ti y por uno y por cuatro realmente es igual a 255 menos pixel x 255 y así me evito los pips lo mismo y por 42 y el y por 43 siempre va a ser porque es el alfa si todo ha ido bien si todo va bien supongo que algún error tendré desbloqueo el temporizador de momento parece que está haciendo un extraño bien pero no pasa ahora no pasa nada porque tengo que averiguar aparte de que aquí tengo una serie b acabando tengo una serie de píxeles vale está cogiendo más la anchura no pasa nada vale voy a averiguar a ver qué es lo que ocurre es decir cuál es el motivo por el cual está fallando el pixel cuando leen pixel puntos voy a hacer una cosa voy a decir qué anchura es igual a 64 y altura es igual a 64 y voy a tener un poco controlado del tema ok voy a asegurarme que recargo y a continuación vamos a ver por qué aparece así pixel 4 mil 96 64 84 se cuadra más igual pixel y hacer un solo punto los de número y vas para ver si lo está cogiendo como un número vivos ok correcto es correcto vale muy bien soy pixel y vamos a verlo si pixel day es igual a 0 y número de base es igual a 3 clics leyes 1 pero sanz chura en principio se vio esto parece que debería estar funcionando correctamente pero sin embargo no lo está haciendo y tenemos hay un problema muy bien entonces esto es más esto es anchura por altura vamos a darle ahora bien nos recargamos con fuerza vale todavía hay alguien que lo está haciendo x 4 parece 4.096 de hecho 001 2000 vale y uno por cierto que qué es lo que ocurre es aquí pongo 0.5 por su curiosidad bien ese es el problema y es que aparece un píxel cada 4 aparece un píxel cada 4 entonces píxel punto link creo que está el problema este es más es la extra cosa vale pues ahora voy a hacer 0.2 voy a hacer en el random el 0.2 o 0.1 y como podemos ver pues tenemos ya el juego de la vida voy a poner un tiempo de 10 para que vaya lo más rápido posible pero tenemos y ahora pues voy a poner por ejemplo 128 por 128 y ahí tenemos pues como digo el juego de la vida a 0.01 vamos a ver qué ocurre bien cuidado no tanto 0.03 0.04 diremos que allí tenemos el mismo juego de antes evidentemente pero ya es un poco intentando que sea lo más rápido posible y sobre todo simplificando la lógica de la matriz venciéndolo todo en una sola matriz vamos a ver ahora vamos a ver ahora si pixel ley es igual a cero es igual a tres píxeles igual a uno no creo que haga falta poner el pixel igual a cero y por si acaso lo voy a poner ahí parece que se empieza a ver un problema vamos a ver 0.2 para saber a las 3.5 qué está ocurriendo pixel rey es igual a cero voy a quitar esto es interesante que se pongo esto muy bien muy bien porque vamos a ver claro esto es lo siguiente si pixel day es igual a 0 la lógica es esta no me puedo ahorrar tantos hijos como quería la pena sin número vivas es igual a 3 en ese caso pixel ley es igual a 1 sino que es el day es igual a cero 0.2 0.1 y ahora él corresponde a esto voy a reformular los safe sin número de vivas es igual a 2 un número de bajas 3 este es el cge entonces pixel 1 sí no pixel 2 y este el afuera a absolverlo vale y ahora lo que tenemos que hacer pues es un poco lo de copiar la matriz vamos a arrancar de nuevo el index simplemente para verlo por el datos canvas temp entonces ahí la idea es que vengo por aquí le digo bar pixel tem es igual a píxel punto es para crear una copia y entonces vivo existen exalten píxel a píxel temp si pixel ley pixel temp vale si hago esto en principio ahora si tengo el juego de la vida correcto como digo tengo el juego de la vida y en principio ahora debería tener algún tipo de ventaja algún tipo de ganancia en el rendimiento puedo ya quitar la anchura y la altura ahora que estoy viendo que funciona correctamente vale puedo decirle que espero para que vaya al máximo de rendimiento y también sobre todo lo que quiero es al inspeccionar a hacer una prueba de rendimiento para ver en que me estoy gastando en que me estoy gastando la el procesamiento así que te tengo vamos a cargar el profile ay parece que se va a morir este juego pero bueno la ley me dice que eso que tengo la gran mayoría del tiempo en secuencias de comandos vale y bueno vemos que ya ha llegado a un punto de estabilidad pues supongo que eligiera els será bastante responsable pero en todo el caso lo que estoy intentando vamos a recargar de nuevo es antes de pasar a la ejecución puedes hacer que esto sea lo más estable posible vamos ahora lo que tengo que hacer es plantearlo en modo multi núcleo primero lo que he intentado es optimizar el modo normal digamos y ahora creando lo en una matriz y ahora lo que quiero es pasárselo a un multi núcleo para digamos ganar cuatro veces más rendimiento pero claro tengo que pensar que es lo que pasó y qué es lo que no pasó para que funcione correctamente antes de continuar vamos a arrancar una especie de safe quest donde nuestro objetivo en este caso es poder medir cuál es el rendimiento digamos del sistema esto sin textos quiero index 3 bien quiero por tanto medir creo por tanto tener un indicador de los fotogramas por segundo reales a los que estoy trabajando y quiero además que esa librería pues es ese desarrollo digamos lo podamos poner en forma de librería al que más adelante pues lo podamos utilizar en cualquier otro desarrollo y en cualquier otra versión de este ejercicio entonces vamos a ver por qué voy a hacer lo siguiente voy a empezar haciéndolo digamos a palo seko y más adelante lo haré como desarrollo encapsula ble voy a hacer una anchura de pues 128 píxeles una altura de 64 píxeles y esto se va a llamar stats de hecho esa llamada jv stats entonces vengo por aquí vale vamos a ver esto dónde está no sé dónde estará pero voy a decirle qué jv stats qué pasa aquí porque esto me lo pone esto está como aseguró que le falta aquí un comentario stats es posición absoluta pero píxeles left 0 píxeles y ahí lo tenemos entonces ahora casi que incluso lo puedo hacer más pequeño y todo quiero 64 píxeles por aquí y 32 píxeles por aquí vale y dentro quiero un pequeño gráfico de el rendimiento entonces ahora lo que voy a hacer es lo siguiente vamos a cada uno de los núcleos primero decir con texto jv stats es igual a documento by heidi jv stats y ahora por ejemplo aquí voy a decir con texto jv stats punto field style es igual esto no es una función es una propiedad es igual a black contexto jv stats punto fill recto es de cero coma como donde estás como al 64 como el 0,0 hasta 64 32 algún problema con solo error phil recta sin red pues primera noticia phil red no es una función no existe es este mismo fin recto es interesante phil recto no es una función así punto de contexto 2 d ahora sí que es una función vale y entonces ahora lo que voy a hacer es decir lo siguiente vamos a pintar una serie d de cosas y esas cosas a la vez vamos a medir cuánto tiempo tenemos entonces jv stats un tiempo de inicio esto es igual a cero jv stats tiempo final es igual a cero y entonces esta es la declaración inicial errores en el bucle digo jv stats tiempo inicio y es igual a javascript get time micro seconds o me dice comes o lo que sea abel veis no abren que me dé bueno si me sirve vale state punto no y ahora jv estos tiempos final aquí tiempo final era por curiosidad lo que voy a hacer es jv stacks nou con sólo un tono jv tiempo final - jv tiempo inyección vamos a ver que nos da recargamos y nos da la cantidad de milisegundos que estamos tardando en ejecutar cada bucle son estos de aquí son los que sean evidentemente van a ser menos milisegundos cuanto más grande sea la simulación jamás más grande sea estos elementos ahí lo vemos y van a ser más milisegundos cuanto más extensa sea la simulación y vemos ahora que hay más milisegundos bien vale pues ahora lo que quiero es averiguar a cuantos fotogramas por segundo voy entonces para ello voy a decir que vale fps es igual vamos a ponerlo minúsculas van fps es igual a esto de aquí estoy aquí partido por mil fps vamos a ver esto y un momento y no al revés al realizar las obras de espn partido por esto ahora sí entonces vamos a comprobar como si por ejemplo hago esto más grande pues voy a más fotogramas por segundo vale 500 fotogramas por segundo se hace falta y si hago esto más pequeño pues voy a menos fotogramas por segundo bien ahora por tanto lo que quiero es representar esta información no en la consola sino en aquí arriba en los píxeles por cierto que voy a hacer un más punto round y así redondeamos el número y entonces ahora lo que quiero es pintar ese número aquí al final esto va a ser bueno difícil pero curioso vamos a ver a continuación lo que quiero es lo siguiente con texto hotstats punto feel style es igual a green es igual a verde a continuación voy a hacer contexto jv stats punto fill recto desde bueno 62,1 com a 1,30 vamos a verlo así que se agrava bien pues sale por ahí una barrita vale pues ahora lo que vamos a hacer es copiar esa barrita digamos que hay lo que quiero es 30 menos fps ahora mismo no saber nada ok el que pasa así perdón esto es al revés esto es voy a decir no espera esto es uno esto es 30 y esto es 0 - fps ahora lo que voy a hacer ahora lo que voy a hacer es decirle al sistema antes de dibujar esto quiero bar datos es igual a contexto jv stars punto getty image data esto es lo difícil ya digo desde 1 desde 2,1 hasta cuánto pues hasta 30 coma 31 30 estos 29 creo vale entonces ahora digo contexto punto put emails data le digo qué quiero contexto jv stats y quiero datos y los quiero poner él 1,1 es decir lo estoy tirando una para allá ahora por último contexto stats feel style es igual a black contexto jv starts punto el recto y digo 31 1 coma uno coma y yo creo que si todo esto ha ido bien última estado vamos a verlo si todo esto ha ido bien podría estar copiando y pegando algunos datos las gráficas vamos a decir 30 y debería estar allí copiando y pegando 2 claro yo esperaría espérate ahora sí vale vamos yo esperaría que esto lo fuera pegando esta última entrada el 0,1 vamos a ver porque como digo lo que yo esperaría para sacar un poco es que eso se fuera tirando para atrás vamos a verlo vamos a ver como digo lo que yo esperaría lo que yo esperaría entonces última y xstrata estoy cogiendo los datos y por esto respuesta y esperaría es que esto se fuera tirando para atrás con sol es punto los gratos ya está son height treinta y cuarenta correcto todo esto es correcto y al final hacia el final debería tener hacia el final debería tener un color verde no tiene un color verde sin embargo es curioso no tiene un color verde todo es negro vamos a ver otra forma que tengo de hacerlo por un poco buscar formas alternativas para no quedarme parado ahora es lo siguiente a ver yo digo jv stats la historia es igual a mí vale entonces a uno el dolor y es igual a 0 y es menor que 64 y más armamentismo en ti es verdad claro es que esto no son 40 son 64 niños creo que el estado experto que en 49 fuera del momento ahora sí ya estoy cogiendo lo correcto vale que lo estaba cogiendo incorrectamente muy entonces ahora si lo pongo en uno ahora si tengo una gráfica muy bien se me está yendo evidentemente el color negro por supuesto entonces pero quiero de 2 a 1 ok correcto pues ahora voy a pintar bueno la verdad es que puedo decir jv stats background black y casi que acabó antes realmente vale así que tengo ahí ya una barra de fps y ahora hago esto más grande recargo y veré que los fps pues caen más todavía así que digamos que por bajo de 30 pues muestra esa gráfica digamos y ahora pues bueno puedo hacer algo como qué si está por debajo de 10 pasa lo de un color si está por debajo de no sé cuántos sale de otro color así que puedo hacer algo como por ejemplo puedo hacer algo como por ejemplo switch no fps es mayor que 30 en ese caso fil está el green if cps el mayor o igual que 30 es menor que 30 en ese caso hello y si fps es menor que 10 no sé el 15 en ese caso red así que recargamos y ahí estamos viendo unos colores que nos informan un poquito mejor de en qué situación estamos por ejemplo es algo así lo hago más pequeño vuelvo a recargar para ya ir pues lo ver mejor no sé yo pues no lo sé sigue aquí le digo 20 y aquí le digo 10 y así pues un poco ajustamos cuál es el resultado bien y ahora pues sí que me gustaría contar con un pequeño elemento de texto así que html5 canvas texto de lo sencillo con texto font esto lo puedo poner aquí 10 píxeles o nose 6 píxeles serial y phil texto esta última es grata con texto j western y en 1,25 voy a poner fps más fps vamos a verlo ah sí claro y el color vuelto j.lo stats pero está el white valen y vamos a verlo como lo puedo hacer para qué no sé si le podría la fira no vaya no sólo del texto me puede fastidiar un poquito porque depende del dibujo anterior bueno yo tengo que ver cómo hacerlo eso tengo que ver cómo hacerlo quizás en un texto voy a poner aquí tal no lo sé ahora mismo no es ahora mismo pero tengo que pensar como lo puedo hacer para ver dónde lo imprimo y que no se vaya hacia la derecha evidentemente no lo puedo poner verde porque vete a saber en qué momento será verde o no igual un canvas por encima pues tendría igual que recurrir a eso es decir jv stats 2 cuando estás con textos jv stats 2 y entonces hot and stud's 2 hot and west tax 2 puntos recto desde 0,0 hasta 64 32 y luego todo esto vivo contiene con stats con dinero esto es esto de aquí con un wifi de 64 con un height de 32 y esto de aquí es jv stats y jv stats 2 y lo probamos nos hablaban fantástico así varón blanca y no puedo entonces esto es esto y al 2 no le puede poner background black ahora vale y ahora sí entonces ahora este número lo voy a hacer un poquito más grande aparte de que voy a hacer esto bueno realmente está aplicado a campos vale pues voy a hacerlo 6 píxeles después 10 píxeles areal vale una cosa así y el color vamos a ver por qué y bolt bien pues vamos a ver qué es lo que ocurre porque tenemos ahí el texto pero se nos ha ido vamos a ver contiene stats fotos textos lo eliminamos para que interesante a ver otros santos lo eliminamos y j vuestras 1 lo eliminamos qué está pasando aquí clear estas 2 feel style feel texto no entiendo por qué pixels este con sole fuera y vamos a ver j huesca lo sé porque ya no estamos pintando 0 - fps d además es que estoy borrando este y no se borra o que ya sé por qué y esto es porque es jb stars 2 ahora sé ok así que ya lo tenemos por ahí ya tenemos tanto nuestros fps es como la gráfica vamos a poner el texto 3 por ejemplo y ahí lo tenemos ahora ya pues podemos hacer esto más pequeño esto más grande recargamos bien y ahí es donde podemos verlo mejor muy bien pues hasta aquí tenemos el juego digamos refactorización convertido en una matriz y ahora lo que queremos es pues ver lo que queremos es trabajar correctamente con bueno con todo aquello que haga falta para convertirlo en multi núcleo ahora tenemos que ver cuál de las estrategias podemos adoptar para pues ver en definitiva qué es lo que hacemos con la información es decir necesitamos esto pero claro que le pasamos ahora a cada worker pues es lo que tenemos que pensar es lo que tenemos que decidir más que nada porque como te diría yo no podemos pasarle a un worker la información de todo el bucle porque entonces estaremos perdiendo un montón de información hemos visto cómo la hemos pasado cada puntito a un worker y tampoco ha mejorado mucho la situación entonces tenemos poco que ver qué es lo óptimo que le podemos pasar al programa para que en definitiva pues trabaja de forma correcta muy ponerle los pps es aprovechando para dividir esto por dos y así pues la gráfica saldrá más conveniente y así de alguna forma si pongo esto al 200% por ejemplo a 60 fotogramas por segundo voy a partirlo por 5 por ejemplo y ponerlo al 200% y recargarlo a pantalla completa y así veremos por saber cuánto funciona ahí lo vemos vamos a también echarle un vistazo a cuánto constaría en pantalla completa vemos que en pantalla completa es cuando tenemos el problema que ya conocemos de que pues estamos bajando hasta veinte y pico fotogramas por segundo y no es nada conveniente puedo aumentar lo el 400% evidentemente y entonces pues pasó a más fotogramas por segundo pero no es lo que quiero claro en un momento dado puedo esconder también las estadísticas puedo hacerlas más pequeñas o puedo hacer lo que quiera pero siempre teniendo en cuenta pues la velocidad digamos ahora a continuación como digo es cuando vamos a hacer esto que sea multinúcleo