la razón por la que esto no funciona en firefox ni funciona dentro de ópera es porque he llamado directamente a un documento write y el documento write no se lleva bien directamente con el set Time out Yo realmente hago esto con una librería que se llama jquery pero claro como no os he enseñado jquery no podía usar jquery Pues bueno me viene bastante bien para explicaros Cuál es una de las ventajas de usar jquery precisamente esto funciona ojo estoy ahora mismo en Chrome voy a probarlo en firefox para comprobar que no funcionaba esto funciona si estamos en Chrome pero si estamos en firefox se cuelga veis empieza a rodar y se cuelga la solución en principio es muy sencilla la solución consiste en poner alert en lugar de documento write pongo una alert guardo recargo voy a abrir una pestaña nueva Porque suele quedar colgado el valor de X es 1 en 5 segundos me dirá el valor de X es 2 en 5 segundos me dirá el valor de X es 3 está a 5000 milisegundos y así hasta el infinito y más allá Es decir estuve probando tanto meterlo en una variable como hacer otra serie de cosas y ninguna funcionó simplemente el documento es el que hacía que esto fallara y así aunque más adelante volveremos a javascript puro pero así Esto me da pie a explicaros el uso y el porqué de usar jquery e incluso a ver si nos da tiempo y al final de la clase de hoy podemos ya tener un mínimo juego en marcha Bueno lo que voy a hacer por tanto os voy a demostrar En qué nos puede ayudar jquery y a continuación ahora lo que voy a hacer ahora lo voy a hacer muy rápido no me digáis Oye pero cómo lo has hecho pero es que no lo he visto vale voy a hacer y luego a continuación empezaré a explicar poco a poco desde el principio bajar instalar y usar jquery qué pasaría porque yo he solucionado el problema con una led pero claro es que yo no quería aquí dentro Yo no quiero que esto aparezca en una alerta y no quiero que aparezca en la pantalla yo quería el documento write Bueno lo que voy a hacer por tanto es irme a la página principal del proyecto jquery.com me voy a descargar jquery Qué es jquery es un framework describir Download describir lo que es un framework no es demasiado fácil a priori Así que os lo voy a decir en las palabras más Llanas posibles simplemente os diré que este framework nos va a facilitar la vida a la hora de programar en jquery tenemos que aprender javascript y jquery Pero eso Al final nos va a ser más sencillo que trabajar directamente en el javascript Por qué Porque yo ahora mismo José Vicente y javascript me guardo aquí jquery porque yo ahora mismo he visto que en Chrome funciona de una manera en firefox y ópera funciona de otra que tendría que hacer programación doble tendría que detectar el navegador y decir qué estás en Chrome la cañac que estás en firefox ñacañac y esto que acabo de hacer no es el único ejemplo Un ejemplo muy catastrófico por ejemplo uso de Ajax hay una tecnología que se llama Ajax que es contenido interactivo basado en el lenguaje del servidor y se hace completamente diferente No ya en firefox y Chrome sino en Internet Explorer y en el resto de navegadores cuando programo Ajax a Palo Seco con javascript hay que programar siempre doble la razón de usar jquery es que lo haces una vez y jquery ya se preocupará de saber en qué navegador está funcionando y adaptarte los métodos correspondientes vale por tanto parece que lo voy a complicar pero sin embargo os aseguro que va a ser para simplificarlo entonces lo que voy a hacer por tanto es cargar src es igual a jquery.js Script y aquí lo que voy a hacer es alert no le voy a decir mira Body Quiero que en el body me apend me añadas esto de aquí que es esto es muy raro esto no lo hemos visto hasta ahora esto es parte de la sintaxis de jquery añade unos cuantos métodos unos cuantos selectores que me permiten decir que a Body le añado este contenido vamos a ver si funciona guardo permitidme ponerlo en un segundo y eso no tenemos que esperar 5 segundos cada vez guardo recargo el valor de X es 2 3 4 5 6 esto es el que se supone que tenía que haber salido ayer os acordáis estamos en firefox si queréis lo pruebo en ópera Así que hemos visto como al final la manera más sencilla de solucionarlo porque sí he usado jquery esto es operadora pero es que realmente en la práctica lo único que he tenido que hacer es meter esta línea y usar uno de los métodos uno de los selectores de jquery uno de los electores ahora os explico Cómo va esto uno de los selectores y a continuación uno de los métodos vale Vamos a aprender a trabajar con jquery y vamos a extender nuestros conocimientos de javascript sin tener que sufrir mucho más insisto no he acabado javascript pro y duro sino que más adelante una vez hayamos visto jquery volveremos a cosas que nos falta por aprender de javascript lo que voy a hacer por tanto en primer lugar es crear un archivo nuevo para partir desde cero que me voy a mi carpeta creo un archivo llamado No quiero crear una nueva carpeta Quiero crear un nuevo archivo llamado 4.html borro esta carpeta que he creado que no sirve para nada simplemente es que en lugar de crear un archivo había creado una carpeta y vuelco ese archivo 4.html tanto al editor como al navegador una vez más permitirme que sea pesado Pongo aquí Hola guardo recargo Pongo aquí Hola y me aseguro que veo el mismo resultado en los dos sitios señal por tanto de que estoy trabajando correctamente en los dos sitios antes de hacer este ejercicio es necesario que previamente hayamos descargado jquery y lo hayamos puesto al lado de nuestros archivos que es jquery es un framework para javascript un framework es un entorno de trabajo es un entorno de programación que nos va a facilitar la vida vamos a tener que aprender unas cuantas instrucciones extra pero digamos vamos a retroceder un paso para luego poder avanzar tres con lo cual va a valer la pena De dónde obtenemos jquery se obtiene de manera gratuita desde jquery.com por tanto entrarás si no lo tuviera ya entraría en jquery.com haría clic en Descargar jquery tras lo cual se me ofrecería o bien Descargar el jquery comprimido de producción o bien Descargar el jquery descomprimido de desarrollo Cuál es la diferencia que el jquery comprimido es esto de aquí y el jquery descomprimido de producción es esto de aquí los dos son Exactamente lo mismo simplemente este de arriba está comprimido y este de abajo está descomprimido su funcionalidad es la misma en principio usaré el comprimido porque yo no quiero modificar jquery Yo quiero usar jquery por tanto el comprimido hace que tarde menos en descargarse a través de la página web Ahora cuando ya sepan mucho de jquery y diga no Ahora quiero modificar jquery en ese caso me bajaré el de producción pero ahora de momento recomiendo bajar el comprimido una cosa que suele confundir un poco la gente es que le doy a bajar el descomprimido o el comprimido me da igual cualquiera de los dos Y en lugar de Iniciar una descarga simplemente aparece una pantalla con lo que parece un error no es un error simplemente es el volcado en pantalla del contenido de jquery lo único que tendría que hacer Es pulsar depende el navegador en Chrome este botón guardar página como y me guardaría como veis aquí el archivo con extensión js por tanto para este ejercicio inicia es una condición para que funcione el haber descargado o haber obtenido jquery.js y tenerlo copiado al lado del archivo 4 html que voy a trabajar es decir Tengo cuatro html y al lado el archivo jquery.js el archivo que se descarga por defecto de la página web siempre lleva la versión que es jquery guión 0.9.1 lo que sea yo lo que suelo hacer es quitar todos los numeritos para que luego sea mucho más fácil llamarlo Vale pero no pasaría nada por meterlo tal cual viene simplemente Es que luego de Cara a llamarlo tendrías que poner inequívocamente cada uno de los guiones y puntitos y numeritos que hubiera vale primer paso el primer paso consiste en crear una estructura html crear una cabeza Head crear un Body y dentro de la cabeza Head voy a escribir dos etiquetas Script de tipo texto barra javascript no os olvidéis de la etiqueta del cierre Así que hago una y hago dos hay dos etiquetas ahora de javascript en lugar de una hay dos la diferencia de la primera con respecto a la segunda es que en la primera a la primera la voy a usar para cargar mediante un source el archivo jquery.js Así que el cometido de la primera etiqueta es cargar la librería jquery.js Y dejarla a mi disposición el objetivo de la segunda etiqueta será Ya empezar a desarrollar mi propio código contando con la librería previamente cargada ni que decir tiene que es completamente recomendable que primero carguéis la librería y luego desarrolláis vuestro propio código no sea que desarrolles vuestro propio código antes de abrir la librería y por tanto evidentemente no funcionaría todas las llamadas que hagáis a la librería lo primero que voy a hacer con jquery igual os cuesta un poco de entender pero os lo voy a explicar con las palabras más castellanas posibles el javascript como veis aquí en la pantalla se ejecuta Siempre antes que el body Por qué Porque cuando un navegador web parsea un archivo html a parsear se llama leer línea a línea e interpretar el contenido de cada línea tener en ese caso javascript primero y html después nos puede ocasionar un problema cuál es el problema veréis supongamos que en el body quiero tener un texto y de repente lo que quiero es poner o un dip pongamos que tengo un dip y luego lo que quiero es poner algo de contenido dentro de ese dip Así que html tiene el dip javascript pone cosas dentro del dip el problema es si existe antes javascript que el body cómo le voy a decir yo desde javascript pone esto en este dip que no existe todavía porque lo lee de arriba a abajo cuando está leyendo esto de aquí arriba todavía no sabe que está esto debajo esto nos causa un poco de conflicto porque según el estándar phtml javascript en modo interno se pone arriba se pone en el Head pero sin embargo esto puede causarnos problema de que el código no se ejecute correctamente De hecho si os ponéis a investigar a borisquear páginas en busca de código práctica que yo recomiendo bastante No recomiendo hacerlo todo a siempre así pero de vez en cuando ver cómo hacen los demás las cosas está bastante bien veréis que hay gente que en lugar de escribir el javascrito arriba lo escribe abajo del todo al final de la página Y dices y este tío porque ha escrito esto así porque se ha saltado el estándar y lo ha puesto aquí abajo es muy sencillo Porque se ha esperado a que el navegador cargara todo el html y luego al final cargar al javascript que modificas html tiene que existir algo para poder modificarlo bien Por tanto lo primero que vamos a hacer en jquery es escribir lo siguiente dólar siempre que escriba dólar y paréntesis algo es un selector de jquery que es un selector yo lo que voy a hacer es seleccionar algo y una vez que lo he seleccionado le voy a aplicar una función esto de seleccionar me suena a mí de algo me suena de css en css hay selectores Qué hace css pensemos lo que hemos aprendido en css y nos costará menos aprender jquery porque la sintaxis De hecho no es igual pero es parecida a la filosofía es parecida en css tengo una cosa que se llaman selectores os acordáis almohadilla el punto seleccionará la clase y el ID Vale entonces lo primero que hago en css abandonamos un momento javascript en css lo que hacemos Es seleccionar algo y dentro de las llaves utilizarlo pues jquery funciona igual que css primero seleccionamos algo y con eso lo que hacemos Es aplicarle una acción css le aplica una estética javascript le aplica una acción vale Así que siempre que ponga dólar y paréntesis estoy seleccionando algo qué voy a seleccionar hoy en primer lugar lo primero que deberíais seleccionar el documento permitidme insistir una vez más en que si una palabra la escribo en castellano es que me la he inventado yo y si me la he inventado yo podéis poner cualquier cosa pero si una palabra la escribo en inglés es que tiene que escribirse así una vez he seleccionado algo en este caso estoy diciendo voy a trabajar con todo el documento que es el documento en el dom de html El documento es el nivel de mayor jerarquía es todo vale quiero seleccionarlo todo pongo un punto después del punto voy a poner un método el método es una acción que realizo sobre el código sobre el selector el método va a ser el método ready y ahora entre paréntesis los métodos pueden tener los métodos son funciones para que os hagáis la idea y como os acordáis de ayer las funciones pueden tener parámetros el parámetro es la función que voy a ejecutar Así que permitirme comentar esta línea de código y os diré que desde el punto hacia atrás es el selector y desde el punto hacia delante es el método lo cual quiere decir que primero selecciono un elemento y segundo a ese elemento y no a cualquier otro le aplico una acción dicho esto qué quiere decir el método ready es cuando estés preparado como era de esperar vale Qué dice esto lo que dice es cuando el documento esté preparado en ese caso me ejecutas la función de inicio y por tanto lo que hace es que aunque el javascript está arriba en la cabeza pospone su ejecución hasta que todo el html haya sido cargado lo cual nos ayuda a no cometer errores de no existencia de html pero seguir manteniendo el javascript en el Head y no tener que recurrir al truco de ponerlo bajo pero si ahora recargo en la pantalla Simplemente no pasa nada bien Por qué no pasa nada porque cuando el documento esté preparado ejecutaré la función de inicio existe la función de inicio No pues como va a pasar algo voy a escribir función inicio sin parámetros y aquí dentro de la función de inicio voy a poner una alert jquery está funcionando qué he hecho por tanto yo le había dicho al documento que cuando estuviera preparado ejecutará una función llamada inicio recordad que si el nombre está en castellano si la palabra está en Castellanos que lo puedo cambiar por longaniza vale simplemente pongo inicio evidentemente porque es un nombre que indica que es una función que se ejecuta en el inicio pero no es obligatorio que se llame inicio Pero lo que sí que es obligatorio es que si aquí pongo inicio o longaniza aquí ponga inicio longaniza que cuadre qué hace la función de inicio alerta de que jquery está funcionando mi consejo por mucho tiempo que llevéis programando en jquery nada más empezar un proyecto lo primero que tenéis que hacer es esto porque con esta estructura de control yo lo que estoy haciendo es comprobar si jquery está funcionando o no si la librería jquery se ha cargado correctamente quiere decir que esta línea se ejecutará y por tanto esta línea se ejecutará y quiere decir que podré continuar trabajando tranquilamente si la carga de jquery ha fallado quiere decir que esta línea no sabrá como interpretarla todo el Script de la error y no obtendré nada en la pantalla no os lancéis a escribir dos líneas de código y luego que no sepáis Dónde está el error empezar por algo sencillo e ir poco a poco guardo recargo Y si todo ha ido bien me dirá jquery está funcionando señal de que esta línea está bien escrita ha cargado correctamente jquery.js y de que esta función y este método están correctamente escritos Bien voy a continuar este mensaje es muy molesto lo sé Pero insisto si esto una vez más que esto lo tenéis que hacer voy a ir a body y dentro del Body parece que ha aparcado un momento javascript pero ahora vuelvo a ello voy a crear un div y voy a crear un vil con el ID igual a personaje ya que digamos empezaré teniendo un personaje El bueno y luego estarán los malos vale el bueno como será uno le he puesto una idea los malos tendrán clases porque habrá muchos de ellos este ID personaje lo tengo que ponerle algo dentro de él porque si ahora guardo y recargo no aparece nada en la pantalla vale por tanto después de javascript podéis hacerlo Después o antes me da igual yo lo voy a poner después voy a poner una etiqueta Style vamos a buenas costumbres de tipo texto barra css donde le diré que a ver que no me acuerdo el ide que era una almohadilla o un punto almohadilla no vale entonces si he puesto y de personaje tendré que poner almohadilla personaje tendrá las siguientes características quiero hacer que el personaje sea un círculo verde ahí tampoco vamos a complicarnos mucho y luego ya le meteremos dentro de ese div el Sprite que queráis voy a decirle que tendrá un Wiz de 50 píxeles un hype de 50 píxeles un background de color Green y un Border de un píxel sólido White va Venga hoy estoy generoso dos píxeles y un pequeño boxeado es el que tenga un poquito de sombra bocado de 0 píxeles 5 píxeles 10 píxeles rgba 0,0.3 que es negro semitransparente lo cual si todo ha ido bien me dará este resultado en pantalla j4 está funcionando vale Ey se me ha olvidado una cosa y es que claro quería redondearlo con el borde radius por tanto Border guión radius es de si son 50 píxeles pues 50 píxeles y así me aseguro que salga redondeado teóricamente si son 50 píxeles el radio no Debería ser de 25 Sí pero todo aquello que pongas mayor que el radio máximo te lo va a rebajar al radio máximo por tanto poner 50 como si pusiera 100 al final equivale a que me lo va a bajar a radio 25 Así que tengo ya jquery está funcionando y tengo ya este personaje por aquí pongamos que mi personaje es esta ficha verde a continuación voy a hacer una cosa yo ya sé permitirme que desactive este alert para luego veré Qué hago con esto yo este personaje puedo moverlo en pantalla Cómo puedo moverlo en pantalla conozco tres métodos de los cuales me valen dos uno es con el top y el left y otro es con el transform Translate voy a hacerlo con transform Translate ya que de cara desarrollo de videojuegos es mucho más seguro de usar que top y left por tanto digo position absolute ostras absolute antes estaba usando relative lo digo absolute porque le digo Mira yo no quiero que cuando te muevas vayas empujando al resto de elementos del juego yo quiero que estés por encima del juego te digo tu posición es absoluta O sea tú vas a tu rollo y ahora digo webkit transform sería transform vale Pero como estoy en Chrome sería webkit el que esté en firefox que pongamos el que esté en ópera que ponga o web que transform Ah por cierto transform es mucho más seguro para hacer videojuegos pero top y left es mucho más compatible con navegadores antiguos Así que yo que sé qué hago Bueno ahora como estoy en uno actualizado voy a usar transform Pero simplemente quería deciros Esto vale que tengáis en cuenta Translate y digo no sé por ejemplo 100 píxeles 200 píxeles coma si os fijáis en la pantalla lo que he hecho es mover al personaje 100 píxeles a la derecha 200 píxeles hacia abajo recordad que y crece hacia abajo y el positivo hacia abajo yo teóricamente puedo ya mover este personaje donde yo quiera Pero qué pasa que lo muevo con css y css estático una vez lo muevo se acabó se acaba el juego os acordáis ayer el bucle infinito vamos a trabajar con bucle infinito voy a hacer lo siguiente en primer lugar dólar paréntesis acabo de volver a jquery recordar que durar paréntesis es seleccionar a alguien como no voy a seleccionar a un elemento de nivel superior voy a seleccionar a un div pongo comillas un elemento de nivel inferior dentro del Domo dentro de comillas otra buena noticia de jquery con respecto a css es que el mismo selector de css sirve para jquery por tanto si quieres seleccionar al elemento que tiene el ID de personaje pones almohadilla personaje yo ya he seleccionado al personaje y ahora lo que voy a hacer es añadirle un método el más sencillo con el que se suele empezar a aprender jquerys el método css le añade una propiedad css al objeto el método css tiene la siguiente estructura he puesto css paréntesis y dentro de los paréntesis voy a poner comillas coma Perdón sin la última coma comillas dentro y esto lo siento hay que escribirlo Igual dentro de las primeras comillas se pone la propiedad que quieres modificar webkit transform dentro de las segundas comillas se pone el parámetro que le quieres pasar este caso transforma Translate a la pantalla 300 por 500 no sé voy a probar atención Mirad la pantalla y luego vosotros recargo Oh se me ha ido ahí se me ha ido Ahí Qué quiere decir eso incluso Mirad para no marearos voy a eliminar esa línea para que entendáis que css no está modificando la propiedad la posición del objeto guardo recargo y si me sigue yendo ahí qué me hace css me dice que es verde me dice que es redondo que tiene un borde blanco que tiene sombra y me dice que tiene 50% Qué hace javascript le da la propiedad css de que lo ponga en 300 píxeles 500 píxeles para que lo he hecho con javascript cuando lo podría haber hecho con css ahora a continuación os demostraré por qué yo necesito para este personaje trabajar como estoy de momento en un entorno 2D con su posición x y su posición y haceros la idea imaginaos que estamos viendo este personaje desde arriba en una vista cenital entonces lo que voy a hacer es antes de empezar toda la tralla antes de siquiera seleccionar el documento voy a crear unas variables de hecho suele ser una costumbre bastante buena no solo en javascript sino en cualquier lenguaje de programación que es antes de hacer nada créate tus variables y ya las tienes para el futuro tus variables globales tus variables de ámbito global que van a tener validez en todo el programa Así que voy a crear una variable bar post x posición x un clásico que va a ser igual por ejemplo inicialmente Oye mira sabes que te digo no hacer o no que es muy aburrido a 400 voy a crear una variable bar Pos y que será igual por ejemplo también a 400 no pongáis TX simplemente 400 y ahora aquí donde pone Translate voy a hacer una cosa Antes no complicada pero es que el código se pone un poco farragoso voy a encadenar mirar pongo pared comillas más comillas post x y donde ponía 500 comillas más comillas Pos y qué estoy haciendo pues lo que el primer día de javascript parecía que no tenía ningún sentido que era una variable arriba y devolverla abajo pues arriba le he dado un valor abajo estoy llamando a la variable quiero que te traslades post x cuánto vale pues x 400 pues 400 píxeles y post Y cuánto vale posible y 400 pues 400 píxeles en Y si ahora guardo y recargo comprobaréis como ahora el objeto se mueve justo hasta 400 para qué he hecho yo realmente esto Pues lo he hecho para lo siguiente ahora mi juego va a entrar en un set Time out y voy a hacer lo siguiente voy a hacer algo muy sencillo De momento muy sencillo me has dibujado al personaje si queréis lo comento me has dibujado a continuación en la línea siguiente pongo post x más que era post x más Escoge a post x súmale un valor Pos x más es simplemente un ejemplo por si griega más coge por y súmale un valor Qué hace esto en la pantalla nada Por qué Porque cuando guardo y recargo simplemente me dibuja eso y ya está Sí vale me ha sumado un valor pero yo no tengo manera de decirle y ahora vuelve a actualizar la posición del jugador la manera de actuar la posición del jugador es decir set Time out para esto era el set Time out y le digo inicio se ejecuta dentro de un segundo recordad que un segundo en javascript se escribe como mil milisegundos ahora es cuando este ejercicio se vuelve interesante ya que por fin estamos consiguiendo que mediante programación javascript el objeto se mueva Así que guardo Aunque parezca que no pero ahora comento porque se mueve guardo recargo y sale esto No si os fijáis pero está moviendo poco a poco dentro de la pantalla vale varias cosas que voy a comentar primero se mueve muy lentamente porque no comprueba su nueva posición hasta dentro de un segundo cuidado lo que voy a hacer en la pantalla vale pero tener cuidado si yo esto que es la emoción si yo bajo mil a 100 es decir 0,1 segundos pasa esto se mueve más rápido de hecho 10 veces más rápido cuidado si lo bajo a 10 esto es 0,01 segundos se moverá más rápido todavía y más fluido también lo puedo bajar hasta uno es decir teóricamente insisto atención teóricamente javascript me permite hacer mil actualizaciones por segundo que javascript me permite hacer mil actos actualizaciones por segundo no quiere decir que yo las vaya a hacer 1000 por segundo me parece excesivas una por segundo son muy pocas Pero mil por segundo son excesivas vale por tanto simplemente pongo uno para demostraroslo pero evidentemente no lo hagáis Qué pasa si le pido al navegador más de lo que me puede dar No pasa nada tranquilos no os va a dar más de lo que os pueda dar Simplemente no funcionará y ya está No es que no funcionará Perdón funcionará todo lo rápido que pueda si os fijáis vale por tanto ya tengo algo un personaje moviéndose en la pantalla voy a hacer ahora que la pelota rebote en las paredes Vais a ver que es mucho más sencillo de lo que parece pero también así espero que le empecéis a dar al coco vale Y que veáis que todos son matemáticas dentro de un juego Espero que esta lección sirva para ilustrar eso que y esto que voy a hacer ahora es la punta del iceberg todo lo que tenemos que hacer después lo primero que voy a hacer simplemente a un nivel visual para que lo veáis es crear un tablero por tanto voy a crear un div si me permitís le voy a meter bueno da igual y de tablero no acierto yo tableto dip se debe ser la emoción y ahora escribo almohadilla tablero va a tener la insisto miradme la anchura y la altura elegís vosotros pero acordaos de lo que elegís yo voy a elegir una anchura de 600 píxeles y una altura de 600 píxeles es por 600 porque probablemente mi monitor es más pequeño que el vuestro y ahora simplemente para verlo un borde de un píxel solid Black simplemente para Que aparezca un borde que me permita ver qué es el tablero Qué es el escenario guardo recargo mirada la pantalla y dónde ha sido Ah claro perdón y el tablero le digo que tenga position absolute todo flota todo está ahí veis tanto el tablero como el personaje tienen posición absoluta y lo que quiero atención ahora la pantalla miradme es que cuando vaya Es que me va a ir Justo a la esquina cuando la pelota llegue haga pack y Siga rebotando así que Mirad un momentín Mirad voy a hacer que la posición inicial por ejemplo sea 100 y 200 y así estará más descentrado no caerá en la esquina sino que caerá por aquí por el suelo a continuación lo que voy a hacer es simular matemáticamente una colisión con los bordes para eso necesito un par de variables más voy a crear una variable llamada bellx es igual a velocidad x qué voy a hacer le voy a dar el valor 1 bar Bel y velocidad y será igual a 1 es decir empieza el juego y la velocidad x y la velocidad y son 1 recordad que y crece hacia abajo crece positivo hacia abajo Ya hablaremos más adelante de crear una función o un método que invierta las coordenadas para que sea de abajo arriba vale pero de momento Tenemos que trabajar como es javascript atención mira vamos a ver Aquí está este código es el código cruce es el código que hace que se mueva el personaje vale Así que yo voy a hacer lo siguiente Mirad sí o mira sí voy a hacer una cosa así si la posición x es mayor que 600 porque recordar que mi tablero es de 600 por 600 cada uno que coja su medida en ese caso la velocidad x es igual a menos 1 A qué equivale esto a que si tu posición se sale por la derecha Haz que la velocidad vaya hacia adentro Haz que vuelva hacia dentro con lo cual simplemente con unos cuantos ifs atención todos a la pantalla si la posición x es menor que Cero en ese caso la velocidad x es igual a 1 Qué quiere decir esto Mirad la velocidad atención en x apunta hacia la derecha es más uno apunta hacia allá cuando se salga de 600 yo simplemente le digo Oye ahora tu vector de velocidad apunta hacia allá si vienes de aquí haces pop y rebotas hacia allá vale Por tanto la velocidad x tiene que volverse negativa si la posición y es mayor que 600 entonces la velocidad y es -1 si la posición y es menor que cero entonces la velocidad y es mayor que 1 simplemente estas cuatro condiciones son cuatro estructuras de control If vamos viendo Para qué nos pueden servir las estructuras de control If nos sirven para detectar la colisión y para decir Oye si te intenta salir vuélvete hacia dentro si llevas esta dirección toma esta dirección es decir si venías así vuélvete tu velocidad será la contraria ahora a continuación voy a hacer lo siguiente Mira de la pantalla a ver que voy si la velocidad x es igual a 1 en ese caso post x más pero si no él aquí estaría bien ir a un mundo y coma pero si no els post x menos si la velocidad Es mayor que uno quiere decir que debes sumar si no es mayor que uno quiere decir que debe restar de la misma manera ahora comprobaremos si funciona o no estoy seguro al 100% si la velocidad y es igual a 1 entonces posi y más si no pos y menos vamos a ver qué pasa si ahora recargo el ejercicio podréis comprobar he bajado el Time a 10 milisegundos como la pelota cuando llega a los bordes rebota la pelota cuando llega al borde de arriba rebota es decir lo que estoy haciendo simplemente es decir Oye cuando llegues al borde de abajo invierte tu vector de velocidad y al invertir tu vector de velocidad inevitablemente se está produciendo un rebote efectivamente una corrección y mejora este juego sería la siguiente observaréis que se sale la pelota por bajo y por la derecha y es normal porque el programa no conoce todo la dimensión de la pelota solo conoce la esquina superior izquierda de la pelota vale por tanto efectivamente lo que podríamos hacer sería cambiar las propiedades de 600 menos la anchura de la pelota 600 menos la altura de la pelota Cuál es la anchura y altura 50 por tanto si yo pongo en lugar de 600 550 y 550 comprobaréis como ahora simulamos que la pelota está rebotando en cada uno de esos bordes comprobaremos como el programa parece que reconozca pero es mentiras es pura matemática parece que el programa reconozca Dónde está el contorno de la pelota para rebotar vamos a hacer que el juego finalice cuando este objeto cuando este dip colisione con otro que voy a por ahí que voy a poner por ahí en alguna otra posición ahora voy a tener un problema voy a permitirme que ponga el tiempo a un segundo a un milisegundo para hacer que vaya mucho más rápido todo lo rápido que me pueda dar el navegador y ahora voy a hacer lo siguiente voy a crear un dip con el ID voy a llamarlo Gold vale no como gol de fútbol sino gol de meta de objetivo el objetivo al que le tienes que dar me voy a css atención miradme y digo mira el gol será un objeto que tendrá 50 píxeles fondo rojo si queréis para marcarlo como diferente borde radios y posicionar absoluta vamos a ejecutarlo mirar el gol es este el gol es este objeto que Acabo de crear Aquí y ahora lo que voy a hacer es ponerlo por ahí en la pantalla en alguna parte por ejemplo le voy a decir que webkit transform qué le diría yo pues por ejemplo Translate de no sé por ejemplo 200 píxeles coma 200 píxeles es decir el punto rojo se va a mover 200 píxeles por ahí 200 píxeles por allá una vez que tengo ese punto rojo dibujado para finalizar el juego lo podría hacer con la siguiente estructura de control atención todos cuándo coincidirá la posición verde con la posición del objeto rojo aparte de que en mi caso creo que ha entrado en un bucle un momento en que le pongo una posición inicial diferente 2 3 4 por 1 2 3 y así probablemente no repetirá el bucle bien cuando coincidirá Pues si esta posición es de 200 por 200 voy a decir lo siguiente atención Mirad y post x es igual a 200 y también es cierto que la posición y es igual a 200 en ese caso por ejemplo voy a hacer una alert en el que diga se acabó se acaba el juego por qué Porque el verde le ha tocado al rojo porque el verde está justo donde está el rojo sabéis Qué pasa aparte de que no está tocando nunca creo que ha entrado en otros bucles sin fin Bueno no sé voy a poner por ejemplo si creo que con una caja cuadrada igual estoy entrando siempre en un bucle sin fin Así que voy a hacer que la caja no sea cuadrada voy a hacer que sea 600 por 500 o 600 por 400 y ojo Si cambio Si actualizo mirar la caja veis tengo que actualizar las restricciones matemáticas a 350 atención todos la pantalla Mirad veis que así le da hoy no ha parado bien A ver no ha parado a ver no ha parado Por qué Porque no ha parado porque solo cuando la posición sea exacta es decir tengo un píxel de margen solo cuando la posición sea exactamente 200 por 200 en ese caso parará el juego Qué pasa que esa restricción es muy restrictiva a mí me gustaría que bueno no cuando la posición coincide perfectamente sino cuando la posición de cuando una pelota toque a la otra aunque sea de refilón ahí se pare el juego efectivamente el problema que tengo es que si la coincidencia no es perfecta si la coincidencia no es exacta el videojuego no se acaba pero claro yo lo que me gustaría es que con que la pelota tocara un poquito a la pelota verde la pelota Roja se acabará el juego cómo lo puedo hacer Mirad voy a editar esta igualdad la voy a hacer un poco más larga pero voy a hacer lo siguiente si posición x no mantiene atención si posición x es menor Perdón Es mayor que 200 y también es cierto que posición x es menor que 250 porque la pelota tiene 50 píxeles 200 su posición más 50 su anchura ahora os lo dibujo en la pizarra y también es cierto que posición y es mayor que 200 y también es cierto que posición x ay madre mía bueno si es lo mismo un momento sí posición y escrito bien y posición y es menor que 250 si todo eso es cierto quiere decir que una pelota está tocando a la otra es decir no estoy diciendo que pose x sea igual a 200 sino que pose x está entre 200 y 250 lo he puesto con mayor voy a haber puesto con mayor igual pero bueno simplemente para incluir o no incluir el 200 y el 250 si ahora guardo Y ejecuto esto y esto ha funcionado correctamente comprobaré como la pelota verde al tocar la pelota roja se acabó lo he hecho al revés no tenía que haber sumado tenía que haber restado por tanto Mirad se acabó claro es que se sigue acabando un momentín no quiero que tal lo que tengo que hacer por tanto es que sea mayor de 150 hasta 200 mayor que 150 hasta 200 vamos a verlo ahora vamos a ver si me deja que va a ser que no claro es que con un milisegundo y el problema es que si ahora le digo que no me saque diálogos no me saca diálogos Ah mira si se acabó hay algo que no hay algo que no todavía Hay algún parámetro lo estoy fallando pero veis por lo menos cuando llega pum cuando la toca debe ser algo relacionado con el centro con el 150 y el 200 cuando llega y la toca se acaba el juego vamos a hacer esto un poco más difícil todavía y para hacerlo más difícil todavía lo que voy a hacer es que la pelota roja no esté quieta sino que se vaya moviendo y se vaya moviendo además de manera aleatoria Por tanto os voy a enseñar una parte una pequeña parte de la librería matemática que más adelante cubriremos más en detalle pero ahora vamos a ver un poquito un avance de esa librería matemática hay un método que me encanta que se llama el método Random que es el método aleatorio Por eso yo voy a hacer lo siguiente atención todos en la pantalla simplemente lo que voy a decir permitidme que quite el alert de momento más adelante lo volveré a activar pero es que si no se me para el juego a cada momento vale Así no se me para voy a hacer lo siguiente arriba de claro un par de variables barcos x2 es igual a 100 por ejemplo vamos a poner 100 por poner algo barcos y 2 es igual a 100 por poner algo evidentemente la posición 2x y la posición y2 corresponden a la segunda pelota a la roja Y ahora yo digo atención Mirad en la función de inicio selecciono el personaje no el gol selecciono el objetivo selecciono el rojo y le digo webkit transform post x2 por y2 hasta aquí vale he hecho pose x2 posi y2 y ahora al goal recordad que se llama Gold vale al Gold le pongo Translate post x2 por si griega2 de hecho me he copiado la línea de arriba si guardo y recargo aparece esto simplemente se me ha ido a 100 pues atención entonces a la pantalla voy a hacer una cosa no os va a gustar pero ahora la arreglo Mirad a continuación voy a hacer lo siguiente post x2 es igual a post x2 más punto random todo esto lo voy a meter en un paréntesis por 10 post es igual a y2 más puntos Random por 10 es decir cada vez varía un poco tu posición qué va a hacer esto cuidado mucho cuidado Mira de la pantalla Esto va a hacer que la pelota haga por abajo por qué su superan no he cometido algún error he cometido evidentemente aquí vale más puntos random parece que con minúscula sale de color verde atención se ha ido no lo habéis visto se ha ido pero yo no quería que se fuera yo quería que se quedara por ahí pululando porque se ha ido es muy sencillo la función Random el método Random Perdón del objeto más va de 0 a 1 yo lo he multiplicado de 0 a 1 con decimales yo le he multiplicado desde cero a diez ahora va de 0 a 10 concretamente Entonces el problema está en que siempre suma nunca resta por tanto como no se va a ir hacia abajo a la derecha si siempre suma qué voy a hacer miradme todos a la pantalla voy a esto y voy a decir sí muy bien por menos 5 y así compenso y así en lugar de ir de 0 a 10 irá de menos 5 a más cinco y a veces puede que sume a veces puede que reste dónde estoy aquí menos 5 guardo recargo mira ahí está Qué bonito Hey casi eh un momentín voy a activar el juego Mirad a todos la pantalla aquí se acabó hay una cosa que tengo que corregir Y es que aunque la bola verde llegue ahí un momentín la bola porque ha colisionado ahí vale un momentín mirar todos la pantalla Pero por qué ha colisionado ahí si está clarísimo que no está ahí la pelota roja Por qué ha colisionado Mirad si voy a estructura de control me daré cuenta que la estructura de control seguía creyendo que la posición de la pelota roja estaba entre 150 y 200 Pero eso no es así la nueva posición de la pelota roja es pose x2 vale por tanto lo que voy a hacer es lo siguiente si post x Es mayor que post x 2 - 50 Es mayor que post x2 posi y 2 - 50 por y vamos a verlo vamos a ver si funciona a ver si se interceptan Solo cuando hay vale Ahí tengo un problema de cálculo un momentín pero sí que lo a ver Ahí sí vamos a ver un segundo vale Y ahí está claro he tenido antes una falsa alarma me parece no ahí hay algo que no cuadra bien hay algo mal el cálculo Pero como veréis ahora coincide mejor que antes es decir ahora la pelota verde atrapa a la roja y da solo da positivos al moverse falso positivo queda ver porque es sólo da positivo cuando realmente ahora ya se ha escapado evidentemente ahora no hay mucho que rascar vamos a ver ahí debería a ver si ahora debe haber alguno de las restricciones que no la he expresado correctamente pues x2 Pos x2 pues y2 Esta es y es menor que por si griega2 Claro que sí a ver ahora y casi nos han tocado eso no vale eso nos falta vamos a ver ahora pum Ahora sí ok otra vez bueno se han tocado durante un momento pero no se han reconocido ahora en principio debería haber sí debo modificar algo de la colisión pero básicamente ya reconoce este donde esté la pelota lo único que me gustaría tocar ahora voy a quitar la condición de finalización voy a quitar el último alert es que el jugador rojo no se moviera de manera tan frenética no se moviera así por cierto que si asumimos que drones es cierto Vale ahora mismo hay dos jugadores que estamos ahí machacando en la pantalla Bueno pero en fin lo que vamos a hacer por tanto es crear una serie de variables de velocidad Pues voy a hacer lo siguiente vamos a ver creo un par de variables más esto se va llenando de variables de hecho esto es lo más normal del mundo bar de dirección Bill x igual a cero bar y es igual a cero de momento no hacen nada evidentemente lo que voy a hacer ahora es que esta pelota vaya modificando su dirección es decir serán tanto modificables su dirección x como su dirección y lo voy a escribir Ahora lo veréis y ahora lo explico en la pizarra estamos hablando aquí de la poción muy bien Pues ahora decimos Deer x es igual abrir x más random si queréis voy a poner por cuatro menos por 4 - 12 atención a la pantalla directa es igual direc y es igual a más Random de 4 - 2 y ahora digo Quiero la posición más la dirección en x Quiero la posición más la dirección en y vamos a probarlo a ver si ahora es menos frenético y se ha ido al hiperespacio permitirme un segundo ahora lo arreglo pero veréis que el movimiento ya no es tan frenético un momentín 4 menos 2 se me ha perdido aquí voy a quitarlo directamente hay menos uno menos 0.5 guardo recargo ahí veis sigue siendo aleatorio ahora haré que no se vaya pero fijaos que ya no es tan voy a hacerlo más ya no están como antes vale Ya no es tan frenético como antes de hecho si tuviera suerte Hasta se me quedaría y un rato bien otra cosa que os voy a decir otra cosa que os voy a decir es que en cualquier momento podría anular la dirección de y vamos a ver posición y a muy bien aquí lo tenemos entonces voy a hacer lo siguiente atención si dirección x Es mayor que 10 en ese caso dirección x es igual a dirección x partido 2 lo cual equivale a decir solo carro para el carro vale vas muy rápido pues para lo mismo para dirección y mayor que 10 en ese caso parte y por 2 Y de esa manera me voy a asegurar que dirección y nunca será mayor que 10 se me escapa muy rápido Bueno pues voy a hacer que sea menor que menor todavía menor que 3 aguanta un poquito pero básicamente bien otra cosa que puedo hacer es dirección y es igual a cero lo que estoy haciendo por tanto ahí es jugar con variables para que la pelota no se escape a partir de ahí ya como al final es un movimiento aleatorio y tardará más o tardará menos pero se acabará escapando le puedo programar las mismas colisiones que le he programado la pelota verde para que cuando se vaya a escapar vuelva a rebotar hacia dentro de la caja permitirme que rehaga un poco la pantalla es decir que redistribuye el espacio en pantalla ya que en este caso quiero simular una aplicación para teléfono móvil y por tanto quiero simular que estoy trabajando con teléfono móvil también voy a crear un estilo veo un estilo y voy a empezar haciendo lo siguiente voy a empezar por ejemplo diciendo que el body luego lo cambiaré de color pero para comprobar que esto está funcionando correctamente el body va a tener un background de color Grey bien y tengo ya por tanto aquí la aplicación funcionando de momento lo único que he hecho evidentemente es darle un color gris probando este ejercicio Además vamos a poder empezar a interactuar usando javascript y usando jquery Mediante los eventos por ejemplo en este caso eventos de ratón es que hasta ahora todo ha funcionado un poco de manera automática pero no teníamos manera de interactuar de decir Oye quiero pulsar y que pase algo en la pantalla vale por eso la clase de hoy nos sirve un poco para volver un poco atrás para refrescar pero también para enseñaros un poco más de jquery y sobre todo eventos de ratón Bueno voy a crear un ser virtual que tendrá sus necesidades por tanto puedo empezar trabajando con lo siguiente voy a crear unas primeras variables iniciales ahora inicio jquery Pero antes de crear variables perdón antes de crear la estructura de control de jquery voy a crear una serie de variables de vida del personaje por ejemplo bar hambre el personaje necesita comer si el personaje llega hambre cero es decir tiene comida a cero tendré un problema si queréis vamos a hacerlo Al contrario porque hambre Es una palabra negativa comida es una palabra positiva si tienes mucha hambre es Negativo si tienes mucha comida es positivo vale por tanto voy a poner bar comida y así está claro que si he llegado a cero es Negativo si estoy por ejemplo en 100 es positivo voy a poner una condición de inicio bastante favorable donde comida es igual a 100 es decir el juego empieza con el personaje ya comidito y ya durante el videojuego evidentemente irá teniendo hambre le irá entrando hambre y Tendremos que hacer algo con él muy bien voy a crear otra variable si os fijáis una cosa que yo uso y para mí es un modelo a seguir no solo para programación ni para videojuegos sino no sé de vez en cuando pienso en ello que es la pirámide de maslow la pirámide de maslow si no la conocéis es una teoría psicológica con respecto a las necesidades humanas que dice que el ser humano en primer lugar un momentín que cargo la imagen el ser humano en primer lugar necesita cubrir necesidades relacionadas con la fisiología respiración claro un móvil que respire igual no alimentación esto Sí descanso sexo de momento vamos a dejar esta parte vale para que el no se ponga cachondo y homeostasis la homeostasis es la necesidad de equilibrar los fluidos corporales con el resto del mundo es decir homeostasis es en parte beber y es en partemear hay también es Pero bueno pongamos Que de momento vamos a ir a por alimentación y vamos a ir a por descanso personajes necesitará y cuando esto esté cubierto ya iremos subiendo hacia arriba En la pirámide de maslow vale Pero esto dice que si no has cubierto esto no te preocupes de cubrir esto porque no tiene ningún sentido es decir si no tienes comida y no has descansado te da igual no tiene la amistad porque te vas a morir Nadie se muere de no tener amigos de tristeza como mucho vale Pero te puedes morir perfectamente de no tener comida o no tener descanso Así que vamos a empezar y vamos a empezar por lo más básico teniendo en cuenta la teoría de la pirámide de maslow no es la verdad universal vale pero me parece una buena teoría de referencia Así que bar insisto sueño es negativo tienes mucho sueño es negativo bar despierto estás muy despierto es lo mismo si estás poco despierto es que tienes sueños es muy expertos que no tienes sueño bar despierto es igual a 100 el juego empieza por tanto con unas condiciones de partida favorables para qué Para que no le des hasta el personaje se demora automáticamente vale sino que empiece con un poquito de vidilla ahora habiendo preparado estas dos variables para luego ponemos más voy a crear la estructura de control que me permite trabajar con jquery por tanto voy a decir que cuando el documento este punto ready esté preparado en ese caso ejecutaré la función de inicio y la función de inicio paréntesis no lleva parámetros llaves aquí dentro voy a poner el código ya sabéis dirá alert Estoy vivo guardo recargo por aquí y si todo ha ido bien me saldrá un mensaje en la pantalla que me dirá esto y vivo señal de que jquery está funcionando correctamente a continuación una cosa que hicimos en el ejercicio anterior y que me gustaría que se convirtiera en una costumbre es no empezar a dar vueltas a la función de inicio sino que voy a crear una función externa una función llamada Por ejemplo juego qué hago en lugar de alert Mirad pongo alert en el juego y ejecutó el juego recordad que para ejecutar el juego simplemente tengo que poner juego y paréntesis guardo recargo y me dice estoy vivo pero ahora no me está diciendo Estoy vivo la función de inicio está diciendo Estoy vivo la función de juego voy a hacer lo siguiente atención todos en la pantalla Mirad voy a decir set Time out cada 50 milisegundos Mejor dicho juego función coma 50 milisegundos esto quiere decir ejecútate en bucle ejecutar tú misma de manera ilimitada cuando queramos parar pondremos esto dentro de una variable pero de momento lo que quiero hacer es un bucle ilimitado y por tanto voy a hacer lo siguiente cada vez que pases por aquí comida menos cada Cuanto más tiempo pase menos comida tienes y por tanto Necesitas comer y tienes hambre rebaja a continuación despierto menos pierdo puntos de despierto pierdo puntos de fuerza digamos necesito dormir y ahora si queréis no lo estoy haciendo mala costumbre por mi parte estoy poniendo ahora punto y coma en cada una de las líneas que en principio javascript el retorno de carro se para instrucciones teóricamente no haría falta poner punto y coma pero Oye si lo hacemos mejor todavía es una buena costumbre os lo puedo asegurar guardo recargo Mirad lo que pasa No pasa nada en la pantalla bueno no pasa nada la pantalla porque yo no le he dicho que pasa nada Es decir si tú tienes sueño hay un cartel en tu cabeza que pone Tengo sueño No es algo que pasa dentro de ti pues de esta manera estas variables también son algo que pasan Dentro de este personaje Así que yo lo que quiero hasta que programe una interfaz visual hasta que diseñe un personaje animado lo que quiero es que me saque algo en la pantalla por eso dentro del Body voy a hacer lo siguiente y así de paso os voy enseñando nuevas cosas de jquery VIP y de es igual a comida y hago otro dip despierto lo que voy a hacer es mediante javascript y mediante jquery poner en cada uno de sus recipientes el valor de la comida y el valor de El despierto para eso dentro de la función juego hago lo siguiente atención en la pantalla primero jquery selector selecciono algo selecciono aquello que tiene el ide comida es decir dólar paréntesis comillas almohadilla comida luego uso un punto y recordad que después del punto tengo que escribir el método que voy a usar el método es un nuevo método que no hemos usado hasta ahora que es un método llamado html este método además me gusta mucho porque tiene un doble uso si el paréntesis está vacío quiere decir que de comida Quiero leer mientras que si el paréntesis está lleno quiere decir que en comida quiero escribir por eso el mismo método te sirve tanto para leer Como para escribir en este caso quiero escribir en este caso quiero que dentro del dip comida me ponga Cuánta comida le queda al por eso Aquí voy a hacer lo siguiente Voy a hacer comida dentro de comida quiero introducir en html la variable comida quiero introducir el valor ahí dentro sigo otra vez dentro selector de El div con ID despierto punto html quiero introducir la variable despierto guardo atención dos a la pantalla guardo recargo y a ver qué pasa y lo que pasa es esto Ahí va está perdiendo mucha comida está perdiendo mucha vida y llega un momento en que la comida y el sueño se vuelven negativos evidentemente cuando el hambre se vuelve negativo y el sueño es muy negativo quiere decir que ya es que nos hemos muerto de sueño y nos hemos muerto de hambre por eso yo voy a hacer lo siguiente en el momento digo sí voy a establecer una primera condición vital comida es menor que cero despierto es menor que cero en ese caso me he muerto por tanto en ese caso lo que voy a hacer es lo siguiente primero css recordad que estemos viendo css y le digo el body css el body tiene un background rojo se muere el fondo se queda de color rojo y a continuación comida es igual a cero despierto es igual a cero lo cual quiere decir No seas negativo no puede ser Negativo si intenta ser negativo es cero si hago esto por tanto mirar atención a la pantalla ahora guardo y recargo y pasa lo siguiente empieza a perder vida empieza a perder comida y pan veis cuando el personaje su sueño su energía digamos o su comida llega a cero se vuelve de color rojo el personaje se ha muerto y los contadores ya no se mueven de ese punto lo que necesito ahora ya que tengo un personaje del cual su energía va disminuyendo y su comida Va disminuyendo también es que necesito darle más de estas cosas necesito darle energía necesito darle comida en un momento dado voy a crear por tanto dentro del Body a continuación de los dos Vips lo estoy haciendo de momento de manera muy primitiva vale Pero más adelante ya le daremos algo de grafismo un botón con ID alimentar a y perdón dentro del botón verdad Entre la etiqueta de apertura y del cierre del botón es muy importante que pongáis el texto que va a contener el botón alimentar mismo para que nos vamos a complicar alimentar A ver no lo puedo subir más alimentar de momento he creado por supuesto un botón que no hace nada mirada la pantalla si ahora guardo y recargo tengo un botón alimentar pero es que de momento no hace nada evidentemente lo que voy a hacer ahora mediante el mediante código javascript es que pueda alimentar a este personaje cómo lo voy a hacer Mira es muy sencillo voy a enseñaros una propiedad muy útil la Vais a usar constantemente un método de jquery llamado es el método click y es el así de sencillo y es el método que te permite decir que cuando hagas clic en algo pase otra cosa voy a hacer por tanto lo siguiente selecciono el botón alimentar selecciono aquello que tenga el ID alimentar pongo punto y a continuación el método que voy a usar el método que voy a usar es clic yo puedo poner el código de alimentar dentro de los paréntesis o puedo llamar a otra función voy a llamar otra función llamaré a la función alimentar existe No pues tendré que crearla la función alimentar paréntesis llaves dice que comida más igual 50 comida más igual a 50 es una manera resumida de decir comida es igual a comida más 50 es lo mismo Solo que este es un operador resumido en este caso de incremento comida más igual 50 quiere decir que cada vez que pulse el botón alimentar el personaje tendrá 50 puntos más de comida vamos a verlo vamos a ver si funciona guardo recargo Mira le doy a alimentar veis como madre mía Cuántos puntos tengo a ver momento le he dado mil más igual 50 a ver claro es que no es comida así sí que es comida pues a ver qué le puede pasar voy a poner comida es igual a comida más 50 vamos a recargar le estoy dando como 500 más 5000 Qué cosas a ver bien a ver un segundo comida es igual a vale Claro claro el problema está en que como lo estoy llamando dentro de un bucle cada vez que lo ejecuto se ejecuta n veces es decir el problema está en que lo estoy ejecutando si está en 50 lo estoy ejecutando 200 veces cada segundo por tanto cada vez que hago clic el tiempo que paso haciendo clic es tiempo que le estoy ahí asignando valores así que bueno vale No está mal de todas formas la signo ahí mucha más comida vale pero el caso está en que fijaos que el personaje aunque tenga comida cuando se le acaba el sueño se muere igualmente vale por tanto esto no me sirve en principio tengo que crear otro botón y de energía dar energía pegamosle bien Red Bull no lo ponga a dormir pero le doy un Red Bull dar energía y pongo energía y ahora digo mira cuando sobre dar energía aquel elemento que tiene el ID dar energía hago clic en ese momento ejecuto una función que no existe llamada energía la función energía la voy a definir a continuación la función energía dice que despierto es igual a despierto más 50 claro me he vuelto un poco atención mirada la pantalla esclavo de este juego pero Oye es que tener un tamagotchie es como ser un esclavo del tamagotchi porque le hago así Mirad hago así y con alimentar puedo ir dándole energía es decir mientras yo siga pulsando estos botones todo irá bien Qué es lo debajo era despierto pues tengo que darle energía veis cómo tiene menos a ver si lo veis lo pongo en la pantalla energía más Uy Cuánta elevado pues Hala Ahora parece que me estoy quedando sin alimento me queda un rato todavía pero me estoy quedando sin alimento así que de vez en cuando le digo pum alimentar Cuando esto me quede sin espacio me quedo sin energía le volveré a dar energía lo que estoy haciendo por tanto es tener una serie de contadores y tener unas funciones dentro del programa unas zonas sensibles llamaríamos ahora mismo donde si quiero alimentar al personaje le doy aquí si quiero darle energía al personaje le doy aquí en este caso otra manera de trabajar puede ser la siguiente Oye para qué poner aquí una función que realmente tiene solo una instrucción no puedo ponerlo aquí directamente no pero puedo hacer lo siguiente puedo crear una función anónima es decir una función Sin nombre función y le digo comidas igual a comida más 50 y lo mismo puedo hacer aquí energía es igual a energía más 50 borro ahora evidentemente estas funciones ya que ya no me sirven recargo alimento y Bueno estamos básicamente en lo mismo lo único que hay energía es que no es energía es comida es despierto efectivamente despierto y despierto guardo recargo alimento energía Bueno vamos a ver bien lo que voy a hacer es derivar todo esto a funciones externas voy a poner lo siguiente función alimentar y la función alimentar va a hacer lo siguiente primero comida es igual a comida más 5 y lo segundo dentro que realmente dentro de comida pongo el valor de comida y le digo que esto ya no es una función sino que es alimentar guardo recargo vamos a comprobarlo y fijaos Mirad comida es igual a comida ahora estoy subiendo cada 5 puntos que es lo que especificado aquí es decir lo que he hecho en esa función es decirle que quiero aumentar el valor y luego que quiero poner ese valor dentro del DIF así en principio parece que funciona algo mejor Voy a verlo a continuación con un Time out de 5000 alimento voy pulsando a ver qué pasa dentro de 5 segundos vale 43 53 aumenta cada 10 y ahora aumenta cada 15 es decir va sumando muy bien fijaos ahora aumenta cada 5 pero luego cada 15 va aumentando comidas igual a comida +5 cada vez que pulso claro vale Ya lo tengo porque cada vez que pulso realmente lo está pulsando dos veces la tercera vez lo pulsa tres veces es decir vale 3 sé por qué es pero claro No sabría Cómo pararlo porque tendría que cada vez pararlo y volver a arrancarlo por eso de momento lo voy a dejar así y ahora luego con el Time out vemos de vez en cuando como parar y reiniciar Para que no haga eso de momento lo voy a dejar así lo voy a dejar con dos funciones externas alimentar y energía donde en este caso despierto es igual a despierto más 5 y dentro de despierto pongo html despierto voy a dejar el juego con un refresco de 0,5 segundos a ver hay algo que no realmente cuando este personaje se está muriendo de hambre yo le tengo que alimentar pero cuando el personaje le falta energía Yo realmente no hace falta que le dé energía Simplemente si le falta sueño con que le deje dormir un rato problema solucionado así que voy a cambiar el comportamiento de este juego para que haya un botón alimentar pero que en lugar de ver un botón de energía Simplemente yo le puedo dejar al personaje que de vez en cuando se pueda poner a dormir cuidado antes de irse a dormir tendré que haberle dado de comer porque como se quede sin comida mientras está durmiendo se puede morir vale lo pilláis bien para esto por tanto voy a hacer lo siguiente Mirad lo que voy a hacer es decirle que si se queda sin comida se muere pero de momento si se queda sin despierto no y ahora voy a hacer lo siguiente Mira todos la pantalla cuando el personaje se empieza a quedar sin o sea se empiece a tener sueño es decir empieza a no tener energía pasará lo siguiente vamos a ver pam pam aquí en la función juego sí energía o dónde está comida es menor que 10 si estoy por debajo de en ese caso haré lo siguiente en ese caso sobre el body aplicaré un parámetro css donde la opacidad será igual vamos a ver a comida partido 10 esto quiere decir Mirad que cuando el personaje se tenga el sueño se irá a dormir y por tanto su opacidad bajará vamos a verlo 98 97 ahora lo aceleró un poco momento el tema no es realmente que se pare o no se pare lo que tiene que hacer es irse a dormir quiere decir que la opacidad del Body es de todo de desaparecer cuando baja de 10 y evidentemente una vez desaparezca por supuesto se parará Porque se muere en color rojo pero como es transparente no se verá nada esto ya casi por 20 por tanto vamos a comprobar si Más allá de 10 más bajo de 10 el personaje no tiene energías vamos a ver Mirad atención estoy grabando Mirad Cómo empieza a desaparecer y ahí está y ahora ya se muere una manera de hacer esto sería por ejemplo establecer una condición de vida en la que yo le diga cuando el sueño haya llegado a cero en ese caso o con cuando despierto sea igual a cero en ese caso despierto es igual a 100 y ya has dormido pues ala a despertarse algo por tanto lo siguiente sí despierto es menor que Cero en ese caso despierto es igual a 100 y por supuesto voy a hacer que la opacidad del Body sea igual a 1 es decir que el body vuelva a la vida uno lo que he hecho es despierto igual a 100 es decir vuelve a empezar Pero vale la opacidad tiene que ser B1 vamos a probarlo voy a darle un poquito más de Caña a esto voy a decirle 500 pues 100 Mira atención el personaje voy a alimentarlo para que no se muera y ahora al final lo que va a hacer se queda sin energía se va a dormir y cuando se va a dormir vuelve a aparecer Pero cuidado se está quedando sin alimento le doy vuelve a dormir de vez en cuando necesita dormir se vuelve a dormir estoy acelerando esto para que ocurra mucho más rápidamente veis yo tengo por tanto dos variables de vida artificial una es la alimentación otra es el sueño el mismo personaje se lo puede autorregular la alimentación necesita que nosotros y se la autorregulemos se la regulemos manualmente los contadores se pueden parar de hecho Generalmente los contadores que empiezan a dar vueltas loseta y Mouse los bucles que empiezan a dar vueltas se empiezan a incrementales cuando se vuelven incrementales muchas veces tienden a gastar demasiada memoria existen varias funciones para poder resetear un Time out pero requieren todas ellas de una condición Que no nosotros no estamos cumpliendo porque no la hemos necesitado hasta ahora y es que el Time out esté metido dentro de una variable yo no puedo parar un Time out si ese Time out no está metido dentro de una variable Cómo meto yo el Time out dentro de una variable pues es muy sencillo yo simplemente aquí digo aquí arriba bar bucle no necesito de momento ni darle valor y ahora digo bucle es igual a Zeta de una variable recargo el juego sigue funcionando igual por tanto veis que meter un Time out dentro de una variable en principio no modifica el comportamiento del Time out lo que haré ahora es crear un reset para el para eso voy a escribir lo siguiente voy a poner set Time out vamos a verlo Aquí está el Clear tamal fijaos lo que he hecho por tanto lo que haré por tanto será Establecer un Clear Time out donde necesito decir quién va a ser el Time out que quiero parar Solo cuando pongo el Time out dentro de una variable puedo poner en un Clear Time out la variable del Time out Vale entonces lo que hago es lo siguiente le digo por ejemplo cuando le doy comida que era el problema que tenía que se me volvía exponencial digo Clear Time out escribe igual en lugar de Zeta y entre paréntesis pongo a quien quiero parar a quien quiero parar a bucle a la variable bucle que para eso la he creado claro Parece que tengo un problema vamos a verlo a ver si lo escrito correctamente Clear todo correcto vale mira pim Pam alimento hoy por qué Porque yo he parado el Time out lo que he hecho es reiniciarlo pero reiniciar el Time out no quiere decir volverlo a arrancar quiere decir pararlo vale por tanto lo que voy a hacer un momentín vale le doy aquí y le digo una vez que le doy comida puedo volver a arrancar el juego veis aquí lo que estoy haciendo es parar el timer aquí lo que estoy haciendo es volver a arrancar el bucle a ver un momento mirar porque parece que no hemos solucionado nada pero realmente estamos a un paso de solucionarlo atención guardo y recargo alimento y me sigue siendo exponencial Sí pero ahora ya soy capaz de parar y arrancar de nuevo el juego por tanto ahora le puedo decir bucle es igual a Zeta y Mouse lo que sea cada vez que pase por aquí le voy a decir que paro el bucle a ver si no se me cuelga Clear Time out bucle bien alimento y calma alimento porque aquí no he puesto esto voy a quitar esto de aquí alimento vamos a ver Clear bucle o tengo que hacer ahora es ponerlo por aquí detrás vale muy bien ahora lo estoy parando por las sencillas razón de que cada vez que llega aquí bucle lo que tengo que hacer por tanto es meterlo en alguna posición donde no se ha incrementado quiero hacer una tercera variable que sea el aburrimiento o que sea digamos la diversión para ponerlo en positivo por eso digo en la parte de arriba del todo va a dar diversión más diversión empieza siendo igual a 100 ahora lo que haré es lo siguiente me vengo por aquí y digo comida alimentar que se me ha ocurrido la solución al problema anterior Entonces ahora dividido por dos bien ahora os la cuento vamos a hacer antes el tema de la diversión voy a hacer que cada vez que pase por aquí una vez más y el personaje no lo diviertes se va aburriendo evidentemente la diversión no hará que el personaje se muera quizás se deprima y al deprimirse puede ser que tenga más hambre o puede ser que tenga más sueño o sea que cuidado voy a poner diversión voy a hacer un nuevo dip llamado diversión un nuevo dip llamado diversión y voy a decir lo siguiente Mirad atención voy a decir que dentro de diversión Quiero poner html la variable diversión cuarto recargo atención Mirad guardo recargo y tengo ahí tres variables ahora alimentar el botón de energía lo voy a quitar porque ya no me sirve para nada porque energía Ya hemos quedado que el personaje se alimenta solito y mira se duerme solito quiere decir Y en lugar de energía voy a poner dar diversión y dentro de energía voy a poner diversión y ahora Como no una función donde pondré si en dar diversión hago clic en ese caso activaré diversión y en ese caso por tanto diversión lo que estoy haciendo es reutilizar las funciones de energía para la diversión Así que diversión es igual a diversión más 5 guardo recargo y Mirad puedo alimentar y puedo darle diversión a ver diversiones igual a diversión más 5 cuando hago clic ejecuto dar diversión y dentro de diversión pongo la variable dimensión dar diversión Aquí está dar diversión cuando hago clic sobre el botón dar diversión ejecutó la función de inversión diversión es igual diversión más 5 y pongo que en diversión pongo la variable html diversión voy a ponerlo cómo funciona diversión es igual a diversión más 5 Ahora sí alimentar y diversión la solución por tanto a este problema es muy sencilla consiste en aquellos eventos de clic que definido los voy a sacar de la función de juego y los voy a meter en la función de inicio la función de inicio por tanto declara una sola vez que cuando haga clic sobre los botones les daré más comida o más diversión pero no vuelve a declarar los botones cada una de las veces cada vez que pasa por el juego simplemente se quedan definidos ahí y ya está y dejamos exclusivamente para el juego aquello que tiene que ejecutarse aquello que tiene que validarse cada vez que el juego pasa por aquí por eso ahora guardo recargo y Mirad como si pulso ahora alimentar lo sube de uno en uno Perdón sube de 5 en 5 y diversión lo sube de 5 en 5 cuidado no se quede sin comida casi se me queda sin comida veis hay que darle de vez en cuando la diversión puede ser negativa No pasa nada Ey que se me queda sin comida esto ya es decir estoy aquí esclavizado pulsando botones es que se me vuelve a quedar sin comida y claro si me descuido Mirad me descuido Y ya el pobrecillo se muere que le voy a hacer bien ya tenemos ahí una vida artificial de hecho tenemos ahí más un esclavizador artificial vale Pero tenemos ya algo parecido Aunque insisto no es nada gráfico de momento pero es que eso me da igual los gráficos No digo que son lo de menos porque a la hora de la verdad es lo que vende al cliente pero el gráfico es estático lo que hace que se mueva el juego real es lo que estamos haciendo ahora en principio podríamos decir aunque no sé si será cierto pero podríamos decir que nadie se muere de aburrimiento pero podríamos hacer que esa infelicidad de este personaje influyera en su estado de salud y por tanto podríamos hacer ya que no tenemos un parámetro llamado salud pero sí tenemos un parámetro llamado alimentación podríamos hacer que cuando el personaje esté deprimido necesite comer más y por tanto subidas o energía de crezca más rápido por eso lo que voy a hacer Voy por supuesto a hacer aquí lo siguiente vamos a ver dar diversión no le voy a decir o inicio No aquí voy a decir que sí diversión es menor que Cero en ese caso para que no baje de cero diversión es igual a cero guardo recargo y ahora veréis como diversión se convierte a cero ahora lo que necesito es Establecer un multiplicador No quiero que se muera para que se quede allá cero para comprobar que se queda a cero lo que voy a hacer ahora es Establecer un multiplicador y digo bar multiplica aburrimiento que empieza siendo igual a 1 y ahora digo lo siguiente atención vamos a ver comida menos no comida es igual la comida menos uno voy a ponerlo entre paréntesis menos uno por multiplica aburrimiento el resultado será el mismo porque como multiplica aburrimiento es igual a uno por uno es igual a uno Mirad atención pero yo ahora voy a decir lo siguiente Y es que si vamos a ver dónde estás aquí si de versión es menor que Cero en ese caso multiplica aburrimiento es igual a 2 Eso quiere decir que va a perder el doble de energía va a disminuir la energía más rápido pero En cambio cuando le dé diversión función de inversión le diré que multiplica aburrimiento es igual a 1 es decir cuando le dé diversión recuperará su estado de ánimo y ya no de crecerá la energía tan rápido atención Mirad yo lo alimento tengo que hacer muchos clics para que no se muera pero cuando se queda sin diversión Mirad como la energía Mirad como una energía baja más rápido todavía ves cómo baja más rápido lo puedo alimentar pero es una lucha contracorriente porque en cuanto a la diversión baje irá más rápido todavía hasta que no lo divierta vamos a ver una vez lo divierta creo que no me ha hecho caso bien bueno se me ha muerto mal pero lo que tengo que hacer es que multiplica aburrimiento vuelva a ser uno me ha hecho caso diversión porque míralo ahí está porque dar diversión no tenía en cuenta ese multiplica aburrimiento igual a 1 es decir no estaba contando con esta función voy a contar ahora vamos a volver a probarlo alimento pero se queda sin diversión se queda sin diversión y por tanto el contador empieza a bajar más rápido madre mía tan rápido que casi me pilla pero si le doy diversión fijaos veis Cómo se ralentiza no sé si se ha realizado venga Diviértete hombre no tengo muy claro o sea divertido o no Ah claro es que tengo que mantener las dos madre mía qué presión Es que creo que debería poner el auto un poco lo estoy haciendo así para que no tengamos que esperar mucho pero caray esto es una un estrés que es de lo que se trata el juego evidentemente voy a crear ahora otra carpeta a la que voy a llamar por ejemplo a tienda carrito dentro de carrito una vez más voy a poner jquery.js y al lado de jquery.js voy a hacer un documento de texto index.html por supuesto como os podéis imaginar index.html lo voy a cargar tanto en el editor como en el navegador reparto en este caso la pantalla Mitad y Mitad ya que no necesito realmente que sea ahora para móvil podría hacerlo para móvil porque no pero no es el objetivo de este ejercicio y una vez más creo un Head creó un Body y crea un Script de tipo texto barra javascript cuyo short es jquery.js a continuación trabajo con un Script y pongo Este es mi código y una vez más por qué no os invito a poner que cuando el documento esté preparado inicio y la función de inicio hará alert Hola y alert Hola por aquí bien ya lo tenemos ya tenemos por tanto la estructura de este documento en funcionamiento voy a hacer lo siguiente voy a simular que tengo una serie de productos de los que voy a usar con los que voy a usar las imágenes típicas y características de Windows que tenéis en atención mirar en documentos bibliotecas imágenes las imágenes de muestra las típicas imágenes de Windows pues copiarlas y pegarlas dentro de la carpeta José Vicente cada uno su carpeta carrito y voy a hacer lo siguiente Mira dentro del Body voy a crear una article Por qué no usamos la etiqueta artiquel ya que serían artículos de una tienda online y digo img src penguins.jg y digo no sé comprar button y de pingüinos no botón de class compra y atención Cuánto valen los pingüinos por ejemplo 50 voy a poner que el valor el botón tenga un valor de 50 cómo es posible que un botón tenga un valor cualquier etiqueta bip puede tener un valor simplemente es un valor que se queda escondido 50 a ver si el value no me aparece compra y vale compra Ahí está voy a poner la imagen un poquito más pequeña coincidiréis conmigo with es igual a 100 píxeles voy a quitar la alerta también y pongo por aquí un br Vale ahora puedo comprar los pingüinos Mirad Cuando compre aquí los pingüinos vale quiero Que aparezca 50 euros en el carrito de compra por tanto ahora podría hacer lo mismo mirada atención a la pantalla con el resto de elementos voy a poner tres o cuatro artículos tampoco hace falta que me mate más tengo Mirad tengo por aquí un crisantemo voy a vender crisantemos tengo por aquí una hortensias y tengo por aquí un koala Así que básicamente vendo cuatro cosas en mi tienda online vendo pingüinos crisantemos hortensias y un koala la mezcla de floristería tienda de animales prohibidos de hecho pero cuando yo le pincha a cada uno de estos botones quiero que se actualice el total de mi compra a Por cierto Cuánto valen las los crisantemos por ejemplo valen 20 Cuánto valen las hortensias creo que valgan 10 Cuánto vale el koala quiero que valga 80 es decir cada producto con un precio diferente para que luego veáis cómo se actualiza correctamente el total y el subtotal y ahora creo un div por aquí y de total donde digo el total de su compra es y Mirad por último para esta parte del ejercicio voy a poner una etiqueta que no estoy seguro si hemos usado hasta ahora que es la etiqueta span spam Y de igual a subtotal que es la etiqueta spam Para qué sirve la etiqueta spam es como un div con la diferencia de que es más pequeño mientras que un dip salta de línea un spam puede estar en línea aparte de eso no hay prácticamente ninguna diferencia más podríamos usar en lugar de un spam hundir vale Pero como quiero que ponga el total de su compra es y a continuación un número por eso uso un spam recordad que podría usar porque no la etiqueta longaniza Así que el total de su compra es lo que sea es muy importante en este caso recordad que cada botón tenga un valor en este caso 50 20 10 80 o lo que sea a continuación lo que voy a hacer es por supuesto como os podéis imaginar crear una variable arriba del todo bar llamada subtotal que evidentemente inicializo a cero el total de tu compra el subtotal de tu compra porque el total es después de aplicar impuestos el subtotal de tu compra de momento es igual a cero y ahora escribo lo siguiente atención que voy digo cuando sobre un botón que sea de clase perdón de clase no de clase compra punto compra haga clic ejecutaré la función suma ya que recordáis que el botón es de clase compra por tanto pongo punto compra ejecutaré la función suma que a continuación voy a definir la función suma hará lo siguiente A ver vamos a acabar esta función y ahora pongo en su total a cero y hago lo siguiente y esto es delicado atención voy a seleccionar una cosa a ver voy a hacer lo siguiente subtotal es igual a su total más atención que voy mirada a la pantalla selecciono this ostras que es esto this punto atributo value yo Qué hago veréis cuando haga clic en suma lo que haré es tomar el valor pero el valor de quién el valor de qué botón el valor de Test es una palabra reservada de javascript y de muchos lenguajes de programación que sirve para decir yo mismo si yo he hecho clic en Ese botón quiero averiguar el valor de Ese botón no de cualquier otro motor no hace falta ni siquiera Llamar a Ese botón con el ID con la clase con lo que sea lo que estoy haciendo es decirle de este botón que he pulsado tengo mil botones pero de este botón concreto voy a sacar el valor de este botón no de cualquier otro botón vale por tanto para eso está la palabra reservada this vamos a verlo y antes de ello en la función de inicio voy a hacer lo siguiente en el spam total realmente es aquí su total subtotal punto html y pongo el valor de la variable subtotal Cuánto valía su total 0 eso hará mirada la pantalla que si todo va bien recargo me dice el total de su compra es cero esto lo que ha hecho simplemente es poner en subtotal el html la variable total Cuánto vale la variable subtotal al principio 0 vale por eso a ver si funciona a ver si el dish me responde bien porque cuando yo le digo comprar bien Aquí tengo algún problema función suma y tengo que reconocer el atributo valor para ponerlo a Claro Perdón porque yo le he dicho que el subtotal suma El subtotal sube Pero en ningún momento le estoy diciendo que me lo vuelva a poner antes no había que hacerlo Antes había estaba directamente pero es que antes estaba en un bucle y ahora no estoy en un bucle por eso guardo recargo vamos a comprobarlo compro mira Qué horror a ver Ahí va esto parece que quiera funcionar pero hay algo que no bien a ver un momento mirar la pantalla mira lo que está pasando guardo recargo o sea los pingüinos Valen 50 euros Y en lugar de subirme 50 euros en lugar de sumarme 50 euros 50 pero es que si yo le doy otra vez a compra me vuelve a poner 050 por qué yo os lo cuento su total pone su total más esto de aquí y esto de aquí el value es un número por qué me lo encadena en lugar de sumarlo por una razón muy sencilla este value está en una cadena está entre comillas y no puedo poner otra manera y este value aunque Aquí está entre comillas me lo está devolviendo como una cadena ese 50 no está subiendo como número está subiendo como cadena y como está subiendo como cadena me lo está tratando como una cadena hay varias soluciones yo creo que la solución más sencilla cuando surja este problema y todos aquellos que hagáis aplicaciones web como tiendas online o cosas parecidas os va a pasar Es simplemente cambiar manualmente la tipificación de la variable y esta tipificación se puede cambiar por ejemplo con una función llamada as-int lo que va a hacer es decir Oye todo lo que tengas aquí dentro me lo conviertes en un entero me lo conviertes en un número entero de tal forma que cuando sume podré sumar Mejor vamos a ver si lo escrito correctamente y no me da ningún error atención todos la pantalla guardo recargo y cuando compro ahora bien Algún error he cometido porque no suma nada lo que voy a hacer por tanto ahora probablemente tendré que crear una variable intermedia y tratarlo con esa variable de todas formas me voy a asegurar a ver si es que la es minúsculas que también podría ser bien nada voy a ver la documentación con respecto al método Ash voy a usar en este caso en lugar de as int voy a usar el pars int lo probamos y ahora sí me dice que 50 si ahora ejecuto de nuevo las en este caso las que los crisantemos 50 más 20 igual a 70 me compro ahora hortensias y suma 10 me compro un koala y 80 más 80 son 160 veis por tanto como sin necesidad de recargar la página Tengo un carrito de compras donde estoy calculando en este caso el subtotal de mi compra voy a crear ahora otro div ID totales y pongo atención Mira de la pantalla y pongo un botón con el ID igual a Calcula totales cuyo caption evidentemente como os podéis imaginar es Calcula totales no tiene ningún misterio guardo recargo calculo totales y aquí abajo pondré lo siguiente un br el IVA de tu compra es de voy a poner el IVA 21% el IVA 21% de tu compra es de span y va es más puedo poner aquí cero de manera estática directamente porque luego lo voy a sustituir y luego voy a poner un br el total de tu compra es de spam y de súper total spam y pongo ahí estático un cero a ver cuando yo le dé aquí veis aparece un cero cuando llegue de aquí Calcula totales yo querré que se coja el subdotal se calcule el IVA y luego se sume el subtotal más el IVA para dar el súper total una vez más insisto esto es solo estructura a continuación voy a crear la programación a continuación a ver un momentín a continuación voy a crear el javascript digo lo siguiente ahora os lo dejo para que copies y digo lo siguiente en la función de inicio y ahora voy a grabar esto y ahora os mareo un poco con una cosa en la función de inicio voy a decir que cuando pulse aquel elemento que se llama Calcula totales cuando haga clic ejecutaré la función Calcula totales la función Calcula totales hará lo siguiente atención todo el mundo de la pantalla bar iba es igual a cero va al total es igual a cero iba es igual a subtotal por 0.21 en el spam llamado iva pongo el html de la variable IVA y en el spam con ID super total pongo el html de El subtotal más el IVA si todo está funcionado correctamente mirada la pantalla y ahora podéis copiar si compro unos pingüinos que valen voy a comprar algo que valga 10 euros 10 y así veo claramente el IVA el total de su compra es de 10 euros Así que Calcula totales el 21 vaya y algo por aquí que casi el IVA 021 es de 0 pero el total es de 12 con uno o sea ha salido bien luego tengo que ver que ha pasado con el IVA y lo que ha pasado con el IVA probablemente es que el IVA lo he puesto en mayúsculas mientras que aquí arriba lo había puesto en minúsculas Así que guardo recargo y ahora compro esto 10 euros calculo totales el 21% de 10 es 2,1 y por tanto 10 + 2,1 es igual a 12,1 tengo ya por tanto una tienda online funcionando donde puedo comprar varios productos y una vez que he comprado varios productos cálculo totales y me Calcula tanto el IVA como el total y ahora la librería matemática de javascript tiene cosas buenas y cosas tan buenas una de ellas es que en comparación con la librería de php la librería de php suele resultar mejor Mirad voy a buscar el método más punto round javascript Brown y veréis lo que hace en este caso es redondear un número al siguiente entero al entero más cercano dependiendo del decimal el problema está en que no tengo decimales Por eso voy a crear un archivo de hecho Incluso en esos específicos no me hace falta ni jquery y voy a crear un archivo llamado redondear punto html y os voy a explicar cuál es el truco cuando queremos redondear con x decimales Así que lo subo y pongo lo siguiente html body y voy a hacer ahora una etiqueta de Script de tipo es igual a texto barra javascript y pongo document.ride Hola simplemente para comprobar que esto está funcionando correctamente a continuación voy a hacer un redondeo el redondeo hace lo siguiente más punto round de por ejemplo 4.3 4.3 redondeada 4.7 redonde a 5 4.747 tal Y lo que sea redondea también a 5 el problema está en que yo hay veces que me gustaría redondear con decimales con la librería maf.rah así como en las librerías matemáticas de php puedes redondear y a la vez decir cuántos decimales quieres eso no existe no hay esa opción en javascript Pero hay un truco el truco es el siguiente número es igual a esto número es igual a número por 100 Así que yo ahora lo que hago es redondéame número y el número es 4,74 O sea 474 si ahora cojo esto y lo parto por 100 tengo 4.74 que si os fijáis consiste en este número y dejarlo con dos decimales quieres cuatro decimales No pasa nada multiplícalo por 10.000 divídelo por 10.000 y tendrás cuatro con 74 35 4 con 74 35 el truco por tanto es un truco matemático simplemente consiste en multiplicar y dividir por una cantidad que tenga el número de ceros tantos ceros como decimales quieras obtener una reflexión que quiero hacer específicamente tocando al tema de jquery y de javascript es que aunque no lo creáis hasta ahora he estado escribiendo en el modo fácil porque en jquery y en javascript en general hay dos maneras de escribir se puede escribir a lo fácil o a lo difícil vamos a ver por tanto que me meto aquí en index y esto que he escrito yo ahora está escrito a lo fácil porque lo que yo he hecho es desglosar todo desgranar todas las funciones de tal forma que ocupen muchas líneas pero a cambio sean más entendibles esto quiere decir que yo he creado realmente cuatro funciones cuando el documento Mirad la atención cuando el documento está preparado Llama a inicio y ejecuto inicio y cuando hago clic en compra ejecuto suma y me voy a compra veis esto todo el rato saltando de una función a otra y esto lo que hace es que gasto más tiempo escribiendo código porque gasto más tiempo creando aquí funciones en cambio lo que podría hacer es escribir esto de manera comprimida el objetivo de este ejercicio que voy a hacer a continuación es transformar todo este código de fácil a difícil es decir transformar de código extendido a código comprimido No porque hoy lo tengáis que aprender ya sino simplemente para que sepáis que se puede porque en un futuro no hoy ni mañana ni pasado pero en un futuro lo que haremos es en lugar de escribir código tan desarrollado lo comprimiremos será más difícil de entender pero tardaremos menos tiempo en escribirlo Cómo se hace esto mira Yo podría por ejemplo decirle que en lugar de llamar a la suma a ver su total vale en lugar de llamar a la suma que suma es una función puedo hacer lo siguiente función donde subtotal punto y coma y suma voy a quitar el ajuste de texto de edit fijaos que ahora me puedo cargar de hecho la función de suma veis la línea tan larga que tengo ahora lo analizamos y además Calcula totales de aquí se va y llama una función Bueno pues le puedo decir que creo una función local Sin nombre que en cadena estas tres instrucciones y por tanto me puedo cargar cuando ocupaba el texto no sé unas 20 líneas igual todo el código 20 líneas y borro esto ya he borrado unas cuantas pero es que os digo más resulta que la función de inicio se llama aquí y se ejecuta aquí Oye Porque no podría poner todo esto aquí dentro Claro que podría Así que hago lo siguiente todo esto va a ir aquí función y digo aquí pongo esto vale Esto va con un punto y coma Esto va con un punto y coma y ahora su total html su total aquí debe ir un punto y coma en cadena ahí está Y por último en cadena Eso quiere decir que ya me puedo cargar la función de inicio lo que he hecho por tanto es pasar de código desarrollado a código comprimido lo he metido ahí dentro vamos a ver un momentín de hecho vamos a comprobar si funciona creéis que funcionará No lo sé el problema de escribir código comprimido es que las posibilidades escribir errores aumentan y las posibilidades de detectar los errores disminuyen guardo recargo tienda compro funciona y calculo totales y funciona luego lo que he hecho me podría haber salido mal pero podría haber olvidado algún punto y coma lo que he hecho simplemente es comprimir todo ese código dentro de una sola línea voy a leer el código Por cierto que esto va arriba voy a leer el código le digo cuando el documento esté preparado me ejecutas una función en la que cuando en compra hagas clic el subtotal le añades el valor del botón y el subtotal me lo pones dentro del dip total además te digo dentro de esa función que me pongas dentro de subtotal El html del valor subtotal y además te digo que cuando me hagas clic sobre el botón calcular tales me ejecutas una función en la que el IVA es igual a su total por 0,21 dentro del DIF iba me pones el IVA y dentro del total me pones el tutorial masiva está súper claro vale está súper claro evidentemente cuando sabes lo que estás escribiendo cuando ya tienes bastante experiencia con el código y te lo puedes poner porque fijaos que os acordáis los errores que cometéis de paréntesis llave punto y coma y tal fijaos como acaba esto acaba paréntesis llave paréntesis punto y coma llave paréntesis si yo me equivoco meterme ahí Y averiguar cuál de ellos está mal es un suicidio por eso os digo empezamos trabajando creando código desarrollado cuando los programas crezcan en complejidad y cuando nuestros conocimientos crezcan en destreza lo que haremos es progresivamente ir escribiendo código comprimido lo primero que quiero hacer en la clase de hoy voy a crear una nueva ventana y voy a abrir el editor headit es explicaros para qué sirven las matrices probablemente Vais a entender Qué son las matrices Aunque quizás no tengáis muy claro exactamente Cuál va a ser su papel dentro de nuestros videojuegos y su papel va a ser absolutamente imprescindible por tanto voy a crear en este caso una carpeta nueva llamada plataformas donde una vez más dentro de esta carpeta plataformas voy a crear un archivo index.html y ya que estamos ya que nos ponemos Será muy común a partir de hoy Y a partir de Hace unos días vamos a estar trabajando en todo momento con jquery por tanto una vez más creo la carpeta plataformas añado el archivo jquery.js abro el archivo index.html y continúo continuo empiezo veis que siempre me dejo el doc type esa mala costumbre que tengo y creo un Body creo un Head y dentro del Head una vez más Script de type texto barra javascript cierro el Script copia y pego porque no este pero al primero eso sí le voy a decir que sus shorts que su fuente es igual a jquery.js para qué nos sirve una matriz Yo suelo comparar las matrices con armarios hasta ahora hemos trabajado con variables las variables son contenedores de información son cajones donde podemos introducir algo de información si os fijáis un armario es una unidad superior de ordenación de cajones es un mueble que puede contener muchos cajones que puede contener varios cajones por tanto voy a hacer lo siguiente javascript no es el lenguaje que a mí más me gusta para trabajar con matrices php me gusta bastante más para eso y Java también pero el caso es que hay que hacer matrices en javascript Así que voy a hacer lo siguiente bar agenda siempre Empiezo con una agenda para explicar matrices es igual que curioso si parece que voy a hacer una variable es igual a New a Ray con esto lo que le acabo de decir es que sí agenda parece una variable empieza con bar pero no va a ser una variable va a ser una nueva matriz array es matriz Y ahora yo digo atención agenda pongo corchetes no son llaves ya son corchetes tampoco son paréntesis son corchetes recordad que los corchetes se pulsan con adgr y están justo arriba de las llaves agenda con la posición 0 es igual a José Vicente ella entre comillas agenda con la posición 1 es igual a Juan agenda con la posición 2 es igual a Jaime qué estoy haciendo por tanto una matriz realmente podríamos decir que es como una súper variable es una variable que admite varias posiciones de memoria vamos a trabajar de momento con matrices unidimensionales Esta es una matriz unidimensional más adelante trabajaremos probablemente con matrices multidimensionales bidimensionales o superiores Qué pasa si yo guardo y recargo esto en el navegador evidentemente No pasa nada al igual que cuando declaro una variable cuando declara una matriz e introduzco valores en absoluto estoy diciendo que quieran Mostrar esos valores en pantalla bien Ahora lo que voy a hacer es lo siguiente Mirad ya he creado una matriz voy a devolver en pantalla Su contenido document.rite atención Mirad lo que voy a hacer Qué curioso pongo agenda qué creéis que me dirá me devolverá José Vicente Juan o Jaime si yo guardo y recargo me dirá José Vicente Juan y Jaime cuando yo le digo Quiero ver la agenda le estoy diciendo que quiero ver todos los registros sin embargo si yo le digo Quiero ver la agenda pero solo el registro que está en la posición 0 el resultado en este caso es solo José Vicente cuando Quiero ver la agenda cuyo registro está en la posición 1 me saca Juan y cuando Quiero ver la agenda cuyo índice está en dos me saca Jaime Qué diferencia hay de hacer esto a hacer variables podría haber hecho tres variables la variable agenda 1 agenda 2 y agenda 3 lo divertido es que más adelante para asignar un bucle for y para poner muchos malos o muchos pájaros o muchos cerdos o muchos elementos con los que colisionar siempre que yo piense en muchos de algo las matrices me van a venir mucho mejor que declarar múltiples variables por tanto ya está Estos son las matrices no tienen mucho más tiene una estructura de control asociada que ya veremos que es la estructura Ford each pero en principio una matriz es esto es simplemente la capacidad de poder asignar múltiples huecos de memoria a una misma variable en este caso agenda voy a hacer Y de paso Vamos a trabajar también con eventos voy a hacer lo siguiente voy a crear la estructura de control clásica cuando el documento esté preparado me ejecutas la función de inicio y ya sabéis no intentéis correr la función de inicio lo que va a hacer os recuerdo que voy a seguir escribiendo en el modo extendido el modo fácil la función de inicio simplemente dirá alert funciona guardo recargo y funciona voy a hacer un dir en el que todo se ejecutará en el que se ejecutará el juego que voy a desarrollar Mirad dentro del duody creo un dip Y de igual escenario y ya que estamos antes de cerrar el Head creo una etiqueta Style donde digo aquello que es el escenario tendrá las siguientes propiedades Qué son una anchura voy a datármelo a mi pantalla una anchura de 600 píxeles una altura de 600 píxeles un Border de un píxel sólido Black y un background un fondo de color gris simplemente para que se vea vamos a verlo en la pantalla y mirar me aparece un escenario con el que voy a estar trabajando además a ver si conseguimos que el juego de hoy tenga un objetivo que será subir hasta arriba del todo para lo típico rescatar a la princesa vale os acordáis del Donkey Kong original de las maquinitas estas japonesas Vale pues algo así a continuación voy a dibujar un personaje por tanto dibujo aquí un personaje dir Y de igual personaje y mi personaje una vez más va a ser una bolita de momento aunque ya sabéis que luego siempre lo puedo cambiar con un poniendo un background o poniendo la imagen me da igual with igual a 30 píxeles igual a 30 píxeles Border igual a dos píxeles a 4 píxeles solid White Border radius de 30 píxeles background Blue y Box Shadow de 0 píxeles 10 píxeles rgb a 0,0 con punto tres o cuatro yo que sé guardo recargo a ver qué sale de aquí y tengo por ahí la bolita del personaje tanto el escenario como el personaje van a tener un position absolute para que el personaje flote por encima del escenario sin empujarlo y viceversa Así que ahora los dos coinciden en el espacio y ahora como todo esto le quiero dar una cierta un cierto enfoque de juego móvil quiero hacer una serie de controles que me permitan tres cosas que me permitan ir hacia la derecha ir hacia la izquierda y saltar por eso hago lo siguiente creo varios dips VIP y de izquierda y d derecha viva y de saltar y si queréis en el de la izquierda no sé para que lo veáis mejor pongo izquierda es para el otro lado izquierda o me lo toma como así Bueno me lo toma como un comentario a ver si hay suerte sí no tengo algún comentario Pues mira así ya está y por aquí ahora ha aparecido por alguna parte estará por ahí bajo todo eso dip derecha será esto y saltar será igual a el símbolo de la potencia que es una flechita hacia arriba no los veo pero no pasa nada porque ya sabéis que ahora los voy a estilizar izquierda tendrá vamos a ver un Quiz de 50 píxeles un hype de 50 píxeles un background de color Green un Border radios de no sé 5 píxeles y ya está a ver qué pasa aquí bien De momento no lo tengo un momento me da miedo izquierda que esto lo haya estropeado Ah no estaba por ahí bajo no sé dónde está vamos a quitar esto este bip se abre este cierra y le voy a decir que tenga un position absolute bien Ahora sí voy a ver si puedo devolver las flechas izquierdas hacia el otro lado vale sale perfectamente derecha y saltar y ahora hago lo siguiente Mirad este objeto tendrá una distancia al top tendrá un margen con respecto al top de 600 píxeles y así lo pongo ahí bajo lo pongo ahí Bajo como un botón que luego podré pulsar para realizar una acción derecha voy a crear derecha A partir de izquierda con la diferencia de que tendrá un margen led de 550 píxeles y mirar ya tengo derecha ahí que se me ha descuadrado me da igual ahora mismo Y por supuesto saltar tendrá un Wiz de 200 píxeles y tendrá una distancia de 250 vamos a verlo pues 200 Mirad tengo ahí por tanto un juego con tres controles con el control izquierda el control saltar y el control derecha Bueno vamos a hacer ahora lo siguiente atención en la pantalla el bichito de momento va a tener las siguientes propiedades función inicio personaje va a tener una posición y atención defino una variable va post es igual a 5 70 por ejemplo punto css y digo por tanto que top coma post y vamos a verlo con esto el personaje se me ha puesto aquí abajo es decir crea una variable en primer lugar llamada posi y a la que le doy el valor 570 y a continuación digo que este personaje tiene una propiedad css donde el top tiene el valor de posi y en este caso voy a hacer lo siguiente creo una nueva variable bar por x que es igual de momento a cero y digo cuando sobre izquierda haga clic en este caso ejecutaré la función llamada ir izquierda cuando sobre aquel dip que tiene el ID derecha haga clic ejecutaré ir derecha y cuando sobre el div que tiene ID saltar haga clic ejecutaré la función saltar estas tres funciones evidentemente de momento no existe por tanto si ir izquierda qué pasa y de izquierda para ir a la izquierda Entonces ahora lo que voy a hacer es función ir izquierda y creo el hueco función ir derecha y creó el hueco y función saltar y creo el hueco voy a hacer lo siguiente al personaje le añado una propiedad css donde el led En este caso estoy usando left pongo la posición x y ahora digo atención cuando ejecute la función ID izquierda diré post x menos y luego haré esto actualízame la posición del personaje en x y en y hace un cambio y ya que has hecho un cambio en la variable actualiza su posición respecto al top y respecto al left cuando atención cuando el personaje vaya hacia la derecha le diré post x más y cuando el personaje salte le diré post y menos vamos a probarlo Mirad un momentín Mirad la pantalla a ver si funciona recargo y cuando Yo muevo hacia aquí el personaje se mueve hacia la derecha cuando hago clic se mueve hacia la derecha cuando hago así el personaje se mueve hacia la izquierda y cuando le doy a saltar el personaje va hacia arriba Sí vale de momento un poco estático vale Pero el personaje va hacia arriba si no queréis que vaya de uno en uno siempre podéis hacer esto Mirad siempre podéis decirle que post x es más igual a 10 en lugar de sumar un valor Perdón esto es menos igual en lugar de sumar un valor sumo 10 de golpe más igual 10 y posición y menos igual 10 guardo y recargo a ver qué le ha pasado he cuidado un error guardo y recargo y ahora fijaos que el personaje va de 10 en 10 píxeles y salta va de 10 en 10 píxeles lo que voy a hacer ahora va a ser crear una serie de plataformas estos juegos se llaman así ya que existen una serie de Pues eso plataformas una serie de repisas en las que las cuales el personaje puede saltar en las que las cuales el personaje puede subir por tanto voy a hacer lo siguiente veréis vengo por aquí Perdón vengo por aquí y es muy importante que las repisas las plataformas las declare mediante javascript porque yo podría ir a html crear unos dips y podría ir luego a css y maquetar esos dips y en principio no necesitaría javascript para nada pero problema si las repisas y las plataformas no están en javascript en ese caso javascript no las vería y necesito que el personaje pueda interactuar con las plataformas Así que voy a hacer lo siguiente plataforma x es igual a un New a Rey para esto hemos usado los arrays soy igual a Unión a Rey antes he puesto paréntesis de acuerdo no vale pues no Es más si queréis vale para abreviar voy a poner plata x vale plataforma x bar plata y es igual a un New a Ray y esto me va a ayudar a crear varias plataformas por ejemplo ahora digo plata x es igual a no perdón x de cero es igual a no sé a 400 a ver qué tal y plata y de cero es igual Por ejemplo a 400 plata x de 1 es igual a 600 no a 500 y plata y griega de uno es igual a 500 ahora llegó lo siguiente veréis en la función de inicio Mirad voy a usar un Ford para poblar automáticamente cada uno de los elementos y digo foro bar n es igual a cero n es menor que 2 N más porque n y no y latina Pues porque no lo sé la variable que queráis ya me da igual y ahora digo y ahora viene la dificultad y ahora digo document no dentro del Body quiero a pent quiero Añadir un dip de clase plataforma a ver que haga el código más grande hundir desde plataforma cuyo estilo será top es igual y encadeno con plata y de n madre mía como está liando esto píxeles coma left es igual en cadena a plata x de n porque n está aquí dentro de la declaración del bucle for Hey no he hecho nada de css me hace largo de css voy a hacer que todo aquello ahora pongo el código para copiar todo aquello que tenga la clase plataforma tendrá un with de no sé 200 píxeles un hype de 20 píxeles y un background de Grey ya lo tenía creo pues red y un position absolute vamos a ver si sale aquí algo ahí va Mira dos plataformas cómo lo he hecho copiar el código ahora os lo cuento para ahora hacer nuevas plataformas lo único que tengo que hacer es duplicar Aquí esta matriz dos tres y decir Quiero una nueva plataforma no sé 200 300 y quiero otra en 100 200 si ahora guardo y recargo comprobaréis como ahora puedo hacer un momentín donde se me han ido las plataformas Ah claro es que el bucle for buclea hasta n es menor que 2 voy a decirle n menor que 4 Ahora sí vale Y tengo ahí diferentes plataformas o sea una vez hecho todo este rollo del bucle for ya simplemente para declarar nuevas plataformas simplemente tengo que poner su posición X e Y el programa mediante este bucle for irá rodando cada una de ellas y colocándolas en el espacio de trabajo a ver un momento esta de 100 y 200 me cuadra mucho uno dos tres y cuatro pero sí se ve que es así Ah cuidado es que cada una parece que salta encima del anterior voy a decir que la plataforma sí tenga un position absolute o pues parece que lo he hecho bien Vamos a ver 400 más claro es que estoy contando desde arriba bien plataforma y a 500 Ahora sí está funcionando Lo único es que tengo la Manía de que intento contar cero desde este punto y no pero es este punto de aquí arriba lo que quiero hacer ahora es que este personaje a medida que vaya evolucionando a través del juego de momento no vamos a trabajar con gravedad pueda colisionar Es decir que si el personaje viene por aquí no pueda pasar a través de una barrera lo que haré es resolverlo de una manera manual y luego de mostraros para que os van a beneficiar las matrices si lo hacéis de manera manual el código se extenderá una barbaridad si lo hacemos con matrices automatizaremos mucho más el resultado Así que voy a decir lo siguiente en la función de inicio crearé Perdón dentro de la función saltar crearé una condición y es la siguiente si acaso es cierto If voy a trabajar en este caso con esta plataforma creo recordar por las matrices que son 300 píxeles a ver dónde estás estas son 400 estas son 200 por 300 esta de aquí esta que tengo aquí y digo si es cierto que la posición x es menor que creo que son 200 y es cierto que la posición x es mayor que 200 más 200 que tenía la propia plataforma por tanto sería 400 y también es cierto que la posición y es menor esta matriz está puesta en 300 que 300 y también es cierto que la posición y es mayor que 320 porque creo recordar que cada plataforma tenía una grosor de un grosor de 20 píxeles en ese caso y solo en ese caso y ahora discutimos Qué quiere decir realmente esa línea en ese caso y solo en ese caso la posición y podrá disminuir si todo ha ido bien Esto querrá decir que el personaje jugador la pelota en este caso no va a poder pasar a través de esa barrera Vamos a guardar vamos a recargar Y ahora os dejo el código en pantalla para que lo podéis copiar Mirad hago así y voy a intentar pasar a través de esa Barrera bien no me está dejando pasar un mentín vale Y esto es porque esa condición está dando como cierta vamos a ver esa condición aquí Pos y aquí por y la variable es menor que 300 y mayor que en principio por si vamos a ver Pos x y por y me debería estar dejando pasar por y es menor que 200 y es cierto que es mayor que 320 pulso y no pasa nada voy a poner lo siguiente voy a poner una alert pulsado guardo recargo pulso y pulsado ahora pongo el alert dentro de la estructura de control If y la estructura de control If probablemente cuando la pulse no me dirá pulsado luego no está siendo capaz de ejecutar ese alerto lo que tengo que ver Ah claro por favor cierto que la posición es menor que 200 o es cierto en lugar de am tendré que poner hora o es cierto que la posición Es mayor que 00 y además se cumple la condición de que la posición y es menor que 300 o es cierto que la posición Es mayor que 320 evidentemente ambas no podían ser ciertas Mirad hago así intento pasar a través a ver si ahora me deja mirar o no me deja a ver ahí sí que me deja pero si me meto dentro del Rango de acción de esa plataforma no me deja hay algo todavía que me queda por programar pero veis si lo saco fuera del paraguas de esa plataforma puede subir si lo pongo dentro ya no puede subir lo que tengo que hacer trabajar con esto y ver lo siguiente el problema está en que yo ahora tendría que establecer por aquí cada línea diferente para cada uno de los coleccionadores Si tuviera por ejemplo 16 colisionadores tendría que empezar a hacer estructuras de control If cada una con sus preguntas de x y me podría morir solo con cuatro Me podría Morir con 16 ya ni te cuento Por eso voy a hacer lo siguiente si os fijáis esto es este 200 es plata x de 0 por ejemplo por tanto pongo plata x de cero y ahora digo que esto es posición Es mayor que plata x de cero más 200 ya que 200 es la anchura de esa plataforma posición y es menor que plata y con el índice 0 Y esto es plata y de cero más 20 píxeles creo que eran vamos a comprobar si funciona si todo ha ido bien Lo único que he hecho es en lugar de crear una variable estática he creado una variable a partir de matriz ya no debe colisionar con esta de aquí recordáis esta era 400 a ver no creo que es esta De aquí sí es esta de Aquí vamos a probarlo voy a poner a incrementos mayores a poner dónde estás incremento 20 20 guardo recargo Mirad algo así puedo pasar a través de esta puedo pasar a través de esa puedo pasar lo que no puedo hacer es pasar a través de esta Así que hago así Perdón ves esa y ya no puedo pasar lo veis bien Esto lo he hecho realmente Una vez más a meterlo dentro de un bucle de control Ford de una estructura de control Ford que haga lo siguiente veréis creo un Ford por aquí cierro el Ford por allá creo ahora en lugar de la variable n la variable m el nombre de la variable es lo de menos y atención digo plata cero no plata m haciendo esto metiendo todo en una estructura de control Ford y trabajando con matrices podréis comprobar como ahora funcionan todas las colisiones esta y te ha sido tío a ver Ah claro es que he pegado un salto muy grande un momento y a ver la última plata xdm bien no está funcionando ninguna bar m igual a cero lata xdm vamos a poner un momentín voy a volver al índice cero guardo recargo ahora Este funciona Ah vale ahora este no funciona o sea esto funciona qué intenté un segundo lo vuelvo a sustituir vale momentín en el foro debe estar hay una opción que en lugar de pulsar clic puedo usar H over H Uber es Mientras que el ratón esté encima de ese elemento por tanto Será algo así y cuidado que igual se me va mirar algo así hago así vale Y lo puedo subir otra cosa que puedo hacer es que vamos a ver Bueno sí Mirad en lugar de hv puedo poner Mouse move porque H over solo funciona cuando el ratón sale o entra me use cuando ratón salió entra del dip pero sin embargo este funciona Mientras que el ratón esté dentro del DIF ahora evidentemente lo que voy a hacer es pararlo en lugar de más 20 y menos 20 voy a decir más dos y menos dos y ahora hago así Mirad y puedo moverlo con más soltura y hago subo así veis ya no puedo subo así y se me va Bueno vamos a ver otra vez el problema del bucle M lo paso ahora a la matriz con índice 2 guardo y recargo vamos a ver la matriz con índice 2 que parámetros tenía era 200 por 300 Mirad subo giro a la derecha subo y no me deja subo y no me deja y lo que tengo que hacer ahora evidentemente es ver por qué la m no funciona Aunque imagino porque me imagino que pasa lo siguiente si hago esto si yo pongo otra estructura de control Ford plata 0 y 0 vamos a ver cuál es el resultado bien vale una anula a la otra con lo cual Me tocará hacer lo siguiente Me tocará meterlo dime Sí a ver voy a replantear esto y voy a decir lo siguiente si post x Es mayor que plata x de 0 o bien post x Perdón es sin mayor cierto o bien Pos x es menor que plata x de cero más 200 píxeles que tiene de ancho la barra y además es cierto que Pos y voy a introducir esto dentro de un súper paréntesis cierto cierto y es cierto que posi y es mayor que plata y de cero no ahora es menor que plata y de cero más 20 que lo voy a poner dentro de un paréntesis en ese caso no pasa nada no sí se puede dejar vacío Else menos igual 20 a ver qué pasa ahora que Yolanda está mirando como creo que era este de arriba takatada ahí vale de momento funciona ahora la prueba de fuego con dos is que luego voy a hacer el bucle solo voy a meter dentro del bucle de momento lo estoy haciendo estático dos no tengo dos no que no Esta es una estructura de control y con su elche Y esta es otra estructura de control y consuels no hay dos els en una misma estructura están separados eso sería el pero es que en este caso como lo voy a hacer al final dentro del horno puedo meter eso no puedo meter el shift Aunque existe sí existe hago así vale se me ha ido hago así ojo Es que los de antes eran menos dos y esto es menos 20 cuarto recargo vale voy a hacer una vez más una carpeta en este caso se va a llamar Canvas y una cosa os voy a decir Canvas es un nuevo estándar para dibujar en 2D y en 3D también usando html5 y sobre todo javascript y lo que os voy a decir es que Canvas en ningún momento implica a jquery en ningún momento según el estándar jquery es obligatorio para trabajar con canvas pero sin embargo Pese a que no está en el estándar trabajar con jquery dentro de Canvas es completamente necesario y os voy a explicar por qué voy a copiar esto de por ejemplo carrito voy a copiar jquery dentro de la carpeta Canvas y voy a crear un documento index.html lanzo aquí y empiezo a escribir código Mirad html un Head un Body y meto las mismas etiquetas de siempre los scripts type texto barra javascript Script lo cierro y ahora a continuación voy a copiar y pegar para decir que el source para decir que la Fuente es jquery.js el problema es el siguiente Mira todos o la pantalla yo aquí pongo mi código y ahora Vengo al Body y pongo una etiqueta mágica llamada Canvas y digo Canvas Style Border un Pixel sólido negro a ver qué sale Mirad y el Canvas sale así Canvas si queréis no es una etiqueta longaniza no es una de las etiquetas que puedes cambiar como te doy la gana no Canvas es muy particular cuando quieras dibujar tienes que hacerlo con Canvas el problema es el siguiente Mirad Yo vengo y aquí ejecuto el código javascript que va a controlar lo que hace Canvas El problema es que si ejecuto este código y no existe Canvas se ejecuta un código que dice ves al Lienzo y Pinta y el Lienzo todavía no existe no pintará nada si luego llega este código y pinta el Canvas a demasiado tarde tú Imagínate que vas a una tienda a pintar un Lienzo y el Lienzo no existe porque lo traerán mañana tú vas a la tienda y vas con la intención de pintar Pero te vas de la tienda porque no había Lienzo en el que pintar te vas de la tienda y mañana traen el Lienzo problema eso ya es mañana y mañana yo no sé por dónde estoy vale por tanto el problema es que si lo hacemos así no funciona porque tiene que existir primero el Lienzo en el que tienes que pintar y luego empezar a pintar Por eso digo que aunque en principio no es parte del estándar jquery es muy necesario para trabajar con Canvas en html5 Por qué Porque con jquery recordad que con la función ready nos aseguramos de que el código javascript no se ejecuta hasta que no se ha acabado de cargar todo el contenido html es decir no voy a pintar hasta que no me asegure que hay cargado un Lienzo Así que una vez más digo cuando el documento esté preparado en ese caso ejecuto inicio y la función de inicio de momento como siempre una vez más va a hacer alert Hola alerta Hola guardo recargo ahí lo tengo y a continuación lo que tengo que hacer por tanto dentro de la función de inicio es empezar a pintar lo que voy a hacer por tanto a continuación en primer lugar va a ser decir Hey Canvas te voy a pintar a continuación diré Y además te voy a pintar en 2D y una vez haya dicho eso ya podré empezar a aplicar operaciones voy a sacarme un poco La Chuleta y voy a trabajar con cualquier proyecto donde haya hecho Canvas vamos a ver voy por ejemplo a este proyecto 1 2 3 y voy a poner el siguiente código Mirad rojo verde contador segundo que lo tengo por aquí está lo primero que voy a hacer es esto pongo este código en el cual creo una variable que llamo Canvas y lo que voy a hacer en este caso es poneros en castellano aquello que se pueda cambiar Lienzo y dejar en inglés aquello que no se pueda cambiar en este caso estoy seleccionando un objeto mediante su ID que es mi Lienzo mi Canvas no tiene ID por tanto tengo que ponerle un ID que coincida con el ID que he puesto arriba qué estoy diciendo pues que esta variable Lienzo equivale a el elemento cuyo ID es mi Lienzo que curiosamente es la etiqueta Canvas a continuación creo otra variable llamada contexto donde contexto es igual a Lienzo punto get context donde el contexto que vamos a usar es de momento un contexto 2D y a continuación vamos a empezar a dibujar es decir tal y como os decía en los primeros dos pasos primero he dicho dónde voy a dibujar segundo he dicho que voy a dibujar en 2D podría dibujar en 3D y a continuación escribo lo siguiente contexto punto Beijing dentro del contexto voy a empezar a dibujar una línea un recorrido Canvas tiene multitud de formas geométricas no hay muchas Eso sí pero hay unas cuantas básicas que nos pueden venir bastante bien La primera de ellas es el rectángulo por tanto pongo contexto punto red el rectángulo va a tener los siguientes parámetros en primer lugar el punto de inicio en X en y voy a poner 10,10 a continuación la anchura y la altura 30,30 es un cuadrado Efectivamente es un rectángulo que sirve para hacer rectángulos y también en cuadrados de qué color Voy a pintar este rectángulo No lo sé todavía por tanto voy a poner contexto punto film Style y lo voy a pintar de color rojo Ah perdón Phil Style no va entre no es un objeto y por tanto no va entre paréntesis sino que es igual a comillas y el color que queráis voy a poner red rojo ya sabéis que siempre se escribo algo en inglés es que tiene que escribirse así y lo escribo en castellano es que lo podéis cambiar Y por último contexto punto film para decir todo aquello que haya dibujado lo quiero rellenar si todo ha ido bien que con Canvas nunca se sabe si todo ha ido bien debería tener ya en la pantalla un rectángulo de color rojo que empieza en 10,10 y llega a 30,30 os voy a pasar una cosa que me voy a sacar de internet dejamos las células volvemos al cuadrado rojo vale poco a poco una cosa que me voy a sacar de internet y que os recomiendo que os imprimáis y que os lo pagáis a seguir bien grande en la pared si queréis lo imprimo y lo pongo por aquí por la pared porque lo vamos a estar usando el resto del máster que es html5 Canvas chip la hoja de trucos la hoja de trampas de html5 Canvas es una hoja súper guay que una hoja resume gran parte de lo que tiene Canvas png file todo lo que tiene Canvas resumido evidentemente está dentro de esta hoja por eso lo que voy a hacer es que me la voy a guardar en primer lugar Y en segundo lugar os la ahora os la suba al dropbox para que la tengáis y que para que lo podéis Descargar bueno esta hoja me la ha descargado porque voy a hacer trampa vale tenemos el método begging Bad bien Este lo hemos visto tenemos el método film el de stroke que ahora luego me servirá para dibujar líneas Y tal Pero ahora lo que quiero es dibujar formas geométricas tengo el rectángulo eh mirar el rectángulo ya lo he visto es x y anchura y altura Pues voy a hacer lo siguiente voy a enseñaros el método arco me sirve para dibujar círculos y también para dibujar Trozos de círculos por cierto decíais que nos gustaban los radianes pues vamos a volver a trabajar con radianes Así que Mirad voy a escribir lo siguiente contexto punto Beijing pa voy a empezar un nuevo una nueva forma un nuevo recorrido con texto punto arc ya no rec ya no es un rectángulo ahora es un arco y este arco va a hacer lo siguiente el arco tiene los siguientes parámetros primero la X La y donde empieza voy a poner por ejemplo 50,50 a continuación el radio voy a poner por ejemplo 20 píxeles a continuación el ángulo de inicio y el ángulo de final expresados en radianes por eso si quiero una vuelta completa diré que el principio está en cero y el final está en paréntesis más punto pi por dos radianes dos por pi Perdón dos por pi radianes Y por último diré si esto va a favor del reloj o a contrarreloj esto se pone con una variable false por tanto voy a poner true ahora por último digo contexto punto film creo que no me hace falta en este caso poner el color ya que voy a heredar el color anterior el color rojo Así que guardo recargo y tengo esto y tengo un círculo que empieza en 50 con radio 20 y que va desde cero hasta más punto pi una cosa que voy a hacer mirar voy a poner lo siguiente hasta 1.5 por pi que voy a hacer en este caso lo que voy a hacer es un cuarto de círculo si yo le pongo false lo que hace son tres cuartos de círculo lo veis si va a favor del reloj o si va contra el reloj vemos por tanto por cierto que con el arco del Canvas el arco empieza por aquí y va por aquí porque ya no sé por dónde va por aquí porque si yo le pongo 0.5 baja hasta abajo empieza por arriba 0.5 son 90 grados llega hasta aquí luego le pongo uno y Son 180 grados 1.5 son 270 grados y por último si le pongo dos llego a 360 grados lo que voy a hacer en este caso es traer a esta carpeta el Angry Bird y vamos a ver cómo no ya podemos poner rectángulos círculos sino que también podemos poner imágenes aquí dentro y ahora voy y digo me saco de javascript angry.png A ver Mira la pantalla angry.png me lo pongo dentro de Canvas y ahora digo lo siguiente no os disgustéis si no sale atención Mirad me voy al chip dónde estás a fecha será que lo he abierto aquí mira vamos a ver beatmap dónde estás Pixel manipulation Cri Mira no te preocupes saco chuleta y lo flipas voy a ir a jugar a arkanoid porque en arkanoid tenía por aquí salud vamos a ver versión 0.5 y me voy a index.html así ya me acuerdo la poner baldosas vale Mirad ya lo tengo vale creo por aquí bar imagen es igual a New y mageige ahora sí que crea Aquí un objeto fíjate siempre que veas la palabra New por el medio estás creando ahí una nueva instancia del objeto vamos a por ello sigo imagen punto src es igual a angry.png primero que hago una imagen y digo la fuente de la imagen es angry.png Y por último digo contexto punto draw image y hago lo siguiente imagen coma no sé 100,100 esto es voy a crear una imagen la fuente de la imagen es angry.png Y por último dibuja en el contexto la imagen en 100,100 Aunque lo haya escrito bien atención Mira la pantalla y no os preocupéis Aunque lo haya escrito bien es posible que no funcione por qué yo voy ejecutando por aquí html se ha cargado pero la imagen puede tardar un poquito en cargar como la imagen tarda un poquito en cargar para cuando ejecuto esto la imagen no se ha cargado y como no se ha cargado a se siente no está ahí dentro cómo lo soluciono es muy sencillo Canvas prácticamente os va a obligar a trabajar dentro de bucles sin fin es decir a usar Time out Vais a ver como ejecuto el Canvas con imagen lo ejecuto y no funciona no sé si he cometido algún error pero creo que no funciona pero si de repente digo Oye inicio no pases si no pasa y vuelve a pasar y vuelve a pasar y vuelve a pasar a la segunda tercera que pasa dice ay Espera que ya cargó la imagen pum y te la pone en pantalla vamos a verlo set Time out inicio lo ejecuto en 500 en medio segundo vamos a probar a ver qué pasa si lo veo correctamente recargo Ah ahí está la gripe a que sí Mirad atención le doy aquí a recargar pum y pum aparece habéis visto cómo ha aparecido medio segundo después de que recargue Por qué Porque a la segunda vez que ha pasado a cómo Entonces ya lo había cargado memoria Entonces lo pone en la pantalla al rato observo que de alguna manera se distorsiona la imagen empiezan a aparecer unos puntos y si os fijáis el contorno es un poco más grueso Por qué es muy sencillo yo me he metido en un bucle infinito y cuando me meto en un bucle infinito lo que estoy haciendo es dibujar cada vez un pájaro encima del Pájaro anterior estoy poniendo muchos pájaros uno encima de otro y llega un momento que si este píxel igual tenía un 1% de transparencia pero meto 100 pájaros encima el píxel tiene un 100% de opacidad por eso lo que voy a hacer es usar una función bastante divertida la voy a poner al final para fallar adrede llamada Clear rect Clear rec lo que hace es borrar la pantalla es decir antes de crear un nuevo fotograma borro hago Clear rec de hecho hago Perdón contexto punto clea red que tiene cuatro parámetros es como un rectángulo 0,0,800,800 Quiero dibujar un rectángulo que borre Fíjate lo que ha pasado con el círculo por cierto Quiero dibujar un rectángulo que borre desde 0,0 hasta 800 como a 800 guardo recargo Guau qué ha pasado lo he puesto mal adrede lo que he hecho Mirad atención es crear un rectángulo que al final del todo borra evidentemente Ahí está mal lo que tengo que hacer es poner el rectángulo que borra al principio del todo Qué hace ahora el rectángulo que borra coge lo que habías dibujado antes en Canvas y lo borra antes de que dibujes cosas nuevas guardo recargo y ahora veréis como puede pasar el tiempo que queráis y el pájaro ni el círculo se van a corromper por qué porque aunque no notéis Y la gracia de Canvas es que funciona tan rápido que no se nota cada vez que está recargando está borrando lo anterior y dibujando cosas nuevas borrando dibujando voy a hacer lo siguiente voy a demostraros como si no es con el Clear red el objeto va dejando Estela digo bar post x es igual a cero y ahora aquí digo dibújame la imagen en Post x y antes de acabar post x más si yo no pongo el Clear rec voy a comentar el clearrect guardo recargo Mirad y pasa esto Ahí va dejando Estela por esa razón necesitamos el Clear rec si yo ahora bajo esto a 50 milisegundos sale esto es más permitirme decir aquí que va post y es igual a 100 y ahora digo pues x Pos y hacer una cosa por y es igual a y más un factor aleatorio más punto random por 5 por ejemplo y ahora aquí pongo posey guardo recargo a ver lo que pasa ahora bien Random va con paréntesis Uy que sea menos 5 voy a poner por seis menos tres que será eso son animación en Canvas de hecho lo más divertido Es que le puedo decir que el Time out sea a cero para que vaya todo lo rápido que pueda y veréis como siempre va a ir mucho más fluido que con dips incluso y ahora vuelvo a activar el Clear rect incluso borrando cada fotograma la magia está en que no Vais a notar el efecto vale está borrando cada fotogramas esperaríamos ver un cierto parpadeo pero no lo vemos porque Canvas ejecuta la operación tan rápido que nos engaña Al ojo en la clase de hoy lo que vamos a hacer es crear una aplicación en la que estaremos tratando una imagen por tanto voy a ir a mi carpeta una vez más ya sabéis no es obligatorio pero es muy recomendable que trabajemos con jquery por tanto voy a crear una carpeta llamada fotogram en lugar de Instagram va a ser fotograma y voy a copiar jquery a esa carpeta creo el archivo index.hml y lo muevo tanto a el editor como al navegador y digo html body en la cabeza vamos a meter un Script y una segunda etiqueta donde estaremos desarrollando nuestro código el shorts la Fuente va a ser jquery.js Este es mi código como siempre la segunda etiqueta javascript es la que nos va a ayudar a escribir y ahora ya sabéis cuando el documento esté preparado ejecutaré la función de inicio y la función de inicio hará lo siguiente mira d la función de inicio va a dibujar en este Canvas que atención voy a crear dentro de el body Canvas con el ID igual a mi Canvas donde el estilo será Border un píxel solid black vamos a ver que sale de aquí y si todo va bien sale esto sale una un rectángulo negro que tiene un Canvas vacío en el que ahora evidentemente voy a empezar a dibujar Dentro de este Canvas lo que voy a hacer es cargar una imagen y ahora para empezar a trabajar para saber si todo nos sale bien o nos sale mal lo que quiero es generar una imagen roja es decir o roja o azul o verde me da igual por una imagen de un color sólido por eso lo que voy a hacer es abrir ese maravilloso programa de Windows llamado El Paint Mirad Este es el paint de Windows 7 voy a usar el cubo de relleno Pero antes de eso un momentín inicio Bueno ahora cambiaré la proporción vale cojo el color rojo no quiero pinceles quiero rellenar Quiero el cubo de pintura Mirad el cubo de pintura está aquí arriba cojo el color rojo o un color no sé el color que queráis si cogéis el rojo mejor y simplemente relleno hago clic recordad que el color rojo está aquí dentro el bote de pintura Perdón está aquí dentro hago un clic y relleno Y por último esa imagen lo que voy a hacer es archivo guardar como y me la voy a guardar como png está fenomenal así que en el escritorio en José Vicente en fotogram me la guardo ahí como por ejemplo rojo punto png es una imagen de colorjo que a continuación voy a introducir dentro de Canvas como hoy estoy en modo vago lo que voy a hacer para reutilizar código es la manera más primitiva de reutilizar código que consiste en abrir un archivo anterior que tenga el código que me interesa y copiar y pegar por eso lo que voy a hacer en este caso es archivo voy a abrir el Index que estábamos trabajando ayer y voy a copiar Mirad estas líneas bar imagen vamos aquí está atención bien en principio voy a crear esta línea donde digo bar Lienzo primero voy a dibujar en el Canvas antes de empezar a pegar imágenes bar Lienzo es igual a document punto get Element de mi Lienzo Eh mi Lienzo cuidado hoy se llama mi Canvas Así que si hace falta lo cambiamos recordad que todo aquello que esté en inglés se tiene que quedar así todo aquello que estoy en castellano por lo de mí vale se tiene que quedar se puede poner De cualquier manera pero evidentemente si aquí pones mi Canvas quiere decir que aquí arriba tiene que poner mi Canvas vale bueno con esto ya hemos seleccionado un Canvas para poder empezar a trabajar ahora yo digo voy a volver a copiar no está aquí y ahora digo con texto bar con texto es igual al Lienzo punto get context en 2D esto quiere decir he dicho que voy a dibujar en el Lienzo Pero cómo voy a dibujar pedazo bostezo cómo voy a dibujar en 2D o en 3D voy a dibujar en 2D por tanto a partir de ahora el que manda entre comillas es el contexto Ahora sí Ahora que hemos inicializado el contexto ahora que hemos inicializado el Canvas está aquí lo que voy a hacer ahora sí es aprovechar estas tres líneas de código que os voy a pegar aquí que hacen lo siguiente bar imagen es igual a una nueva instancia del objeto image de javascript fijaos que imagen lleva n porque es una variable que yo he creado pero image no lleva n porque es el nombre de la función imagen punto src es igual a rojo punto png ya no es Angry punto png sino que es rojo punto png Y por último voy a poner lo siguiente contexto punto drow emails la imagen la pinto en por ejemplo 0 y 0 haciendo esto en principio podríamos pensar que ya he podido pintar el archivo en la pantalla sin embargo parece que no es así por qué Por último recordamos que era muy conveniente poner un set Time out donde bucleará la ejecución de la función por ejemplo en este caso inicio Durante cada segundo ya sabéis que el problema de que tiene Canvas con las imágenes no las carga de entrada lo que hago Sí puede pasar que sí pero igual refresca si de repente no decías a ver entonces ahora recargo y si no la carga a la primera en un segundo la carga a veces puede pasar que si esa imagen por lo que sea ocupa poco o tu navegador es más rápido de la cuenta lo que sea puede igual la carga a la primera Pero puede que no vale por tanto y lo peor esa ese mismo archivo igual ahí lo carga la primera igual en otro no lo carga igual en otro Sí no te puedes fiar vale por tanto Ponle un bucle y sabes que sí o sí si no lo carga la primera Entonces lo carga a la segunda una cosa que no me gusta mucho de Canvas y de todas formas se puede solucionar con javascript pero es que acepta muy mal las propiedades with y hype mediante css No me preguntes por qué pero las acepta muy mal probarlo y lo veréis Por tanto la manera de cambiar la anchura y la altura de ese Canvas no sería a través de css sino que tenemos dos opciones o bien lo hacemos estáticamente a través de html o bien lo hacemos dinámicamente a través de javascript una manera más sencilla sería poner por ejemplo with es igual a no sé 400 píxeles si lo ponemos entre comillas mejor que mejor y hype es igual a 400 píxeles guardo recargo Y esa Aunque es la manera más arcaica digamos que son estilos html pero es la manera más segura de que funcione probadlo en css Y veréis cómo os da problemas con el estado de la imagen es la manera más segura de que funcione correctamente quiero sacar esto de un bucle infinito por eso lo que voy a hacer es lo siguiente Mira función pinta y dentro de función pinta voy a poner todo esto aquí no sé voy a ponerlo aquí un Pinta y digo me ejecutas pinta en un segundo a ver si funciona un momentín guardo recargo y en un segundo no vale pinta en 1000 probablemente porque necesitaré poner todo esto así Oh vaya Qué problema A ver Mira una cosa vamos a hablar de variables locales y variables globales lo que en programación no solo en javascript se conoce como el ámbito de las variables el problema en este caso es el siguiente yo he puesto aquí imagen es igual a nueva imagen imágenes color rojo y me dibujas una imagen pero no funciona por qué resulta que una variable solo es visible si la declaras desde dentro de una función por tanto yo aquí he declarado unas variables Pero estas variables están dentro de esta función si yo salgo de esta función y ejecuto pinta no es capaz de ver las variables definidas en la función de inicio por tanto lo que puedo hacer es meterlo todo vamos a ver si así me va un poco mejor meter todo el código de pinta dentro de la función Pinta y así Ahora sí Mirad lo que he hecho básicamente es meter todo el código dentro de la función pinta tanto el Lienzo como el contexto como la imagen como la fuente y dejar solo el inicio el set Time out pinta qué hace 60 y Mouth para qué he puesto un set Time out de un segundo Para dejarle respirar para decirle Oye tienes un segundo para cargar la imagen en memoria y yo creo que un segundo es bastante como para cargar una imagen que es de 640 por 480 de color rojo así le doy tiempo y me aseguro que dentro de un segundo si os iba a cargar la imagen pero no quiero que entren un bucle por tanto le doy ventaja pero no entro en un bucle a continuación voy a demostraros cómo funcionan las matrices de colores dentro de Canvas y para ello voy a hacer lo siguiente voy a sacar Por una parte voy a sacar el html5 Canvas chip y voy a mostraros en png voy a mostraros que hay Hola Voy a mostraros que hay por aquí un par de métodos llamados get color y set color vamos a ver aquí está emails Data y put emails Data cuidado además con get image Data porque get email Data tiene la posición en x la posición en y la anchura y la altura que hace que emails Data lo primero que hace es la un rectángulo digamos y luego tomar la matriz de píxeles contenida de la manera que os he dicho antes en gusanillo digamos en líneas de esa matriz por eso un momentín dejadme que me saque un programa lo tendré por aquí no lo tengo en el dropbox lo que voy a hacer es copiaros y pegarlos hasta digo que tengo otro ejercicio anterior y decir lo siguiente de hecho un momentín a ver si el código de Ema el código de Index normal está más simplificado y aquí está Vale Voy a hacer lo siguiente en primer lugar me creo una variable que es datos imagen vale para ponerlo en castellano y que sepáis que es cada cosa context o contexto en este caso porque estamos usando la variable de contexto punto get email Data desde cero hasta y 0,0 hasta canvas.wift Canvas punto hype evidentemente canvas.wift es la anchura en la altura del Canvas podría poner 400 y 400 Es más si queréis para no liaros con métodos y propiedades extrañas pongo desde cero coma cero hasta 400,400 diréis Oye nos habías dicho que aquí no había x ni griega no es que esto no es todavía la selección de color esto es simplemente pilla los colores que hay Dentro de este rectángulo y el rectángulo es en este caso toda la imagen a ver un segundo permitirme Vale ahora voy a hacer lo siguiente bar Data bar datos para ponerlos para ponerlo en castellano es igual a datos imagen punto Data qué he hecho aquí he pillado un rectángulo dentro de la imagen de hecho he pillado toda la imagen Aquí he dicho que los datos de ese rectángulo los meto en una variable llamada datos Y ahora sí viene el momento el final apoteósico en el que hago lo siguiente Aquí está hoy qué bonito Vamos allá quiero que me alertes de datos punto o con el índice 0 Porque recordad que como os digo datos se ha convertido en este caso una matriz pregunto así a Ojo cuál diréis que es el valor de datos la matriz en su índice 0 vamos a probar yo creo que es 255 si ahora guardo y rico veré como en un segundo me sacará una alert vamos a ver o no y a ver algo escrito mal por aquí bar datos de hecho el alert no me está sacando nada Hola lo cual quiere decir que en algún momento aquí escrito algo mal bien contexto punto get emails Data de 00400 400 voy a quitar aquí unos cuantos espacios puestos sí Y qué te dice pero te dice o qué raro vale vamos a ver pero tienes una imagen roja De qué color es tu imagen sí no vale Dale Okay es blanca vale No te preocupes vale eso me cuadra mucho más porque antes ya no sé el canva no os preocupes un segundindín que tengo aquí algún error A ver es porque el rojo de el rojo del Paint no es rojo sí no es rojo puro pero a ver un momentín contexto datos imagen Data No pasa nada un momentín dejadme poner por ahí Bueno tú estás con el firefox Roberto Hola bien Vamos a ver bien lo voy a probar a firefox a petición de Roberto que efectivamente ha visto que firefox está ejecutando bien y en este caso el subíndice 0 de la matriz me dice 237 porque efectivamente el color que he cogido en Paint no era exactamente rojo era casi rojo ahora yo os pregunto qué pensáis que pasará si pongo datos con su índice en uno pues saldrá si no un valor de cero un valor cercano a cero 28 Qué pasará si pongo dos que saldrá un valor probablemente cercano a cero y era lo más interesante Qué pasa si pongo datos 3 que saldrá no creo que sea de 255 Sí porque en css la opacidad va de 0 a 1 pero en color normal Digamos como en Photoshop Alfa va de 0 a 255 como el píxeles opaco la opacidad es 255 lo que os quiero demostrar con esto por tanto es que el programa al final trabaja con grupos de cuatro elementos dentro de la matriz donde el elemento número 0 ha sido el color rojo era mucho el segundo elemento era el componente verde para este rojo ha sido muy poco el tercer elemento era el componente azul para este rojo ha sido muy poco y el cuarto elemento era el componente Alfa sigo con la demostración para que lo veáis si ahora le digo que quiero averiguar datos cuatro lo que perdón sí lo que hará es decirme 237 otra vez porque datos 4 equivale a la componente roja del segundo Pixel si yo le digo que quiero que me devuelva datos 5 30 y pico veintipico 28 porque corresponde a la componente verde del segundo Pixel de la primera hilera yo le digo datos 6 me dará también un valor relativamente bajo 36 mientras que por último si pongo datos 7 me devolverá 255 que equivale al Alfa del segundo Pixel de la primera hilera y de esta manera tan cruel se trabajan los píxeles dentro de Canvas es decir a grupos de cuatro empezando a tirar píxeles en hileras lo que quiero hacer ahora es poner el siguiente método que es el put image Data comput emails Data lo que voy a hacer es lo contrario lo que voy a hacer es poner información dentro del Pixel voy a hacer lo siguiente por tanto voy a comentar esta alert de momento Esto me ha servido para saber pero saber en principio no me da nada me va a dar la opción de poner imagen vamos a ver y aquí está dónde estás el put Aquí está mira vamos a ver pam pam muy bien por último voy a hacer lo siguiente esto es un bucle creo recordar Ah no no vale Aquí está muy bien por último voy a hacer lo siguiente bar a es igual a cero a es menor que por ejemplo 100 a más atención y digo datos de a es igual a por ejemplo qué estoy haciendo pues datos de cero es igual a 155 datos de uno es igual a 155 datos de dos es igual a 155 todo es igual a 155 y una imagen que es rojo 155 verde 155 azul 155 Qué es gris y si encima del Alfa es 155 Qué es gris transparente gris a mitad de transparencia muy bien contexto put email Data y digo que meto datos imagen a ver qué pasa madre mía Qué nervios guardo recargo y en un segundo a ver qué sale vale de momento tengo esto con texto punto get emails Data momentín que me debe faltar algo por aquí porque en datos imagen datos Porque quiero Ahí es meter putimes de un momentín sí lo he dicho Ah vale los espacios pero desde lo he copiado venía con espacios No pasa nada de todas formas un segundo dejadme que revise y me trata datos imagen hay algo que no datos a es igual a 155 Ah míralo por favor es que no digo que estoy tonto pero digo que me hacen falta gafas Porque si yo me acerco me daré cuenta como en la primera hilera allá hasta donde ha llegado la matriz que ha llegado a 100 vale voy a poner ahora 1000 A ver si llega un poquito más lejos y sobre todo con esta matriz de 1000 quiero empezar a demostraros igual no llegó todavía atención a la pantalla Mirad Ahí está vaya no he cargado la imagen roja ahora veis la primera hilera si no la veis pongo 10.000 y sobre todo lo que quiero demostraros atención a la pantalla mirada ahora es que cuando ha acabado con una línea ha empezado con la siguiente ha ido hileras y Oye en un punto dado pues ahí se ha quedado es decir esta es la demostración de que al final con Canvas no se funciona con O sea no se funciona con x e y sino que se funciona mediante hileras y trabajar con hileras tela vamos a hacer unas cuantas funciones para que veáis cómo se puede trabajar con gamas las primeras van a ser sencillas pero las siguientes no lo van a ser tanto veréis una cosa que os quiero decir es que una cosa que vamos a programar hoy hemos estamos programando una especie de Instagram Pero oye porque no podemos programar un Photoshop en Canvas podemos programar algo que ponga contraste que ponga brillo que haga negativo que aplique filtros a imágenes igual programáis el siguiente Photoshop vale hecho en web Sí ya sé que hay uno pero por animar en fin mira ahora voy a hacer lo siguiente y ahora un momentín porque ahora me decís una actriz o va cojo los pingüinos venga yo que sé pingüinos siempre son socorridos y voy a hacer una cosa vosotros me diréis realmente para que le has preguntado al programa el color que tenía el color rojo si luego has hecho lo que te ha dado la gana si luego le has puesto un gris y le has puesto gris porque has querido muy bien voy a hacer lo siguiente voy a invertir esta imagen para invertir esta imagen lo que haré es lo siguiente datos a es igual A 255 menos datos a eso parece que no pero coge cada canal y lo invierte claro tengo un problema y es que el problema que tengo es que el alfa también me lo va a invertir Oh qué mal claro el alfa 255 menos 255 0 por tanto evidentemente no voy a ver nada en esta imagen invertida Porque yo os prometo que hay dentro hay un color cian porque el complementario del rojo es el cian pero como es transparente no lo puedo ver vaya Qué puedo hacer para esto pues Mirad en este archivo tengo un truco que me he inventado yo y este truco lo que hace es dentro de ese bucle for está por aquí poner otro bucle for aquí está Data y +1 Data y más lo que sea atención mira lo bueno del bucle for hasta ahora no lo hemos usado lo bueno del bucle for es que no tiene por qué subir de uno en uno puede subir de tantos en tantos le voy a decir que a es igual a aa más 4 es decir sube de 4 en 4 vale atención Mira la pantalla lo voy a hacer y ahora si queréis lo copiáis lo explico por si alguien no lo entiende o lo que es lo mismo a más igual 4 por si queréis ponerlo el operador resumido ya os digo lo siguiente datos de a es igual a 255 menos a y yo os Pongo aquí La Chuleta y Digo por si no lo sabéis esto es rojo datos de a+1 es igual a datos de a+1 que es verde Qué curioso datos a + 2 es igual a datos a + 2 vaya ahí y este es azul y el azul y evidentemente datos vaya había copiado atención datos a+3 es igual a datos a más O sea datos a+3 es decir lo dejo como estaba si queréis ahí estoy desperdiciando memoria en favor de la claridad Por qué Porque De qué me sirve decir que una cosa es igual a lo que era para eso no lo toco ya está Vale Pero simplemente por Claridad ahora a nivel docente lo pongo qué hago guardo recargo Y si todo va bien vamos a ver ahora si todo va bien en esa matriz ahora sí que hoy vamos a usar forgets porque ahora no tenemos más remedio que usar forex porque aquí lo podríamos hacer Confort pero tela lo que nos tenemos que poner a calcular veis como ahí arriba se está volviendo de color cian el complementario el negativo voy a poner que la matriz acabe en 100.000 que igual le tengo que dar dos o tres segundos para que procese la imagen ahí la veis Oye no lo veis bien Vamos a por los pingüinos en lugar de cargar la imagen Roja era para demostrarnos lo de los colores para demostraros Como cada color contiene lo que yo os decía que contenía y ahora voy a hacer lo siguiente mirada la pantalla y ahora os pongo el código me voy a José Vicente me voy a no me voy a escritorio y me voy a mis imágenes y me voy a pingüinos me gustan mucho entonces me voy a mi carpeta me voy a fotogram y además al lado de rojo punto png tengo penguince punto png jpg Perdón Mirad a la pantalla lo pongo en lugar del rojo ejecuto si tarda Quizás es porque me hace falta darle más respiro para que cargue la imagen por tanto le doy 3 segundos a ver si ahora y ahí lo tengo ahí va Qué guay no sé si lo veis pero me lo está convirtiendo a negativo el cian el color celeste me lo está convirtiendo a crema Oye no lo veis pues elevo la matriz a un millón de valores Esto no es muy cómodo ahora hablaremos del forich y del foreim y ahora veréis Cómo podemos hacer que la matriz O sea que el bucle de control detecte automáticamente el principio y el final de la matriz que era lo que comentabais ayer que si hoy no hay más remedio que eso Mirad atención en la pantalla todos y ahora ya os dejo copiar atención y me espero un poco quizás tenga que recargar un par de veces para que el navegador le dé tiempo a cargar la imagen y ahora de repente Ahora sí quiero que veáis como he convertido toda la imagen a negativo es decir lo que he hecho es para cada uno de sus píxeles y decir el rojo te lo invierto el verde te lo invierto el azul te lo invierto y el alfa no lo toco un primer problema que tengo es el calcular realmente esa matriz Cuántos elementos tiene como problema no es mucho porque yo hago lo siguiente vamos a ver vamos a sacar la calculadora si esta imagen tiene 400 píxeles de ancho por 400 píxeles de alto y yo sé que cada Pixel tiene cuatro componentes Yo sé que para cubrir esta imagen tengo que poner 640.000 en el final del foro pero claro es una manera un poco manual vale por tanto es mucho mejor poner un Ford por eso momentín dejadme que saque otra vez el Fortín que no lo tengo en la mente porque Mira tú por dónde no lo uso mucho javascript for in Vamos allá vale Y ahora escribo por tanto lo siguiente voy a quitar este foro Y en lugar de hacer una variable voy a hacer lo siguiente Ford bar igual a y Data in datano en datos y lo que estoy haciendo de esta manera Es simplemente decir que a va a tener la misma longitud el mismo principio el mismo final que la matriz llamada datos no me tengo que preocupar de decir Oye dónde empiezas dónde acabas problema en este caso el a y es la razón por la que me voy a quedar en este caso con el bucle for Es que la no me llega O sea no me coge saltos de cuatro o sea la guardo y recargo me va a hacer un poco un estropicio pero tres segundos y ni siquiera llega a tropiezar wow madre mía qué es esto Vale entonces lo voy a devolver al Foro simplemente más adelante usaremos el for in a alguna otra cosa de momento voy a poner dentro del bucle for 640.000 a mano para asegurarme que me coge correctamente todos los píxeles de la imagen bueno hemos creado como veis aquí una función mira voy a todo este bucle for y lo voy a comentar lo voy a comentar para quedármelo para más adelante usarlo cuando quiera voy a quitar estos comentarios y así comento el bucle entero lo que voy a hacer ahora he hecho un filtro negativo voy a hacer unos cuantos filtros para enseñaros lo fácil que es oscurecer aclarar brillo contraste blanco y negro Mira voy a empezar por blanco y negro lo primero que hago es copiar la estructura de control Ford voy a quitar esta alerta ya no hace nada y me ensucia el código Cómo puedo hacer yo un blanco y negro Pues un blanco y negro se hace de la siguiente manera atención datos de a atención no os lo perdáis datos de a es igual a datos de a más datos de a más uno más datos de a +2 y todo esto por favor ponerlo entre paréntesis voy a quitar espacios para que me quepa en una sola línea y todo esto me lo dividís por 3 suma al Canal rojo suma al Canal verde suma al Canal azul y divídelo por tres es decir hace un promedio de los tres canales y la información resultante quiero que me la pongas en rojo en verde y en azul a más uno a más dos a más 3 es lo mismo lo que he hecho es copiar y pegar en rojo en verde y el azul Sí ahora recargo la pantalla comprobaréis como lo que he hecho vamos a ver datos algún paréntesis me habré dejado un segundo vuelve a cargar ahora veis como la imagen salvo por algunos tonos rojos se ha convertido más a blanco y negro no es blanco y negro del todo porque es un fallo que tiene Canvas nunca se ha ido Por qué vale pero lo he de saturado digamos si comparamos con la imagen original vamos a ver en lugar de todo esto y es más sabes que así me ahorro dos cálculos con lo cual el programa irá más rápido todavía le digo datos de a y datos de a ya que datos de a es igual a esa fórmula efectivamente el problema está en que me siguiera saliendo igual momento recargo otra vez para que se entere el programa vale probablemente sea cargados por lo tanto antes de darnos uno pues tienes toda la razón tienes toda la razón Muy bien pues este es por ejemplo un filtro blanco y negro muy bien que sería lo mismo que lo he pensado antes pero no os lo he dicho que crear una variable promedio a esa variable promedio asignarle esta fórmula y decir esto es igual a promedio esto es igual a promedio Y esto es igual a promedio que es lo mismo básicamente pero usando una variable y así nos aseguramos de que los tres canales tienen exactamente Oye tengo que recargar dos veces cada vez para que me salga si no pasa nada se Canvas es así Ah una cosa que os digo estáis empezando a ver ya cómo hacemos cosas que cuestan un poquito de calcular mirar un momento dejadme que saque el procesador voy a recargar esta página tengo el 45% así estoy usando 45% en grabar atención Mirad recargo Mirando al procesador a ver si hace algún piquito no se ha visto vamos de vez en cuando trabajemos con Canvas Cuanto más compliquemos la situación cuando hagamos un filtro de blues lo veremos haremos que el procesador se Qué pasará entonces Bueno pues no os lo voy a explicar hoy ni mañana ni probablemente la semana que viene sino que tardaremos todavía unas cuantas semanas pero de lo último porque es lo más complejo Que os enseñaré de javascript será una cosa que se llama webbuckers Los web workers son la capacidad de programar multihilo dentro de javascript lo cual hace que si nosotros no usamos webworkers Y empezamos a hacer cálculos muy intensivos si tenemos un procesador i7 de 8 núcleos solo usaríamos un núcleo al 100% si queréis pero solo un núcleo gracias a web workers podremos dividir la tarea entre varios núcleos Y aprovechar los procesadores multinúcleo ya sea de PC o ya sea de teléfono móvil voy a comentar también esta estructura de control Ford Y en este caso voy a hacer un filtro de aclarar y oscurecer y luego haré un filtro de brillo contraste en el brillo contraste quizás la cosa se complique un poco más vale Pero ahora Vais a ver cómo el de brillo es bastante sencillo atención Esta es recordada la voy a dejar en pantalla de hecho esta es la imagen original esperamos tres segundos a que se cargue y esta recordad recargo por aquí es la imagen original de los pingüinos mira lo que voy a hacer ahora es descontar este bucle for y voy a hacer que cada canal simplemente lo que haga es decir datos de a es igual a datos de a más 100 en el segundo canal datos de a+1 será igual a datos de a +1 + 100 y en el tercer canal será datos de a+2+10 Qué hace esto lo que hace es cada canal de color y no tocar el canal Alfa y subirle 100 unidades equivale evidentemente a dejarlo cercano más cercano a 255 y por tanto equivale a aclarar la imagen Mirad recargo y vuelvo a recargar una vez más tendría que ponerle 5 segundos de tiempo de espera veis ahí Creo que se ve claramente como la imagen se ha aclarado verdad lo mismo puedo hacer al contrario si lo que quiero es oscurecer la imagen en lugar de sumarle 100 unidades al Canal rojo al Canal verde y al Canal azul lo que haré restarle 100 unidades a cada uno de los canales resto 100 unidades recargo la imagen a ver si tengo que recargar dos veces veis ahí como la imagen se ha oscurecido con respecto a la imagen original una vez más por tanto una operación que podemos hacer dentro de ese bucle for como os decía antes lo de las matrices realmente es lo más difícil de la clase de hoy la parte más difícil de la clase de hoy sin embargo una vez superado eso ya está Es simplemente ir haciendo cálculos a una cosa Antes de hacer un contraste permitirme explicaros Cómo hacer un umbral Cuál es la operación de umbral en Photoshop es la operación que te permite cambiar la imagen no a blanco y negro escala de grises no a blanco o negro cómo voy a hacer un umbral voy a hacerlo de la siguiente manera Mirad vuelvo a comentar ese trozo de texto es decir Para no perder lo que voy programando copio y pego y establezco lo siguiente Mira de la pantalla bar umbral es igual Por ejemplo a 122 por poner un ejemplo Y ahora yo digo atención todos a la pantalla porque voy a poner una estructura de control If Else anidada dentro de una estructura de control Ford si es cierto una cosa ejecutaré un código y si no es cierto ejecutaré el otro y esta estructura dirá lo siguiente si datos es igual a es menor a umbral en ese caso datos con el índice a será igual a cero si no datos con el índice a será igual a 255 voy a copiar esa estructura de control en el resto de los otros tres componentes evidentemente no voy a tocar me voy a dejar sin tocar el alfa para estos ejemplos igual hago algo en algún momento con lo que me interesa tocar el alfa datos de a+1 si es mayor menor que umbral datos de a más uno es igual a cero se va directamente a cero si vales menos que 122 directamente vale 0 si vales un poco más de 122 directamente te vas a 255 datos de a+1 y ahora lo mismo con el canal a+2 que ya sabéis que equivale al Canal azul si eres menor que umbral umbrales 122 te vuelves de color negro si no te vuelves de color blanco voy a poner el set Time out a 5000 para hacer 5 segundos de espera para asegurarme que carga la imagen y simplemente en este caso lo que quería demostraros es una estructura de control If anidada dentro de la estructura de control Ford jugando con las variables con la matriz de color de cada uno de los píxeles evidentemente esto cuesta más todavía de calcular de lo que hemos hecho antes porque antes era simplemente un cálculo aritmético ahora es si se cumple la condición en ese caso un cálculo aritmético eso es un doble cálculo Por eso ahora guardo recargo espero 5 segundos y después de 5 segundos voy a marcar acá recarga una vez más espero 5 segundos y tengo ya por ahí en la pantalla como veis un umbral algo hecho por ahí algo hecho por ahí Ah sí claro vale es que he hecho un umbral de cada canal por separado cuando Tendría que haber hecho un umbral por canal No por canal hacer un umbral por ejemplo por canal rojo o por canal de blanco y negro porque lo que estoy haciendo es que rojo puede ser cero pero el canal azul es independiente tendría que hacer primero un canal de grises o sea un convertir a grises y luego en tal por tanto fijaos que realmente aquí no tengo blanco y negro sino que tengo rojo verde y azul amarillo cian y magenta ocurre que creo que no hay ningún píxel pero el resto si os fijáis no llevan cualquier color son combinaciones de 0 o 255 en los canales rojo verde y azul