vamos a ver nosotros lo que hemos estado haciendo hasta ahora eh consiste en trabajar con un enfoque de programación muy determinista es decir yo le tengo que decir a la máquina lo que la máquina tiene que hacer y la máquina tiene que hacer exactamente lo que yo le diga que tiene que hacer esto ha sido así hasta ahora con lo que hemos hecho en python y con realmente con Cómo se programa en prácticamente cualquier lenguaje de programación vale Porque todos los lenguajes al final son prácticamente iguales entonces Machine learning no es un lenguaje diferente de programación es más bien un paradigma es más bien una filosofía de programación mediante el Machine learning Yo no le digo al ordenador lo que tiene que hacer mediante el Machine learning yo lo que hago es decirle al ordenador que en base a una serie de variables que yo le alimento el ordenador debe Buscar Cuál es la mejor alternativa el ordenador debe en primer lugar entrenarse o mejor dicho yo lo debo entrenar y una vez que el ordenador ha sido el programa ha sido debidamente entrenado es cuando puede tomar decisiones por sí mismo Machine learning no es un milagro las máquinas aprenden de la misma forma que los seres humanos aprenden Y tú a un ser humano recién nacido de repente no le puedes decir Haz ecuaciones diferenciales porque el ser humano dirá Hola perdona acabo de nacer sabes Dame un poco de tiempo o sea entrename y Yo sabré hacer lo que tú me pides de la misma forma a un ser humano que no le has enseñado a desarrollar una tarea de repente no le puedes exigir que haga una tarea porque no la va a hacer por arte de magia entonces eh Machine learning queda muy bonito pero muchas veces no nos damos cuenta de que antes de un Machine learning tiene que haber un Machine training vale que es entrenar a la máquina para que sepa reconocer una serie de patrones entonces dicho esto vamos a hacer el ejercicio que el otro día no nos dio tiempo es un ejercicio complejo es un ejercicio duro pero es un ejercicio muy bonito en el que yo no le voy a decir a la máquina las conclusiones a las que tiene que llegar yo lo que voy a hacer es dejarle a la máquina que llegue a sus propias conclusiones vamos a hacer un ejercicio de visión artificial que consiste en lo siguiente consiste en una imagen de internet la que queramos consiste en comparar esa imagen contra una serie de marcadores y consiste los adores ahora veréis pueden ser muchos pero eh De hecho esto que voy a hacer Dani que lo sepas es como el primer paso de una serie de redes neuronales de aprendizaje profundo vale voy a hacer el primer paso de esa red y lo voy a comparar contra cuatro marcadores es el ejercicio típico de Inteligencia artificial vale luego se puede hacer con los marcadores que quieras que es un marcador horizontal vertical diagonal hacia un lado diagonal hacia otro entonces si yo cojo una cara decidme un modelo o una actriz o un actor o lo que sea decidme a alguien un día me dijeron en una clase a obregon Vale entonces y que sé pensarlo un poco qué me contáis alguien a ver yo que sé no sea tan difícil una actriz la primera que te venga ang joli suele ser una opción bastante frecuente en los cursos pero es que estoy un poco cansado de le o sea nunca pensé que diría esto pero Así que no sé Dime algo quién Natalie portman has dicho pues yo que sé eh Mira sabes qué voy a poner actriz y a ver qué sale Entonces pongo actriz vale Y mira Scarlett johanson pues Hala Scarlet Johansson muy bien Cata pleas vale Yo lo que voy a hacer como os digo es eh comparar estos marcadores horizontal vertical diagonal 1 y diagonal 2 contra esta imagen y yo ahora mismo No sé lo que va a salir Es decir vosotros qué me diríais que esta imagen tendrá muchos horizontales muchos verticales muchos diagonales uno muchos diagonales o dos Pues no lo sé o sea directamente No lo sé lo que voy a hacer es que la máquina visualice esta cara y luego visualice otras caras y llegue a sus propias conclusiones por tanto el cambio de paradigma es grande porque yo de hecho incluso llegado un momento yo no sé cuál es el número de verticales o diagonales que tiene la imagen lo gestionará el programa automáticamente vale Voy a buscar una cara un poquito más estándar que sé mira sabes qué standar Face Ah vale estas hay caras de hecho son muy estándares mira yo que sé una cara así vale Vamos allá abro imagen guardo esta imagen me la guardo en escritorio y lo que voy a hacer también lo que voy a hacer también es editar esta imagen por ejemplo con el gim para que tenga unos valores conocidos digamos Vamos allá voy a recortar esta imagen vamos a ver voy a recortar esta imagen vale Y yo que sé y ya está y luego voy a poner un fondo Pues no sé sabes de este color Hola este color Ah no este color Y lo voy a rellenar vale Bueno más o menos y lo voy a colapsar y lo voy a exportar curso de python voy a crear una carpeta llamada caras porque luego igual creo varias y llamo esto cara 1.jpg Ah este archivo Cuánto tiene me voy a tamaño de la imagen escalar la imagen tiene 387 * 387 voy a hacer 256 * 256 es un tamaño pequeño lo sé pero también os digo que el ejercicio que voy a hacer ahora va a ser computacionalmente exigente por eso casi mejor si trabajo con una imagen pequeña bien recuperamos alguno de los ejercicios que hemos hecho anteriormente esto de momento lo puedo cerrar y recordamos que hemos hecho anteriormente ejercicios Mediante los cuales gráfica recorrer pixels vale imagen. saave bueno a ver pixels grises sí Pero bueno vale pues con imagen. sa venga Entonces vamos a ver ahora copio archivo nuevo pego cargamos dentro del curso de python la carpeta caras el archivo cara 1.jpg es est lo guardo en python 72 cara 1 Vale y vamos a comprobar que guardo cara un guardado jpg f5 vale si todo ha ido bien me voy a cara uno y cara uno es esto mientras que cara uno guardado es esto de aquí lo veis o sea esto es lo mismo que hicimos la otra vez aplicado a nuestro ejercicio esto Ahora lo desharé evidentemente porque en este caso no quiero hacer una escala de grises Pero evidentemente esto Me permite eh o sea comprobar que tengo un control píxel a píxel ahora a continuación lo que voy a hacer es generar me los voy a generar yo mismo una serie de marcadores para visión artificial eh podemos Buscar que de hecho no artificial Vision artificial intelligence markers vale me voy a por ejemplo no esto no tanto ahí o ahí por ejemplo o sea podéis ver Cualquier artículo vale Y veréis que el uso esto es un PDF vale en redes neuronales Sí pero tal vale Ah no esto es texto Bueno si veis artículos con que describan metodologías concretas veréis que pues algunos usan estas cuatro otros usan Eh pues 16 Vale entonces en una red neuronal cada una de las marcas que voy a utilizar es una neurona vale Entonces digamos que voy a tener una neurona en el cerebro que se encarga de detectar líneas horizontales una neurona en el cerebro que se encarga de detectar líneas verticales y otras dos neuronas que se encargan de detectar líneas diagonales Vale hasta Aquí más o menos me cogéis el concepto Vale pues a continuación a habéis dicho algo entonces yo ahora me voy al gimp y voy a crear pues eh básicamente una serie de Bueno voy a crear 8 por o pixels vale voy a crear un archivo de 8 por 8 pixels que sea pequeñito es importante y este archivo lo voy a rellenar de color blanco Vale y tengo en este caso vamos a ver lo exporto y en png mejor y lo llamo horizontal.png ahora lo giro y a esto lo llamo vertical.png y ahora voy a hacerlo nuevo voy a hacer una capa nueva esto creo un área de selección diagonal y la pinto de blanco difuminar los bordes m radio 1 venga va radio 1 déjame que vuelva a seleccionar para asegurarme que tiene los bordes la verdad es que no la verdad es que estoy pensando que no quiero bordes difuminados quítalo os quiero duros tiro y así me s un difuminados Pero bueno vale me vale Y esto eh combino y Esto me lo exporto como diagonal un y lo volteo en horizontal y ahora esto se llama diagonal 2 hay una cosa muy divertida Y es que cuando Generalmente en este tipo de ejercicios de visión artificial Inteligencia artificial con python o con cualquier otro lenguaje eh yo digo que usando estos marcadores horizontal vertical diagonal y tal vamos a distinguir por ejemplo una cara la gente dice imposible o sea cómo vas a poder con horizontales verticales y diagonales distinguir una cara pero ahora veréis que sí de hecho esto nos llevará un poco a entender mejor cómo funciona el cerebro humano y probablemente os llevaréis una sorpresa entonces a continuación vamos a empezar por algo sencillo De hecho probablemente la segunda parte de este ejercicio Eh Pues por tiempo más que nada os la encargaré para que la hagáis en casa pero a continuación ahora lo que voy a hacer es extender este ejercicio y decir imagen horizontal vamos a empezar con la sencilla es igual a image. openen de horizontal.png Vale ahora píxeles horizontal es igual a imagen horizontal vale Y en este caso como hemos visto aquí anteriormente yo lo que tengo es eh en pixels horizontal cargada una pequeña matriz de 8x 8 píxeles creo que eran ocho sí eran 8o no 4 mientras que aquí en imagen en píxeles tengo cargada una matriz con 256 por 256 píxeles qué es lo que voy a hacer a continuación lo que voy a hacer a continuación va a ser la matriz de uno contra la matriz de otro y voy a comparar es decir vamos a ver Esto lo voy a quitar esto voy a quitar vale Y ahora digo for x in Range vale Y ahora for anchura in Range de 0 a 8 porque es la anchura de esa muestra de horizontal o diagonal o vertical o lo que queráis y for altura in Range de 0 a 8 Quiero recordar que antes de empezar este ejercicio os he preguntado si os encontrais bien la pregunta es cómo os encontráis ahora al ver cuatro fors anidados es decir Generalmente Cuando llegamos a este punto eh Cuando encontramos una nidación de X e Y cualquier mente humana puedo decir vale x y voy a barrer en horizontal y en vertical pero cuando encontramos cuatro for anidados es cuando el cerebro nos empieza explotar un poco Porque empezamos a decir espera exactamente qué es lo que voy a hacer aquí Vale entonces lo que voy a hacer aquí lo voy a poner comentado lo voy a comentar luego lo desbloquearemos para que lo entendáis un poco mejor voy a asumir que cojo el Pixel que está en cero Es decir para que me entendáis lo voy a hacer sencillo lo que voy a hacer es abrir curso de python caras voy a abrir horizontal o vertical me da igual el que sea lo voy a poner ah hola Ah mover no mover esto mover capas lo voy a poner aquí arriba y voy a jugar con los píxeles vale de momento o sea más adelante ese cuádruple bucle for nos sirve para esta muestra y empezar a compararla elemento a elemento pero ahora para empezar para hacer lo más sencillo vale para que el ejercicio empiece siend lo más sencillo del mundo voy a imaginarme que solo existe esto Solo existe ese cuadrito de color crema de ahí y solo existe este cuadrito blanco y negro de ahí okay est Vale entonces yo ahora vengo a python y lo que hago es lo siguiente voy a recorrer los primeros ocho píxeles de la imagen for x in Range de 0 a 8 los primeros ocho píxeles for y in Range de 0 a 8 a continuación lo que voy a hacer es lo siguiente lo que voy a hacer es decirle al sistema que quiero print el resultado es dos puntos más a ver si no me da mucho problema esta operación vamos a ver píxeles de cer no perdon píxeles de X Y men píxeles horizontales de X coma y insisto es todavía bueno es 07 técnicamente Porque si empieza en cero vamos a ver si no me da ningún error de encadenar números con contextos y todo esto y si no lo convierto a String como te decía entonces el argumento debe ser una secuencia de longitud 2s no sé que me estás diciendo pero voy a hacer str vale el argumento debe ser de longitud 2s print más coma Ah no Espérate vale No print fuera y print fuera Okay Vale pues mira sabes qué Y ya está f5 OK e menos píxeles horizontal de longitud dos vamos a ver Ah sí Perdón vale sí Ah claro es que por ejemplo Vale tengo que ver el color rojo porque de cada píxel acordaos que había cuatro piezas de información el canal rojo el canal verde el canal azul y el canal transparencia vale esto es pixeles a Ok x y de 0 Okay vamos a verlo ahora vale Y lo que nos da es esto son cuatro valores donde si os fijáis los -76 parece que equivalen a un color y los 179 parece que equivalen a otro color acordaos que el horizontal vale está habilitado de esta forma yo qué es lo que quiero a continuación lo que quiero es intentar Buscar con este píxel formas verticales de la siguiente forma si yo cojo este marcador de aquí voy a si yo cojo este marcador de aquí y yo lo muevo por ejemplo aquí vale Y yo lo que hago en este caso es decirle al sistema vamos a verlo que lo quiero fusionar momento que lo quiero fusionar un momentín Ah sol la par diferencia vale empezará a aparecer esto pero si yo ahí por ejemplo solapar Pero si yo por ejemplo lo que hago es previamente esta capa duplicarla y usar un filtro de hallar bordes filtro Ah detectar bordes a ver no sabéis A qué filtro me refiero a ver la pl no vamos a ver realzar quiero el clásico filtro Mira sabes qué voy a abrir un momentín Photoshop porque en Photoshop lo tengo más localizado vale caras cara uno okay filtro interpretar no estilizar hay arbes ahí está Vale y tengo esto por ejemplo tengo el clásico filtro Dear bordes que luego lo puedo trabajar con de saturación y luego lo puedo Mira me va a venir bien y todo y luego lo puedo brillo contraste vale Vamos allá Esto me lo guardo cara uno bordes y ahora en el G aquí mismo realmente cojo vertical no ahí no cojo vertical se ha quedado frito parece sí cojo vertical lo pongo ahí y entonces daos cuenta qué es lo que va a ocurrir cuando yo por ejemplo cojo ese color negro y Lo aclaro o lo multiplico vamos a ver No espera mín no multiplicar no aclarar Ahí está vale fijaos que es lo que ocurre cuando cojo Esa imagen digamos y la paso por ahí por el color blanco lo que ocurre Es que la imagen aparece digamos eh Como te diría yo negra Pero qué es lo que ocurre cuando la pongo en una línea vertical esa imagen prácticamente desaparece qué es lo que ocurre por ejemplo si lo pongo Ahí la imagen desaparece Pero qué es lo que ocurre cuando la pongo por ejemplo en una en un borde que es horizontal no desaparece tanto Entonces estos marcadores me sirven para irlos comparando contra la imagen y para decirle a la imagen que básicamente lo que quiero es que vaya restando el marcador contra la imagen de tal forma que cuando al restar se quede la imagen original es que me quedo como estaba pero cuando al restar disminuya la intensidad de la imagen Es que ahí he encontrado un marcador vale Esa es la filosofía de cómo funciona insisto una estrategia de visión artificial hay muchas vale os estoy enseñando hoy una pero tened en cuenta que tenemos cuatro marcas lo que va a hacer Es que voy a simular un pequeño cerebro digamos animal donde una neurona únicamente ve líneas horizontales otra neurona solo ve líneas verticales estamos ahora de momento programando la primera de las neuronas con esto si os habéis fij lo que he utilizado es una operación de diferencia entonces con la operación de diferencia lo que estoy haciendo es restar es una resta aritmética vale restar el valor de un píxel al valor de otros lo que voy a hacer en este caso lo que voy a hacer ahora a continuación es indicarle al sistema Cómo debe proceder O sea qué es lo que debe entender cuando encuentre que hay una coincidencia vale cuando el sistema encuentra una coincidencia lo que haré es por ejemplo píntamelo de un color concreto por ejemplo píntamelo de rojo píntamelo de verde para que yo pueda ver que has encontrado algo ahí pero claro ahora tengo que hacer lo siguiente para que entendáis lo que tengo que hacer yo lo que he hecho yo lo que he hecho es ese marcador y lo he Comparado ahí arriba lo he Comparado allí arriba contra el pixxel en cero ahora tengo que hacer así y luego así y luego así lo veis o sea lo que tengo que hacer es ir moviendo ese cabezal para ir buscando coincidencias Espera que lo he quitado de diferencia para ir buscando coincidencias en el momento en el que vale en el momento en el que est trabajando correctamente Vale entonces ahora eh puedo trabajar de esta forma puedo trabajar con blanco y negro Puedo trabajar con transparencia vale puedo trabajar como necesite Entonces ahora de momento lo que voy a hacer una guardar voy a Editar mis marcas descartar cambios Vale entonces voy a cargar las cuatro marcas y voy hacer las entes vale no se ven pero están ahí que es eh capa Dónde está transparencia color Alfa no está wow Por qué Mira sabes qué a la porra Ah muy bien vale un segundin vale nueva capa Ahora sí esto lo exporto dentro de vertical dadme un segundo giro la imagen esto lo exporto a horizontal Yo creo que con esto ya tenemos para empezar a trabajar Vale ahora a continuación voy a realizar esto vamos a ver vamos a intentar entender lo que vamos a hacer antes de hacerlo porque los cálculos van a ser duros voy a el vertical voy a ese vertical y voy a hacer una diferencia sobre estos píxeles Ah Es una diferencia Hola momento un segundo vale Okay rasterizar invertir vale qué es lo que ocurrirá cuando yo por ejemplo ponga esa muestra ahí arriba a la izquierda pues lo que ocurrirá es que los píxeles serán negros Pero qué es lo que ocurrirá cuando yo ponga esta muestra por aquí pues que los píxeles ya no serán negros vale veis lo que quiero en este caso entonces voy a venir aquí al gimp vale voy a esta muestra de colores voy a invertirla y la sobre escribo vale un momento y 90 exportar como vertical y voy a ver qué me da recordáis que estamos haciendo una resta vamos a ver no Esto no es esto sí es esta es la imagen original Esta es la imagen sobre la cual estoy restando voy a vertical vamos a verlo vertical y voy a decir sí píxeles vertical si píxeles vertical de X I de 3 no es igual a 0 en ese caso esto de aquí vamos a verlo f5 Vale qué ha pasado si os fijáis tengo la mitad de los números tengo la mitad de resultados Por qué hace esta línea que Debemos entender recordamos que antes estaba viendo el canal rojo es el índice cero pero ahora estoy cogiendo el índice 3 que es el canal de transparencia cero er rojo uno es verde dos es azul tres es transparencia así que de esta forma ahora a continuación lo que quiero es decir solo validame si realmente el píxel en el que estás tiene color vale me está dando -76 Eso quiere decir que bueno no es muy buen rollo evidentemente vamos a ahora a hacer lo siguiente vamos a ver -76 lo cual equivale a negro o sea está por debajo de cero evidentemente vale Y voy a hacer lo siguiente print a ver valor es igual a o If esto de aquí es menor que cer en ese caso valor es igual a c en caso contrario valor es igual a este dato de aquí Así que ahora Sácame valor esto qué es lo que va a hacer lo que va a hacer es evitar que salgan números negativos yo ahora vengo por aquí pulso f5 y me sale todo cero vale porque le he dicho que lo quería todo a cero ahora a continuación lo que voy a hacer es repasar esto mismo con todo el resto de la imagen como si repaso esto mismo por todo el resto de la imagen van a salir 256 * 256 veces más que estos ceros O sea imagínate lo que va a salir lo que voy a hacer es resumir todo esto en un solo número Así que suma es igual a 0 suma es más igual a valor y al final del todo print la suma es suma esto fuera y así de esta forma lo que voy a conseguir eh cuidado lo que voy a conseguir es resumirlo todo a un solo valor la suma es cero Okay hasta el momento vale no me digáis que sí porque realmente no porque yo entiendo que estáis mirando como diciendo bien no me estoy enterando muy bien de lo que está ocurriendo Porque si ya lo de cambiar el color a Gris me costó un poco pues esto más todavía vale lo sé pero de momento confiad en mí y veréis cómo al final le encontraréis sentido a este ejercicio ahora lo que voy a hacer es recuperar los dos fors estos de aquí y digo for super x in Range 0,256 for super y in Range de 0 a 2 5 6 lo estoy poniendo como super x y super y para que entendáis que están jerárquicamente por encima vale Y entonces Ahora vengo y digo que los píxeles vamos a ver píxeles vertical piels es super x + x super y + y super x + x super y má y ahora con este cuádruple bucle for lo que estoy haciendo es lo que os decía antes es decir un bucle for ahora siguiente otro bucle for siguiente otro bucle for siguiente otro bucle for lo que estoy haciendo es correrlo en horizontal y luego correrlo en vertical Así que con esto Ahora me va a seguir dando un montón de números f5 suma cero vamos a verlo suma cero Vale ahora voy a tocar el Cold e qué ha pasado Ah Index out of Range Perdón es que es de 0 a 255 porque el cer cuenta como un número entonces se ve que ha ido al 256 he dicho no existe el Pixel 256 voy a hacer una cosa voy a cargarme esto de momento y ya luego lo volveremos activar Vamos allá vale men pero si todo va bien en un momento dado en un momento dado e Qué pasa vamos a ver image Index out of Range claro necesito lo siguiente pixxel más str de Super x más coma más str de Super y porque así me voy enterando de lo que está ocurriendo quiero deciros con esto que si hago así Pixel c tal veis que si me voy enterando Por qué Pixel va vale a ver dónde da el error parece que vaya a dar el error en y tal cual parece que Ah 249 2 4 nu9 Claro claro Perdón claro 249 porque no puedo decir al programa no puedo decir al programa que me llevo este píxel aquí al borde y claro le pregunto qué es lo que hay por fuera vale con lo cual debe ser 2 5 6 - 8 o sea 2 5 - 8 Fijate saco calculadora hasta para esto 2 5 - 8 son 247 y 247 vale ejecuto daos cuenta que estamos todavía por el píxel 1 com c y pico o sea eso tiene que llegar hasta el final Bueno yo lo que quiero es averiguar ver en pantalla cuando en algún momento este valor es menor que 1596 Perdón menor no mayor pero claro Es que voy todavía por el Pixel 3 de 200 26 entonces lo que voy a hacer ahora es muy sencillo como ya sabéis que python no es un lenguaje de programación especialmente rápido pero la terminal lo ralentiza más todavía lo que voy a hacer Es que solo imprímeme esto si el valor Es mayor que -90 o sea ahórrate todos los falsos que ya sé que no van a salir bien Y de esa forma No pierdo tanto tiempo sacando información por pantalla f5 e eh Hola a ver un momento que valor Es mayor que menos voy a poner esto así el valor es mayor el valor es mayor a ver 100 momento valor voy a poner mayor que cer ves ahí por ejemplo no me está pillando el mayor de un negativo Mira ya ha acabado e ah no sí claro mayor que cero no hay ninguno vale c men f5 Será posible por qué valor Es mayor que menos o sea -96 es un valor menor que -190 estamos de acuerdo en esto voy a poner - 150 Estamos igual hay un método que no está mal que consiste en vale si el absoluto del valor el absoluto no me lo va a pillar es menor O sea al revés le damos la vuelta que 1590 absoluto no me lo va a pillar porque voy a tener que Ah Qué curioso A ver es menor y la suma es ABS suma f5 vale si el valor es menor que 1590 y el valor es 1596 No sé estoy flipando un poco estoy flipando un poco porque 1596 no es menor que 1590 por tanto esto debería dar falso o no lo estoy viendo yo correctamente valor menor Mirad en este caso voy a parar ahora voy a volver a ejecutar atención y fijaos que me está encontrando directamente en 18 en 19 en 20 me está encontrando como veis por ahí los píxeles que qu dan positivo Okay ahora yo quiero un threshold más pequeño Yo quiero un threshold de 10000 para que solo me encuentre unos pocos pixeles guardamos y nos fijamos por ahí de que el sistema está encontrando por ahí pero 100 quiero menos todavía quiero 100 ahí por ejemplo vale Yo creo que ahora cuando acabe esa serie de 70 y pico vo hacer 800 va Vamos a forzarlo a ver 700 a ver hasta dónde llegamos 93 94 100 vale Okay ahora y ya está Vale estos son los píxeles que el programa ha encontrado que coinciden con la marca vertical claro Yo no tengo ni idea es decir yo me tengo que fiar del sistema lo que sí que voy a hacer evidentemente es sacar algún tipo de diagnóstico visual para confirmar que realmente los píxeles son los verticales y como os podéis imaginar esto que he hecho para los horizontales o por los verticales ahora luego lo tengo que multiplicar por cuatro para hacerlo para horizontales diagonales y diagonales dos para esto lo que quiero hacer ahora es decirle a la imagen que quiero sobreescribir es decir quiero Eh Pues no sé pintar algo entonces por ejemplo voy a crear por aquí una imagen llamada resultado en el gimp Crea una imagen llamada resultado que es de 256 por 256 de blanco Pues de blanco esta se va a llamar resultado Okay y ahora en python quiero hacer lo siguiente imagen resultado es igual a resultado pun png píxeles resultado es igual a imagen resultado y ahora lo que quiero es lo siguiente els píxeles resultado de Super x + x y super y + y es igual a 0,0 en caso contrario píxeles resultado 255,255 imagen resultado pun save y lo quiero guardar en caras resultado. png de tal forma que básicamente Esto va a consistir en que en lugar de ver un montón de números que yo no entiendo qué es lo que está ocurriendo en esos números lo que voy a hacer es ver algo en una imagen quito este print si queréis cruzar los dedos y hacer un rble de tambor es un buen momento para hacerlo yo De hecho voy a Au un segundin d un segundo que me voy a encender el flexo pero tengo que desenchufar una cosa un momentín Vale pues voy a ejecutar y el programa Pues bueno no tardará mucho calculo un momentín Ya está ya acabado me voy a resultado y en resultado veo esto vale en resultado lo que obtengo es que mediante estos registros el sistema está encontrando que ahí había píxeles verticales y ahora viene la prueba de fuego vamos a ver si esto es cierto o no lo es para ver si esto es cierto o no me voy por ejemplo a Photoshop encima de esta imagen suelto el resultado le bajo la transparencia y empiezo observar vale Y veo bueno Esto no sé por qué lo ha cogido la verdad esto tampoco pero veo que aquí sí que ha hecho bien en detectar los píxeles verticales de la nariz vamos a volver a verlo o sea cuando veis esto probablemente está encontrando los de al lado quiero decir que Pero estos no me cuadran si te digo la verdad Y estos de aquí debería haberlos encontrado vale lo que puedo hacer es probar diferentes iteraciones con diferentes valores por ejemplo lo hago con 1000 y ahora a continuación me voy a esa imagen Busco resultado y veo que ahora por ejemplo empieza a encontrar una serie más de cosas por ejemplo veo que la nariz Parece que la está encontrando perfectamente ahora a continuación insisto esto no está acabado vale Pero lo que quiero ver es que el programa está encontrando ya una serie de formas vamos a ver un momento que repaso el programa suma es igual a 0 suma valor Vale y un segundo valor vale es igual a 0 esto creo que sobra pero por si acaso vale Y este es el resultado horizontal Por cierto que no sé si me va a crear automáticamente esa imagen lo divertido Dime lo que voy a hacer a continuación yo de momento lo que he hecho es simplemente marcarlo en negro en la pantalla para ver si está detectando algo también te digo que lo que necesito hacer En definitiva esto fuera cara Uno Vale lo que necesito hacer En definitiva voy a borrar esto es número píxeles Estos son verticales es igual a cer número píxeles horizontales es igual a 0 número píxeles diagonales 1 es igual c y número de píxeles diagonales 2s es igual a cer con esto lo que hago si esto es cierto en ese caso número de píxeles verticales más igual 1 con lo cual yo al final lo que quiero es print el número de píxeles verticales es más str número píxeles verticales yo lo que quiero realmente al final ahora verás es esto sacar el número de verticales el número de horizontales el número de diagonales y sacar una proporción y que tras enseñarle digamos 10 20 500 caras el sistema diga mira me he dado cuenta de que cuando en una imagen las verticales son el doble que las horizontales y son tres cuartos que las diagonales eso suele ser una cara y yo diré Pues si tú lo dices me lo creo o sea yo no le voy a decir al sistema Cuál es la proporción de horizontales verticales y diagonales sino que es el sistema el que lo tiene que aprender y me lo tiene que decir a mí Vale entonces ahora lo que voy a hacer es complementar este ejercicio momento correcto unas cosas de otras Esto que estoy haciendo insisto una vez más Y es que es el paso más sencillo y el ejercicio más sencillo para demostrar Esto entonces de hecho esto como te decía en un algoritmo de lo que se hace Es que la primera capa no distingue caras la primera capa distingue si hay una línea recta si hay un círculo si hay un cuadrado entonces luego en la tercera capa es cuando dices Bueno si hay un círculo y una línea horizontal suele ser un ojo si hay dos círculos el centro de la cara es una nariz vale es decir estoy haciendo un ejercicio muy bestia en el que pasamos de c a 100 en un ejercicio de Deep learning Hay un montón de pasos intermedios Entonces ahora lo que voy a hacer es dejaros el cálculo para el resto de features y nos vamos al siguiente ejercicio con el que quería trabajar hoy que es el tema de tratamiento de strings con la librería npi vale pero os voy a dejar esto lo suficientemente Esto esbozado entonces imagen vertical imagen horizontal horizontal diagonal un sobre todo quiero esto porque como estaréis viendo en la pantalla como estaréis viendo la gracia es que es copiar y pegar código vale Y ahora esto es vertical atención yo ahora voy a hacer Ey Uy aquí yo ahora voy a hacer esto 1 dos 3 cu ya sabéis que esto de copiar y pegar código tiene mala pinta vale tiene pinta de que no es lo correcto sin embargo evidentemente lo estoy haciendo por rapidez horizontal diagonal un leches me lo pega doble Cuántas veces he pegado diagonal 2s pero ah Wow vale sí okay venga y ahora esto es vertical esto es horizontal píxeles horizontal esto es diagonal 1 esto es diagonal 2 vale la imagen me da igual ahora mismo f5 verticales e verticales horizontales tres 405 lo dudo número píxeles diagonal diagonales voy a ejecutar me da me ha dado 3405 en vertical y en diagonal entiendo que algo no está bien n de píxeles Ah claro por supuesto horizontales diagonales uno y diagonales dos vuelvo a ejecutar 3405 6 19202 bueno puede ser me suena un poco alto pero bueno lo que sea si el programa lo ha encontrado Entonces yo en este caso lo que tengo es una serie de números y una vez que tengo esta serie de números puedo proporcionarlos entre ellos y puedo empezar a alimentar el sistema de tal forma que si seguimos este mismo algoritmo y esta es la parte del ejercicio que os dejo para vosotros con esta parte del ejercicio encontraremos que si alimentamos muchas caras Al final el sistema aprenderá que lo más alto son diagonales o sea los diagonales dos luego diagonales un luego horizontales y luego verticales en esta proporción y lo más probable es que cuando yo le alimente pues unas 50 caras el sistema llegue a la conclusión de que las o sea las eh los balances entre los pesos son estos de tal forma que y yo igual le alimento otras 50 imágenes de coches para comprobar que los coches no tienen esta proporción sino tienen otra de tal forma que una vez que haya entrenado al sistema cuando yo le ponga una imagen y detecte que la proporción entre horizontales verticales diagonales un y diagonales dos cumple esta proporción el sistema dirá eso tiene pinta de ser una cara vale entendéis el mecanismo de Vale entonces con esto lo que os dejo es Eh Pues eso a vuestra libre albedrío el poder trabajar con un programa de entrenamiento mediante el cual podáis definir podáis detectar Cuál es la proporción entre estas caras dicho lo cual pasamos al siguiente ejercicio que parece que no pero está relacionado con este ejercicio de aquí no solo con este ejercicio sino con otras muchas cosas que podéis hacer ahora veréis bien algo que no hemos visto hasta hoy que tampoco tiene mucha complejidad Por cierto que ahora veréis que en esta parte de la clase la complejidad de la intensidad de los conocimientos va a disminuir eh Por cierto habréis sobrevivido a la parte anterior de la clase estáis bien seguí estando bien Vale pues Ahora va a ser mucho más sencillo yo he dicho antes y lo vuelvo a repetir lo mantengo que antes de poner en marcha un sistema de Inteligencia artificial mediante Machine learning primero tenemos que haberlo entrenado lo que yo acabo de hacer es un entrenamiento es decir le he presentado el sistema una cara pero evidentemente un sistema no Se entrena con un solo elemento necesita unos cuantos para aprender entonces claro yo por ejemplo podría bajarme una colección de caras de internet por cierto que ya existen ya hechas hay colecciones de caras estándar para descargar Pero entonces qué tendría que ejecutar Este programa no sé 50 veces yo a mano cada vez cambiando cara uno O sea cara ca dos ejecutar cara tres ejecutar cara cuatro ejecutar podría ser un poco engorroso como os podréis imaginar en python existen eh instrucciones no solo para escribir y leer archivos como hemos hecho anteriormente sino también para recorrer el sistema de directorios voy a hacer un nuevo archivo voy a guardarlo como recorrer voy a Mira por ejemplo hab ha salido en diagonales Vale Voy por ejemplo a escritorio o a curso de python y voy a crear aquí carpeta con cosas y dentro de esta carpeta con cosas Pues voy a meter cosas no sé qué voy a meter eh No sé a ver inicio mm no sé imágenes no fondo pantalla no hay muchas cosas música no es ese tipo de música no sé a ver