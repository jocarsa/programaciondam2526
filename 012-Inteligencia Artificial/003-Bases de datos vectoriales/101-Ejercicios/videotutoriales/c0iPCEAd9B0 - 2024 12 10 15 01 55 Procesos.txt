bien pues en la clase de hoy de procesos eh Vamos a continuar un poco con lo que comentamos ayer en el punto cco del temario con respecto a utilización de técnicas de programación segura vemos que pues tenemos el tema de los roles vale que ya empezamos implementarlo la semana pasada con el objetivo de que pues podamos controlar quién accede A qué información y En definitiva y sobre todo en la parte de programación de aplicaciones con comunicaciones seguras protocolos encriptación esta unidad didáctica Nos invita a eh pensar acerca de Cómo podemos proteger nuestra aplicación en caso de que algo ocurra vale en este caso tenemos una aplicación que está programada con el paradigma de cliente servidor lo cual quiere decir que en un momento dado momento que estaba aquí trabajando con unas transcripciones vale Y esto fuera voy a abrir bueno Por una parte voy a abrir local Host vamos a echarle un vistazo al proyecto bien y vamos a echar un vistazo al proyecto también desde el punto de vista del código y vamos a intentar ponernos en la peor de las situaciones eh esta asignatura hasta el domingo vamos a verlo por una parte vamos a programaciones eh Por otra parte vale 15 de diciembre entonces en esta asignatura en programación de servicios y procesos entra todos aquellos proyectos que haya en comunicaciones de red que creo recordar te lo digo ahora que creo recordar que era sobre todo del tema del correo electrónico vamos a verlo déjame recordarlo vamos a dam vamos a segundo vamos a programación de servicios y procesos vale vamos a programación de comunicaciones en Red correcto vale Y en programación de comunicaciones en Red vamos a ver teníamos aquí teníamos lo de los sockets vale lo de los sockets los thre y todo esto tenemos la creación de sockets La carga del sistema que esto era un Script de servidor interesante y guardar a un archivo que este Script era muy interesante para tenerlo de fondo en el servidor tenemos el enlazado de Ah lo de quito el canal Alfa y todo esto de la imagen compresión de la imagen utilización de sockets para transmisión vale lo del correo electrónico ahí lo tenemos ahora así y ya está Vale En definitiva siempre que o sea a ver te iba a decir siempre que os preguntéis qué va en cada entrega lo mejor que podéis hacer es eh entrar dentro de la carpeta correspondiente y los proyectos que hayan dentro de esa carpeta son los que van en esa entrega pero no eso no es lo mejor eso es lo segundo mejor que podéis hacer lo mejor que podéis hacer es lo que acabas de hacer Beatriz que es preguntar aprovechar la clase para preguntar porque para eso estamos aquí para eso hay una clase con profesor y alumnos con lo cual lo digo porque en principio siempre va a ser así pero bueno Imagínate que alguna vez hay alguna circunstancia especial de Mira sí hicimos este proyecto pero realmente la entrega hacerlo de esto otro vale por eso la regla general es esa pero casi que si cuando tengáis dudas lo comentamos aquí en clase mejor ya así nos aseguramos todos de que pues todo está claro para las entregas vale eh en breve por cierto aprovecho ahora que comentas esto eh os comentaré un poco Cómo enfocamos el segundo trimestre Gracias a ti Y cómo enfocamos el final de la asignatura vale eh donde en el final de la asignatura pues prácticamente las últimas unidades se convertirán en una entrega que tenéis que hacer haciendo un resumen de lo que ha sido la asignatura vale pero Eh tranquilos eso lo comentamos en las próximas semanas es algo que va a ocurrir a mitad de febrero vale con lo cual no es algo que en lo que os tengáis a que poner a trabajar ya mismo y tampoco es que os voy a hacer trabajar más quiero decir No vais a tener que programar más simplemente habrá una entrega en la cual me contaréis Pues todo lo que habéis hecho en la asignatura y ya está o sea es contarme lo que habéis hecho no tenéis que hacer más de lo que estáis haciendo que ya estáis haciendo bastante Vale entonces bien entonces con respecto a esto eh vamos a ver vamos a V vamos a sistemas de gestión empresarial vamos a proyecto creo que alguien había abierto micro alguien quería algo a ver y dragos o igual tienes el micro abierto vale Bueno no sé voy a ir continuando Vale entonces ayer estábamos trabajando con formularios Ok me voy a cliente y en cliente nosotros lo que tenemos al final es pues un archivo html que eh tiene todo esto que estamos viendo aquí vale tiene Pues esta página principal y tiene Pues todo lo que en principio queremos que tenga la cuestión está en dragos Hola ya sí sí eso me parecía Vale pues eh la idea Está en que eh yo lo que quiero es utilizar algún tipo de mecanismo Como por ejemplo el mecanismo que tenemos dentro de php que es el da para decir que cuando se de una circunstancia cuando se de una circunstancia concreta pues eh el sistema tenga la opción de o bloquear localmente a un usuario o eh bloquear e el sistema completo Cuando digo bloquear temporalmente a un usuario me refiero a algo Como por ejemplo lo que comentábamos ayer de que si el usuario entra con un navegador que no está permitido pues te lo bloqueo vale Pero te bloqueo ese usuario en ese momento el resto de usuarios Pueden seguir trabajando y luego hay otro tipo de medida que consiste en que eh En el caso de que el sistema detecte un ataque el sistema se bloquea para todo el mundo vale es molesto resulta molesto lo siento mucho pero siempre es mejor que el sistema se bloquee para todo el mundo es decir el sistema se convierte en una tortuga con su caparazón y en cuanto detecte un ataque se mete dentro del caparazón pero no deja entrar a nadie ni a los usuarios eh correctos de la aplicación ni a cualquier otro tipo de usuario que está intentando realizar un ataque Y por supuesto tiene que ir un administrador y tiene que revisar qué es lo que ha ocurrido y tiene que pues desbloquear vale eso esto quiere decir que hasta el momento eh yo he estado trabajando el cliente mediante html intentando separar siempre que podemos la parte de cliente de la parte de servidor vale Y eso está bien pero hay un problema y es que si yo ahora a continuación eh voy a cerrar que estaba haciendo aquí cosas con python antes de vale antes de la clase espera eh okay venga ciérrate Ah aquí vale No sé por qué me aparece la otra ventana vale Y qué más este l fuera vale Y esto Ok bien entonces html me voy a dam dónde estás dam aquí me voy a segundo me voy a sistemas de gestión empresarial me voy a proyecto y ahora a continuación copio pego 130 y voy a poner el poder de la muerte Qué quiere decir el poder de la muerte eh No lo sé pero ya estabas dentro hace un rato no Ah el poder de la muerte Sí est esta versión del proyecto se llama el poder de la muerte y ahora verás por qué ahora verás por qué Así que o sea no ha sido vale No has oído incorrectamente lo has oído bien vale entonces poder de la muerte hace lo siguiente si yo aquí cambio vale Lo siento mucho tengo que cambiar cambio eh Index html por Index php y ahora a continuación en la primera línea de todas vale arriba digo php Die Ese es el poder de la muerte y Qué quiere decir el poder de la muerte cuando digo muerte no es que lo diga yo es que lo dice php yo no le he puesto el nombre a esa función Pues eso quiere decir que yo voy a cliente y ocurre esto es decir ocurre nada si yo reviso el código fuente veo que en el momento en el que yo pongo una instrucción Die la ejecución del hilo de php literalmente se muere y esto es muy importante porque si yo tenía hasta el momento un archivo html con código html yo puedo implementar el sistema de medida de seguridad que quiera pero html ya habrá cargado Y si alguien me está intentando reventar la aplicación pues lo que ocurrirá Es que yo ya le habré dado mi html ya le habré dado pistas de que tengo un form login y un input type text y de usuario y de contraseña y lo que sea vale Y yo lo que quiero es que si en algún momento se bloquea la aplicación se bloquee pero bien y cuando digo se bloquee pero bien Sí Beatriz eh la hemos usado sobre todo en el contexto de lo que hemos programado hasta el momento de eh de lo poco que hemos programado de seguridad informática es decir yo recuerdo que hicimos un saneador de cadenas que lo que hacía era que si detectaba alguna cláusula sql prohibida Si alguien me intentaba meter un delete en un campo lo que hacía es Die vale Es decir para la ejecución antes de que esa cláusula intente entrar en la base de datos O sea que sí La cosa va por ahí vale el contexto es el mismo el contexto es la seguridad informática cuándo mato la ejecución de php cuando he detectado algo que no me cuadra y lo que hago es Supongo que habréis visto alguna vez en las máquinas industriales el botón de Z roja vale el da es el botón de Z roja que es que tú le pegas una leche al botón y la máquina separ este como este aunque la máquina al pararse se rompa Vale cuando le das al botón es que se supone que hay alguna condición en la cual hay un ser humano en peligro con lo cual le pegas una leche al botón de parada de emergencia para que más vale que se rompa la máquina que no que se rompa el ser humano Vale pues esto es lo mismo el botón Die es como el botón rojo de emergencia de php Incluso el Die mucha gente no lo sabe Pero admite un parámetro y es un parámetro de String Vale entonces emoji Eh emoji lock vale candado esto es y copio Vale y mucha gente no lo sabe Pero el Die admite un String lo cual quiere decir lo cual quiere decir correcto sí no me refiero a cualquier máquina es decir cualquier máquina industrial especialmente botón de parada de emergencia tod tambén llamado Z roja vamos a ver emergencia Vale cualquier máquina que tenga partes móviles y que en un momento dado pueda suponer eh un peligro para el operario o un peligro para los seres humanos que están cerca Pues es este botón de parada de emergencia que sí Exacto ya te digo cualquier máquina que tenga partes móviles y que en cualquier momento pues la operativa de esa máquina pueda suponer vale un peligro pues me refiero a eso pero en php vale esto quiere decir que yo ahora a continuación no sé por qué tengo dos navegadores abiertos eh aquí vale yo a continuación hago así y aparece un candado ya está así de sencillo simplemente lo que he querido demostraros en este caso es que si yo pongo aquí ya te digo tan sencilla instrucción pues evidentemente esto se bloquea eh voy a hacer una cosa voy a meter Esto va a ser un div ID candado vale Y voy a meter como un mini estilo vale simplemente por motivo estético para que el candado est este aparezca en medio de la pantalla y si en algún momento dado se bloquea la aplicación y ahora a continuación hablaremos de Cuándo se bloquea la aplicación vale o sea porque ahora mismo yo estoy forzando el da a muerte nunca Mejor dicho pero ahora lo que haremos es poner algún tipo de condicionalidad para saber cuándo aparece este candado bien entonces y de candado voy a venir por aquí y voy a decir que Eh Pues por aquí voy a decir html document only has this make eh make Element appear on screen Center y ya está vamos a ver sí pero no bueno y ya sí pero va a ser que en fin va pues pongo esto puedo de hecho hacer esto ea puedo de hecho hacer esto y ya está Vale técnicamente puedo hacerlo no es que sea muy limpio puedo hacer un include Por cierto vale hago así y lo que quiero es comprobar voy a cerrar esta ventana para no tener dos ventanas de Chrome abiertas vale esto es lo que quiero y ahora pues 250 píxeles vale para que si alguien entra Igual me pasado un poco si alguien entra pues veo un candado vale veo un candado y no tiene que ver nada más porque si alguien te está intentando atacar cuando O sea si le das un mensaje de error Cuanto más le digas más información le estás dando para saber por dónde te tiene que contraatacar vale o por qué otro agujero te tiene que atacar bien con esto ahora lo que voy a hacer aquí en client es crear una carpeta nueva llamada Inc dentro de Inc Pues voy a crear un archivo llamado morir php y lo que voy a hacer es básicamente pues mover todo esto al archivo morir php y ahora viene la cuestión Vale ahora digo include Inc morir php y así no ensucio el archivo princip principal vale Ok sigo teniendo Exactamente lo mismo claro ahora la cuestión es Cuándo muere una aplicación el Cuando muere una aplicación puede tener muchos orígenes yo lo que voy a hacer es realizar una propuesta vale Y luego cada uno en el desarrollo de vuestro propio proyecto podéis modificar lo que yo voy a hacer enormemente Vale ahora veréis y yo por ejemplo voy a crear un archivo lado eh morir punto miror No morir txt ya está y ahora a continuación voy a decir si existe el archivo morir txt llámalo log.txt vale llámalo como quieras lock candado quiero decir Vale pues Ahora a continuación en lugar de hacer una muerte asegurada y garantizada pues yo lo que voy a hacer es supeditar la muerte a la existencia de un archivo Vale entonces me vengo por aquí y digo php check If exists file log.txt llámalo log.txt llámalo lo que sea Vale entonces file exist pues ya está file name es igual a log TX name exist Fil name y aquí bien Podría meter la condición de muerte en la base de datos el problema está en que si alguien me peta la base de datos ya no puedo consultar la base de datos es más fácil que me peten la base de datos que me peten el archivo o sea el acceso al sistema de archivos vale Así que a continuación vuelvo a recargar vale veo que tengo otra vez un lock y ahora a continuación voy a quitar el archivo de lock con lo cual recargo y el sistema está desbloqueado Pero si yo vuelvo a crear el archivo de log.txt recargo y el sistema vuelve a estar bloqueado la cuestión que nos tenemos que preguntar ahora es por qué motivo el sistema crearía añadiría un archivo llamado log txt Vale pues voy a insisto voy a hacer un caso supuesto Bueno un caso supuesto No de aquí a las 4 voy a hacer todos los casos supuestos que me den tiempo pero como os digo esto obviamente os da pie vale a establecer los mecanismos de bloqueo que vosotros queráis Insisto que en este caso voy a estar hablando ahora a continuación de mecanismos de bloqueo eh total y luego podemos hablar de mecanismos de bloqueo local bien Voy a eh vamos a ver voy a hacer lo siguiente claro como yo en este caso en esta máquina no tengo Ay mira eh No tengo eh Edge vale No tengo Microsoft Edge pero tengo firefox vale vamos a suponer eh vamos a ver php detect is If browser is firefox porque por lo que sea imagínate vale correcto vale en las semanas anteriores de hecho dragos Nosotros hemos hecho que si detectaba que un usuario ponga pusiera Drop database lo que hacía era bloquear la ejecución pero no bloquear el sistema con lo cual el usuario podía volver a intentar y volver a intentar y volver a intentar y volver a intentar con lo cual nosotros podríamos eso que hicimos el otro día y decir No es que si alguien te hace un Drop database no solo es que haces un Die Es que además vas a crear el archivo log txt Por qué Porque si alguien te está haciendo un Drop database es que nada bueno va a ocurrir a continuación quiero decir esa persona no creo que te haga un Drop database y se pare ahí sino que probablemente lo va a intentar hasta que lo consiga con lo cual La idea es en el momento en el que detectes que ant que alguien lo está intentando bloquea la aplicación vale bloquea la aplicación para que esa persona diga vale o sea esto ha bloqueado y no voy a poder seguir probando qué ocurre Pues que como siempre suele decirse pagan justos por pecadores es decir a continuación vas a recibir una llamada de la empresa diciendo Oye es me apece un candado vale a lo cual pues tú como administrador del sistema tienes que decir mira Sí es que hay un sistema de protección que en el cual Pues cuando se detecta un intento de ataque el sistema se bloquea por precaución vale con lo cual pues Por una parte se van a en tus muelas Porque de repente la gente de la empresa ya no puede seguir trabajando hasta que tú lo desbloquees Pero por otra parte en el momento en el que les razonas de Mira es que había alguien intentando atacar el sistema y qu prefieres que se bloquee o prefieres que no se bloquee y que te roben los datos y cualquier empresa dice bueno Vale pues que se bloquee sabes O sea que sí correcto dragos A eso me refiero vale o sea la idea no es insertar como comentábamos ayer un solo mecanismo La idea es insertar tantos mecanismos como sea posible dentro de lo razonable Y de forma proporcional al tipo de organ ación de la cual estemos hablando quiero decir que si esto fuera peluquería Pepe con todo lo respeto a las peluquerías pues probablemente no hay mucho que hackear en una aplicación de una peluquería pero si es el banco Martínez Pues un banco igual hay información de más sensible sensibilidad que una peluquería vale por poneros un ejemplo no bien Entonces vamos a ver eh A continuación vale Yo por ejemplo voy a crear una serie de condiciones así que vamos a ver aquí a continuación en morir me voy a crear un archivo nuevo llamado s firefox php un archivo muy tonto pero bueno así que vengo por aquí pego el archivo is firefox Y entonces en este caso lo que voy a hacer es decir eh If is firefox create file log.txt Uy será verdad XT TR que pas alg vale Hola ahora Ah vale Sí que lo había pillado bien copio código pego Vale y vamos allá eh vamos a ejecutar Esto entonces Yo vengo por aquí vo hacer un simulacro me voy a proyecto me voy al poder de la muerte me voy a cliente eh quito un momento el lock vale me voy a Inc me voy a firefox php You Are Not using firefox no file created pero yo ahora abro firefox creo que no lo he usado casi nunca aquí en este equipo Hola ahí abriendo vale uso firefox y dice Ah file to create vale file to create básicamente porque hay un tema de permisos Ok venga No pasa nada así que me voy aquí a eh proyecto terminal vale sudo Hola vale sudo pH mod 777 men r proyecto pongo no pongo Esto vale Okay y ahora como os decía entro con firefox vale file log txt created y por tanto si intento entrar desde aquí un momento dónde me has creado el Loc me lo has creado ahí no dos punos bar log txt vale Yo puedo entrar pero si alguien intenta entrar con firefox en ese caso ya no puedo entrar porque se ha bloqueado vale esto quiere decir ahora a continuación me vengo por aquí y en morir php lo que hago es decir include es firefox php vale desbloqueo elimino Vale entonces entro You Are Not using firefox esto no hace falta ponerlo un momento es firefox no me hag secos o sea Ok Vale pero no me haga secos Okay vale Y ahora alguien entra por aquí pero entra con firefox vale ha entrado con firefox recargo dónde se ha creado a ver eliminar Okay entramos con firefox Sí hola dónde lo has creado yo Ah mira me lo ha creado ahí o sea entonces es este de aquí vale Ahora sí recargo vale Y ahora sí bloqueado y se ha bloqueado también para PC insisto vale José Manuel ahora ya entiendes el poder de la muerte vale poder muerte es el poder del bloqueo lo que pasa es que no soy yo el que le ha puesto el nombre a la función si la función se llama Die Pues es que se llama die no le he puesto yo el nombre que no es que me parezca mal nombre Sabes porque realmente se muere la ejecución pero bueno entonces qué ocurre Pues que yo ahora a continuación tal y como comentaba pues le puedo poner por ejemplo temas de bloqueo por ip es decir de la misma forma que aquí en Inc he puesto es firefox puedo poner bloqueo iip php y en bloqueo aquí por supuesto hago include bloqueo iip php de tal forma que si por ejemplo detecta que una IP está fuera del Rango de ips de España pues crea el archivo txt y a continuación en cada ejecución el sistema detecta si existe el archivo log TX Y si existe el archivo log XT se queda frito vale bien no no dragos no lo que hace el sistema de hecho estaba por aquí eh Esa vale es lo siguiente si el archivo existe no hace nada porque ya alguien lo ha creado de hecho el sistema de hecho dice si no existe créalo en caso contrario no hagas nada vale por tanto primero que no a sobreescribir el archivo y segundo que gracias a esta estructura de control la primera persona que cree el archivo la segunda ya no puede crear el archivo pero ya te digo que en todo caso no estaríamos creando 100 archivos logs diferentes sino que se machacar el mismo vale Supongo que lo estás preguntando por un ataque de denegación de servicio es decir eh Porque o por un ataque de denegación de servicio o por un desbordamiento de archivos en disco duro es decir si cada ataque te crea una archivo te empiezan a atacar centenares de miles de veces te llenan el servidor de archivos y te bloquean el servidor vale o sea que sí ya te digo no es descartable de hecho quieras que no el ataque de ddos Es decir de negación de servicio Sigue estando ese peligro Pero la idea es minimizarlo vale Voy a preguntarle a chat gpt A ver si me da el código porque Mirad eh vamos a ver eh vale php check If IP comes from Spain using Cómo se llama esta base de datos geog IP Data sqlite maxm Esta es using Esto vale hay una base de datos que es gratuita que es de ips vale que es una base de datos en formato IP perdon en formato seite quería decir y a continuación en el caso de que vuestra instalación de php soporte ese cite o tenga activado ese cite se puede hacer una petición para indicar que solo queremos permitir ips de España vale ahora a continuación voy a hacer lo contrario es decir voy a bloquear ips de España Así que copio código lo digo por si alguno tenéis alguna upn preparada copio código me lo pongo aquí en include me voy a archivo nuevo y digo geoloc geolog IP php vale le pongo Esto me voy a descargar maxmind geolog database vale Max Mind sí databases espérate aquí está Vale Quiero la gratuita de sí pero a ver es kulite ah no Aquí sí hay una que es gratuita a ver si es que ya no la dan si no la dan yo la tengo en alguna parte de mi servidor también os lo digo tendría que buscarla aquí que buscarla vale Pero bueno creo que ahora mismo no la puedo obtener eh una cosa un momentín espera me tengo que un sentar 5 minutos dme un segundo Porfa y ahora vengo Me dejo esto abierto