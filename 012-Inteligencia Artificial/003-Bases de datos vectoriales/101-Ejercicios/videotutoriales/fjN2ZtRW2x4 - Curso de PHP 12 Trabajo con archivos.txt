php tiene un set de funciones específicamente diseñadas para ser capaces de leer y escribir de archivos de texto plano en el disco duro o directamente en el servidor web esto no sustituye completamente al uso de bases de datos con lenguaje sql pero hay algún caso como el que veremos en el vídeo a continuación en el vídeo siguiente de este donde puede tener cierta utilidad vamos a hacer un ejercicio donde he creado una carpeta llamada flat files dentro de esa carpeta he creado dos archivos de momento vacíos uno llamado flat files php y un archivo de texto plano texto punto txt esto pudo txt ahora mismo está vacío está completamente vacío y en flat file punto txt voy a escribir el siguiente contenido la primera que voy a hacer es crear una variable donde define el archivo en el que voy a escribir que como sabemos se llama texto punto txt a continuación voy a escribir el contenido que quiero escribir mediante php dentro de ese archivo txt este es un contenido y ahora necesito dos cosas una un manejador un hamlet en inglés traducido directamente en el que al que le igualan la función efe open habiendo el archivo como e indicándole el modo en el que voy a trabajar en este caso el modo de trabajo que más suelo usar es a plus lo que hace es abrirlo en modo de lectura y escritura y en applus lo que hace es a penn al final del archivo hay otros modos donde lo que hacemos es abrir un archivo borrar todo su contenido y escribir archivo nuevo a mí lo que me suele interesar es abrir un archivo respetar el contenido que ya había pero poner nuevo contenido al final del archivo por eso voy a usar a plus como modo de apertura y por último voy a usar otra función primero efe open para el archivo no puedo escribir nada sino abierto previamente el archivo y ahora que lo tengo abierto ago efe rail para escribir y que voy a escribir puede ser el manejador voy a escribir el contenido es decir en el archivo indicado voy a escribir ese contenido voy a guardar voy a ejecutar flat files php en principio no me devuelve ningún resultado en pantalla pero si ahora vuelvo a texto punto txt me dice el archivo ha cambiado quiere volver a cargar sí que desee volver a recargar y compruebo como aquí aparece este es un contrario si ahora ejecutó varias veces el archivo flat files php y vuelvo a archivo recargo y lo que he hecho ni más ni menos que es lo que he hecho es escribir varias veces este es un contenido dentro de el disco duro por tanto como estamos viendo lo que hemos conseguido es mediante php escribir el contenido en un archivo de texto plano en un archivo de texto punto txt alojado en el servidor un ejemplo claro de para que podemos usar una guardador de archivos flat file en archivo plano al disco duro puede ser un sistema de creación de logs de registros de visitas de una página los logs de una página se escriben desde luego se escriben bastante frecuentemente pero y luego únicamente se lee y no se suele requerir actualizarlos ni borrarlos porque la idea de un log es muchas veces escribirlo ni siquiera leerlo tenerlo ahí por si acaso pasa algo y si hacemos algo con él desde luego es únicamente leer por tanto si no vamos a usar ni update ni y feliz nada de esto podemos hacer un sistema de logs voy a ponerlo php con texto plano por hacer un blog php como archivo que gestionará esos blogs y 1.0 aquí está la gracia donde almacenar en texto claro sí pero al final en un formato de archivo separado por comas de tal forma que en un momento dado podamos abrir incluso desde lo directamente con un programa de hojas de cálculo como excel o cómo operó fiscal voy a abrirlo punto php voy a crear un pequeño script que lo que haga es registrar los accesos a esta página el archivo al que nos voy a trabajar es blog punto csv aunque en principio esta función está pensada para trabajar con archivos de texto plano no pasa nada por engañar al programa y hacerle creer que un csv es un archivo de texto plano cuando realmente uno realmente lo es contenido el contenido que voy a escribir será el siguiente el contenido va a ser separado por comas va a ser la cantidad de segundos que han pasado en la región ix y encadenó con una coma y ahora quiero el año voy a copiar esto unas cuantas veces ahora quiero el año en un mes y quiero corregir en y vuelvo a ser para poner con coma y lo que quiero ahora por ejemplo es sacar la ip del archivo en el que estoy trabajando por tanto voy a hacer que voy a decirle que la variable ip es igual a la variable del entorno remote habrás además quiero saber el navegador con el que la gente entra a mi web con lo cual el navegador es igual a variables del servidor y entre comillas http jon bajo y usher bajo el de la gente con el que están entrando a esta web por tanto voy a quedar a la hora con live entonces una vez más con coma encadenó ahora con la variable navegador es importante al final voy a encadenar con contra barra en contra barra n equivale a retorno de carro en archivos de texto plano por tanto ahora ya puedo volverá al manejador es igual a f donde apunto al archivo y le digo que lo abro en modo a mayúsculas ap en mayúsculas por último ejecutó el baile manejador como contenido si no he cometido ningún error y espero que no vamos a asegurar nuevas del daily rate el año es y el mes examino de minúsculas el día es de minúsculas yo lo que hago es guardo y ejecutó los php y se hará cargo blog csv compruebo como estoy guardando los datos que especificado en un archivo de separado por comas voy a ejecutar varias veces lo csv y comprobar como cada vez que lo ejecutó se crea a ver que he guardado voy a ver como cada vez que lo ejecutó se crea una nueva línea de registros por tanto lo que tengo aquí como puedo comprobar es un registro de los accesos que ha tenido a mi web y lo interesante aparte de que dijo que alguien capturando el utc el año el mes el día la ip y el navegador que se ha usado es que estoy trabajando con un archivo separado por comas que ahora podría por ejemplo cargar en una hoja de excel si ahora voy a abrir este archivo un segundo y ahora lo muestro en pantalla yo tengo por aquí la sal y si ahora cojo ese csv le digo que lo abro con un libro fiscal o con openoffice calc o con excel con lo que queramos nos separó por coma y delimitará texto es ninguno porque he recibido como podemos ver puedo abrir ese archivo que guardado mediante php con una aplicación de hoja de cálculo como por ejemplo excel u openoffice calc y esto es interesante como vemos aunque aquí parece que se ha enganchado porque había una coma del texto y bueno cómo arreglar esto ya que estamos porque ha pasado esto porque ha dividido estas columnas vamos a verlo esto ha sido por la sencilla razón y que el navegador incluye una coma por tanto la coma parece que en este caso es un mal símbolo para separar el texto así que lo que podría hacer una cosa que se suele hacer bastante en los csv es hacerlo siempre dejar esto por aquí voy a poner esto allí y lo que voy a hacer es separar no sólo con comas sino también delimitar con comillas en este caso tendría que poner contra barra comillas como carácter de escape así que ahora pongo contra barra comillas antes y después de cada coma y aunque parezca mentira lo que voy a hacer con esto voy a poner contra barras comillas y por último n es al escribir al ejecutar el log php ahora lo que estoy haciendo es separar cada uno de los valores con comillas por tanto esa coma sacó mal que tengo aquí ya no se va a ver afectada voy a borrar todo el log porque ahora tengo registros anteriores incorrectos y registros nuevos correctos voy a ejecutar de nuevo el script varias veces ejecutó recargo para comprobar que ahora está separado todo el principio está correcto por comillas y si ahora vuelva a abrir ese archivo lo csv con calc vamos a verlo por aquí lo que voy a hacer ahora es decir que los campos están separados por comas y que el delimitador del texto es comillas porque se haga acepto comprobar como ya no ha afectado esa coma que tenía ahí he dejado por lo que veo alguna coma en la ip voy a seguir corrigiendo en la idea efectivamente acuerdo destruyó estos registros cierro que está abierto bien estaba abierto y ahora me dice que hay un error en la línea de 7 hay un error porque eso está mal pegado realmente mal aquí ejecute ahora llamada error y ahora vuelvo la csv parece que esté correcto y si ahora lo recargo en la base de datos en la hoja de cálculo compruebo como ahora si ahora sí que está correcto yo de todas formas tengo un truco para esto de los archivos de texto plano que es el siguiente el problema es que una coma es un carácter muy común es demasiado común por tanto yo lo que suelo hacer es usar un carácter que no sea tan común como una coma los archivos de como el psv es como más separado the values en principio están pensados para ser separados con comas o con puntos y comas pero la coma y el punto de coma son dos caracteres que están condenados a dar los problemas porque son muy comunes por eso yo lo que suelo hacer es poner en lugar de coma para buscar una en lugar de coma sin pulso al cr el número 1 del teclado tengo una barra vertical al xerez y número 1 digamos la barra de hora esta barra sé que es muy poco frecuente y si ahora ejecuto el script con esta barra voy a borrarlo todo está abierto en la hoja de cálculo ahora sí y ejecutó varias veces el log comprobar como el resultado es que en lugar de comas estoy separando los valores mediante estas barras verticales usaré las barras verticales a mí me suele dar buen resultado para que el programa no confunda comas separadoras caracteres separadores con caracteres internos de los registros