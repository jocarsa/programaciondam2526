Vamos allá y una vez que tenemos este código a continuación quiero hacer un programa como siempre os digo parecido al que hemos hecho hasta ahora pero con un pasito más Qué quiere decir con un pasito más pues por ejemplo 003 menú Yo vengo por aquí y digo que esto de momento fuera y ahora digo true print programa de gestión de clientes print un insertar un cliente print dos listado de clientes y voy a poner print 3 y pun suspens Así que input o opción es igual a input selecciona una opción y el típico lo que hacemos Todas las semanas print la opción que has escogido es opción f5 he escogido la uno la opción que has escogido es la número uno y vuelvo a empezar ahora a continuación lo que hago es que 004 If y como todas las semanas digo si opción es igual a 1 en ese caso print vamos a insertar un cliente y ya If el If opción es igual a print vamos a listar los clientes hasta aquí reconoceréis la misma estructura de todas las semanas correcto bien pero ahora a continuación es cuando yo vendría 005 preguntar por los punto python y yo vendría y diría vamos a ver un cliente qué tiene Pues un cliente tiene aquí estructura tiene nombre así que nombre es igual a input introduce un nombre apellidos introduce apellidos email introduce un email población introduce una población fecha de nacimiento introduce una fecha de nacimiento Así es como hemos estado haciendo las cosas Hasta ahora y así han funcionado porque hemos hecho programas completos que funcionaban pero en informática Cuando hacemos las cosas varias veces nos debería sonar como una campanita que nos diga algo estás haciendo mal vale Porque si yo ya tengo esto aquí para tengo que para qu tengo que ponerlo otra vez a mano aquí y es más claro esto es una tabla pero Espérate que tengo más tablas y cada tabla tiene sus propios Campos Eso quiere decir que voy a tener que picar todos los campos en el programa de python me voy a tirar un buen rato Así que lo que voy a hacer hoy es el programa que trabajamos siempre pero avanzar un poquito más adelantarlo un poquito más diciéndole que soy vag y no quiero tener que poner manualmente cada uno de los campos sino quiero que el programa los ponga por mí esto a nivel conceptual va a ser un salto adelante bastante fuerte porque esto es lo que se llama abstracción es la contraposición entre concreto y abstracto nosotros hasta ahora hemos estado programando en concreto Eso quiere decir que nosotros especificamos exactamente lo que tiene que ocurrir y evidentemente aquello que pongamos tiene que coincidir con lo que hay en la base de datos Porque si no mal asunto programar en abstracto quiere decir que en lugar de meter nosotros manualmente todos y cada uno de los campos Nosotros le vamos a decir no ves a la base de datos y pregúntale qué Campos hay y con lo que te diga vuelve y hablamos vale cómo vamos a hacer esto pues vamos a hacerlo de la siguiente forma 005 le pregunto a la base de datos Y entonces me quito todo esto de aquí y digo eh cursor execute Y digo vamos a ver digo Show columns in clientes vamos a ver que nos dice el cursor Así que digo ahora fila es igual a cursor fetch one y digo Perdón filas y digo for fila in filas print fetch One creo que lleva es un método y lleva paréntesis print fila a ver qué ocurre le doy a f5 le doy a uno opción un y me dice Field type null key default extra Vale ahora a continuación voy a decir Ok continúa Es más no espera aquí cursor FR One vale uno y Ok espérate porque vale le he dicho diccionario es igual a cursor un m colums en clientes vamos a ejecutarlo contra aquí sql aquí Show colums en clientes Entonces estoy viendo los campos Field type null y tal vale que es F type null Y tal Pero no estoy viendo voy a decirle fetch all un ahora sí Field identificador type entero null no key primary si os estáis dando cuenta en lugar de darme los datos me está diciendo las columnas que hay y me está diciendo que hay una columna llamada identificador otra nombre otra apellidos otra O sea no hace falta que lo ponga yo la base de datos me lo puede decir así que ahora vengo y digo okay Venga pues lo meto en un listado entonces vengo y digo campus es igual a lista y ahora digo Campos pun apen fila de Field Por qué Field porque lo pone ahí vale fila de Field y ahora al final print Campos f5 1 y los campos son identificador nombre clientes apellidos email población fecha de nacimiento esto qué quiere decir pues esto quiere decir que yo ahora os pondré comentarios ahora digo for campo in campus voy a decirle input introduce el valor para el campo vale Mirad f5 1 introduce el valor para el campo identificador introduce valor para el campo nombre introduce el valor No es que no lo veis un momentín que está ahí abajo introduce el campo para apellidos introduce el campo para email introduce el campo para población para fecha de nacimiento y se para pero os dais cuenta de que yo no he tenido que hacerlo o sea yo no he tenido que decir nombre apellidos fecha yo he ido a las columnas y le he dicho no dime tú qué datos tienes yo qu sé es más mira ahora yo me puedo ir a mysql y le puedo decir mira en clientes acabo de decidir porque me da la gana que después de fecha de nacimiento voy a ponerle un campo llamado país Por qué Porque yo lo valgo y yo simplemente daos cuenta ya se ha enganchado otra vez sí se ha enganchado otra vez no sé por qué este mysql se engancha con las cosas más tontas pero bueno a ver un momentín eh home server Ah No espérate esto es el servidor cerrar vale Ay sudo service e my sql restart vale venga mi empresa Okay venga clientes eh estructura vale fecha de nacimiento es que no sé por qu Mira escucha quito fecha de nacimiento a ver quito fecha de nacimiento vale lo he quitado Ahora vuelvo a ejecutar el programa selecciona opción uno identificador nombre apellidos email población y no me pide fecha de nacimiento Por qué Porque me la acabo de cargar de la tabla de la base de datos vale Fran es bueno que el identificador lo podamos poner nosotros por regla general no hay casos y hay excepciones todas las que quieras pero por regla general Debería ser la base de datos la que gestionará esa excepción Entonces ahí no pasa nada porque yo lo que puedo hacer es poner un pequeño If vale No repetir no se puede repetir eso es imposible porque dará error May sq vuele otra cosa es que podamos meter saltos en los identificadores eso sí que se puede hacer y a veces es incluso bueno Vale pero mira Fran ignoramos el identificador y yo entonces Fran mira lo que hago es venir por aquí y decir a ver si aquí si el no Exacto el error Exacto si el key es PR es decir si la clave es primaria No me preguntes por esa clave porque no la gestiono yo la gestiona la base de datos Vale entonces yo digo si vamos a ver si momentín si fila K es igual o no es igual a PR Pero diréis por qué Pride Pues porque lo estoy leyendo de aquí o sea lo bueno de sacarlo en js Es que python te chiva todo lo que tienes que poner Vale entonces si Ke no es pray Campos aen fila vale que incluso te digo más aquí podría meter directamente el input y me cargo esto de aquí y así ahorramos líneas introduce el campo para fila Field entonces simplemente con esa Es que fíjate Fran que lo he hecho con el pri Y no con campo es igual a identificador porque igual más adelante no se llama identificador se llama de otra forma Vale entonces f5 selecciona una opción y Fíjate que me pregunta el nombre se ha ido directamente al nombre pero no me ha preguntado la clave primaria Por qué Pues porque me la ha ex saltado es como lo que sea clave primaria no me lo preguntes porque no lo gestiono yo vale voy a comentar un poco el código claro la clave primaria será siempre primaria Por eso te digo que me lo salto Pero si tú en un programa dijeras No es que yo quiero indicar que es la clave primaria pues Oye quitamos esta línea de código y asunto solucionado Entonces en este caso sí como hemos quitado la clave primaria y la gesa sql si la base de datos cuando tú introduzcas un nuevo valor o sea un nuevo registro será por ejemplo si hemos tenemos la clave primaria 50 la siguiente 51 No sí correcto Ah vale o sea nosotros ahí vale por la combinación de tres cosas primero porque le hemos puesto clave Primaria segundo porque el campo lo hemos puesto de tipo número entero y tercero porque activamos el flag de autoincremental entonces esa combinación de tres cosas hace que nosotros no nos preocupamos porque ya se preocupa el gestor de bases de datos claro y por ejemplo si ya existiese un no O sea si nosotros o sea me refiero si nosotros en vez de eh quisiéramos también registrar el la clave primaria y poníamos una que ya existe haríamos un update verdad O sea lo Claro claro evidentemente o sea si nosotros intentamos insertar un registro nuevo con un número de primary que ya existe esa inserción va a dar error ahora otra cosa es que yo venga a un cliente y diga al cliente número dos le quiero cambiar el correo electrónico claro eso ya no es un insert sino que es un update efectivamente V técnicamente a lo bestia pero bueno a lo bestia sería muy bestia vale hay una forma que es que me copio el registro le modifico los datos elimino este registro y creo un nuevo registro pero claro entonces la clave primaria cambiaría con lo cual los datos asociados en otras tablas también pueden cambiar donde ya que rastrear el resto de tablas para actualizar datos Pero bueno en sql lo más sencillo evidentemente es un update vale entonces ahora Yo vengo por aquí voy a comentar un poquito esto Más que nada porque esta parte es la que quiero que os quede Clara porque es la novedad entonces en primer lugar Quiero un informe de qué columnas tiene esta tabla porque a continuación las meto en una lista y ahora este Campos Al final no lo estoy utilizando Insisto que intento simplificar el código lo máximo posible y ahora digo para cada una de las columnas me salto la columna que sea clave primaria y permito al usuario introducir un nuevo valor ojo fijaos una cosa y es que donde clientes si yo vengo aquí y digo por ejemplo productos vale yo simplemente cambio Perdona Select columns in productos le doy a f5 y me dice introduce el valor para el campo nombre para el campo descripción para el campo precio luego simplemente cambiando una palabra me ha cambiado el formulario de clientes a prod vale por qué porque esto ya se encarga de hacerlo automáticamente bien lo que pasa es que es un salto adelante porque este código pues es más sencillo que el de días anteriores pero es más complejo de entender porque es como Dónde está ah el nombre y los apellidos y tal pues técnicamente está en que aquí se lo está dando pero tú no lo ves tú no ves nombre en el código Fuente del programa vale bien Ahora a continuación yo digo vamos a ver ahora sí almaceno en un diccionario vamos a ver espera que te lo digo vale e almaceno los datos en un nuevo diccionario o diccionario espérate no en listas y entonces digo No aquí columnas es igual a lista valores es igual a lista y entonces vengo por aquí y digo vamos a ver valores punto append a esto de aquí y columnas punto append fila Field al finalizar todo esto al finalizar todo esto y ahora vengo por aquí y digo print columnas print datos f5 selecciono una opción y digo nombre José Vicente apellidos carratalá email info @hara3131 y me dice los campos son nombre apellidos email población los datos son José Vicente carratalá inform bajo carsa Valencia eso qué quiere decir pues que ahora formateo una petición sql 010 formateo petición sql y digo petición es igual a insert into clientes vales y digo for columna in columnas petición más igual a columna más coma petición más igual paréntesis values y digo for valor in valores petición más igual eh valor más coma petición más igual paréntesis y print petición Y diréis qué puñetas acabas de hacer ahí pues la veréis hago f5 selecciono una opción inserto un cliente el nombre es José Vicente apellidos carratala email info @jaru nombre apellidos email población Perdona eh el valius es de sobra valius José viicente carratala inf Valencia lo que he hecho básicamente ha sido los datos y formatear una petición pero daros cuenta de que si yo ahora vengo aquí y digo Mira la población Me la voy a cargar vale población me la cargo me cargo la población Oh qué Manía de quedarse frito es que no lo entiendo no sudo service my sqli restart no sé por se me queda frito con las operaciones más tontas clientes Vale ahora estructura quito población vale Ya está y ahora Mirad atención f5 inserto un cliente José Vicente carratala info @ocaadu 011 comentarios y arreglos el valius este vamos a ver correcto Fran eso es literalmente lo que queremos hacer Exacto vale lo que queremos hacer es que o sea una cosa que da mucha rabia en programación es que cada vez que hay un cambio y habrán cambios ya lo veréis no tengas que tocar ese mismo cambio en cinco lugares diferentes sino que tú digas Oye lo toco en un sitio y ese cambio se propaga a al resto Vale pues eso es exactamente lo que queremos entonces voy a poner comentarios para que sepáis lo que estamos haciendo vale vamos a ver creo un listado de columnas listado vacío ahora mismo creo un listado de valores ahora añado la columna a la lista de columnas permito al usuario introducir un nuevo valor y lo pongo en la lista de valores Vale ahora insert into clientes empiezo a formatear una petición y ahora digo para cada una de las columnas para cada una de las columnas le añado a la petición el nombre de la columna le añado el anticipo de los valores y ahora para cada uno de los valores le añado a la petición el valor cierro el último paréntesis y imprimo la petición para que sepáis lo que se va a ejecutar ahora luego lo ejecutaremos contra la base de datos pero de momento lo imprimo para que os hagáis una idea de para qué hacemos todo esto vale bien Vamos a ver un momento vamos a ver Okay Ok momento por aquí W true bien Ahora tengo que hacer una cosa aquí tengo que hacer esto aquí tengo que hacer esto y aquí como habéis visto Mirad uno a bbb ccc Mirad me sobra la última coma esa coma de ahí es ilegal porque a cada uno de los campos le meto una coma detrás le meto una coma detrás le meto una coma detrás la última coma sobra entonces hay un truco en python que consiste en python remove Last character from String y aquí está Entonces esto lo pongo aquí y le digo no petición es igual a petición men 1 y Pongo aquí le quito la última coma al listado de Campos y repito por aquí no aquí y le quito la última coma al listado de valores aquí qué va a hacer esto Pues que si lo ejecuto uno no quieto calma lo ejecuto uno AAA bbb ccc vale insert into clientes nombre apellidos email valies AAA bbb ccc es decir esto ya está preparado para ser insertado en la base de datos pero os daréis cuenta como aquí no pone nombre apellidos email sino que lo saca dinámicamente de la base de datos Y si no se me fastidia la base de datos voy a probarlo otra vez me voy a clientes me voy a estructura y voy a Añadir cuatro Campos después y si no se me fastidia voy a decir eh campo dirección es un marchar país es un marchar código postal es un marchar y comentarios es un text previsualiza sql por si se fastidia le doy a guardar ya te digo yo que se ha fastidiado no sé por qué no sé por qué tontería Me tocará Reinstalar vale estructura sql así continuar y ya está ya ves tú qué tontería vale acabo de modificar clientes Les acabo de meter cuatro Campos más lo habéis visto en sql pero yo ahora vengo a python le doy a f5 inserto un cliente nombre José Vicente apellidos carratalá ahora email info@.com.ar la calle de José Vicente País España código postal 46014 comentarios Hola qué tal y os dais cuenta como si yo he modificado la tabla mysql automáticamente python se modifica le doy a enter y ya a partir de ahí en este caso ya sabéis Que de momento me está poniendo un insert pero donde me está haciendo un print en insert Pues yo lo que haría es meterlo en la base de datos vale vamos a hacerlo así que eh ejecutar Y entonces vengo aquí y digo conexión punto eh No cursor punto execute petición y conexión commit Así que le damos caña f5 voy a ver un cliente que no tenga la base de datos Carlos Gómez Cristina nombre desde python José Vicente a Pascual lo tengo Vale pues vamos con Andrés vamos a ver inserto Andrés apellidos Ruiz el segundo cuál era Torres vale email Andrés @ ruiz.com dirección la calle de Andrés País España CP mislata Ah Espera 46920 comentarios Esta es la entrada de Andrés me cago en la mar connection qué rabia vale uno Andrés Ruiz Torres campo info @andres comom dirección la calle de Andrés eh España 46 920 comentarios Esta es la entrada de Andrés enter y si yo ahora me voy a la base de datos le doy a clientes y ahí abajo tenemos a Andrés vale pero date cuenta de que yo aquí no le he dicho qué Campos tiene que hacer ni en la petición sql le he dicho qué Campos tiene que venir porque lo que hago es que base de datos Dime qué Campos tienes y si la base de datos me dice qué Campos tiene no me puedo equivocar porque los campos son los que la misma base de datos me ha dicho vale esto como ya os digo a ver un momentín Sí a ver lo de los paréntesis que es esto de aquí mira eso como mejor lo voy a explicar es esto de aquí vale es esto de aquí es la petición sql Mira entonces la petición sql me voy a ir al editor de textos Porque esa parte es muy abstracta esto fuera y esto para cron esto es de segundo vale Ok Esta es la petición Y fíjate que yo tengo insert into clientes comillas Esto es lo que tengo en el primer print ese de ahí ahora bien a partir de aquí tengo petición columna y coma petición columna y coma por cada una de las columnas tengo eso y luego tengo eh cierre de paréntesis vales apertura de paréntesis cierre de paréntesis valius apertura de paréntesis y a continuación tengo cada uno de los valores cada uno de los valores Claro Por qué les pongo comillas Pues porque para los nombres de columna no hace falta comillas pero para los valores cuando estos valores son de texto sí que les hace falta comillas entonces un momentín que lo haga más pequeño Entonces esto de aquí es esto de aquí Espera que lo haga esto más pequeño también aquí vale esto de aquí es esto de aquí ahora for columna in columnas vale for columna in columnas es esto de aquí todas y cada una de las columnas claro sería un chorizo que te cagas evidentemente Vale ahora una vez que he acabado esto Esta línea de aquí es esta línea de aquí cierro paréntesis Val abro paréntesis hasta aquí esto de aquí for valor inv valores es esto de aquí para cada uno de los valores los imprimo en la pantalla y por último esto de aquí petición has acabado con los valores ciérrame la consulta vale lo difícil de esto en este caso es que pues tenemos que visualizar digamos que pues que esta petición al final la estamos construyendo la estamos cosiendo literalmente a partir de retales a partir de trozos Y esa es un poco la dificultad Vale cuando lo hacemos en concreto se entiende perfectamente pero cuando lo hacemos en abstracto tenemos que entender que cuando aquí ponemos un for es un número a priori desconocido de elementos y cuando ponemos un for es un número a priori desconocido de elementos y esto es lo que os decía antes de que esto complica el entendimiento del código pero a la vez mejora la reutilización del código Vale y efectivamente Fran y esos datos tienes que tenerlos en la mente la buena noticia es que dentro de que es cierto que esos datos tienes que tenerlos en la mente la buena noticia es que en sql son cuatro peticiones principales tienes que tener en la mente el Select el insert el update y el delete O sea no hay 40 sentencias que tener memorizadas sino con que tenga esas cuatro en la mente ya puedes funcionar Vale entonces eh ahora a continuación vamos a hacer el cambio a la clase de inglés y ahora luego en la siguiente parte de la clase es decir en la siguiente parte que será programación pues Seguiremos hablando de python pero también Seguiremos hablando de bases de datos Entonces ahora a continuación hacemos Break y os vais a inglés que de hecho utilizáis esta misma sala con lo cual ahora me saldré yo para que Alice pueda entrar y ahora cuando acabe Alicia continuamos con las siguientes TR horas que es programación entornos de desarrollo y proyecto intermod y después una fantástica reunión de vecinos de la cual soy el presidente O sea que mi tarde de hoy va a ser fenomenal así que Hala eh paro por aquí