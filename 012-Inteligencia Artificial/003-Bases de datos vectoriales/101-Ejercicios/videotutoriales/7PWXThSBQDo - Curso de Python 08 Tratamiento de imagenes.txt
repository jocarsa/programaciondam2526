Bueno pues vamos a ver eh A continuación voy a hacer lo siguiente vamos a ver tengo por aquí en la carpeta de curso de python unas imágenes que dejé el otro día momento unas imágenes que dejé el otro día aquí están ahí están Vale entonces tengo estas imágenes eh Ya te digo puedo cualquier otra realmente me da igual vale pero voy a una de Entonces por ejemplo esta primera se llama josev viicente jpg voy a obtener es una imagen que tiene 400 por 400 píxeles en este caso eh lo primero que voy a hacer hoy es trabajar con una librería que empezamos a utilizar creo que la semana pasada no la anterior una librería llamada pil que me sirve para tratar imágenes y para realizar eh operaciones con estas imágenes entonces eh esta librería se nos quedó pendiente de instalar porque tenía que actualizar el python del sistema python 3 ya lo tengo actualizado y por tanto he podido instalar la librería y a continuación quiero hacer una demostración de cómo tratar imágenes eh Cómo poder leer píxel a Pixel Y cómo ahora luego vamos a poder o ahora luego el próximo día no sé cuándo depende de cómo nos rinda la clase pero Cómo podemos utilizar esta librería para realizar trabajos con grandes volúmenes de datos y aplicar técnicas de ma learning y de Deep learning para el tratamiento de imágenes por ejemplo para reconocimiento de formas Entonces vamos a ver en primer lugar lo que voy a hacer es que de la librería pil quiero importar todo aquello que tenga que ver con imagen ahora luego importar más cosas de la librería pil para dibujar algún rectángulo o algo así para que veamos que se pueden hacer más cosas vale Pero ahora verás a continuación digo lo siguiente digo imagen es igual Por cierto voy a guardar esto en escritorio en curso de python en por date en python pixels Vale y digo imagen es igual a image. openen y voy a cargar la imagen José viicente jpg Vale entonces a partir de ahí lo que voy a hacer es lo siguiente digo píxeles es igual a imagen punto load básicamente lo que quiero hacer es cargar la imagen una vez que tengo esto yo puedo por ejemplo realizar acciones con la imagen por ejemplo imagen voy a imprimir Esto vale a ver qué pasa en la pantalla y me dice que la información completa o sea el volcado de toda la información es el siguiente estoy trabajando con una imagen a través de la librería pil La estoy cargando a través del plugin de carga de jpgs es una imagen el modo de la imagen es rgb en el 99% de los casos suele ser rgb hay otro modo que es yk pero no deberías utilizarlo nunca porque es muy incompatible lo que me interesa es que la Imagen tiene un tamaño un size de 400 por 400 y está en esta dirección de la memoria si veo que tengo un parámetro size Es que puedo venir aquí y puedo decirle Dame directamente el parámetro size Así que pulso f5 y me dice directamente te devuelvo una tupla de 400 píxeles por 400 píxeles vale lo cual es importante para las operaciones que vamos a hacer ahora a continuación ahora verás antes de continuar voy a abrir un segundo Photoshop Tú sabes que yo soy muy amigo del gimp pero una de las limitaciones que tiene el gimp es que no soporta imágenes en formato cmyk vale por eso estoy abriendo el este el Photoshop entonces voy a abrir en escritorio en curso de python imagen José Vicente okay Y entonces aquí en imagen en modo de color hay un color que es cyk del modo de color del cual probablemente nunca habí oído hablar Vale entonces pincho cyk lo convertirá a este modelo vale No pasa nada lo guardo como jpg que esto ya de por sí es una ver ración pero en fin cm yk vale para acordarme Cos suficiente cyk ok y ahora me vuelvo a python cargo la imagen cmyk voy voy y me dice que esta imagen el modo si te fijas este m yk entonces lo que quiero que veas es que ha reconocido el espacio de color de la imagen Entonces te cuento voy a abrir un text edit y te voy a contar algo muy sencillo Y es que rgb es Red Green Blue esto estaba claro ahora bien hay un modo de color para impresión rgb es para pantallas para luz para dispositivos lumínicos hay un modo de color que es cian magenta amarillo Yellow y yo toda la vida había creído que la k era de Black y sin embargo un alumno hace un par de años me dijo Oye es que no es black es Ski y yo es ki Vale entonces estuve comprobando que efectivamente era cierto porque si te fijas las impresoras de tinta digamos tienen claro Exacto como si imprimes con tres colores te salen una especie de gris chungo Vale pues tienen un cartucho adicional de clave de color negro Vale entonces eh lo que te quiero decir con esto es que estas imágenes están muy bien para impresión pero nunca se deberían tratar en programas tales como por ejemplo o en lenguajes o en entornos tales como por ejemplo en python de hecho que sepas que python como acabas de ver se traga las imágenes jpgn cmyk pero hay muchos otros programas muchos otros lenguajes de programación muchos otros entornos y librerías que revientan cuando se encuentran un jpg en formato cmyk porque hay un problema Y es que el jpg en formato cmyk no es oficial es un truco es como un off the road digamos es como algo que no debería existir Pero existe te lo digo porque he tenido alumnos que haciendo ejercicios como este que estamos viendo se han bajado alguna imagen de internet la imagen les ha empezado a dar fallo fallo hasta que casi se han roto los cuernos a ver para averiguar por qué puñetas Esa imagen da fallo hasta que hemos averiguado que es que la imagen estaba en cyk vale por eso es por lo que te he insistido lo de el tema del espacio de color porque como cojas una imagen y claro y no sepas que siquiera existe este espacio de color puedes est unas cuantas horas hasta averiguar cuál es el problema vale en ese caso evidentemente pues programas como por ejemplo Photoshop te pueden la imagen y de la misma forma que yo he cambiado de rgb a cyk también se puede cambiar de cig rgb hay una pérdida de la fidelidad del color de hecho Yo nunca me he puesto a calcularla un amigo mío hace años que también se llama José Vicente que es muy conocido se llama José Vicente Sanz no conocido dentro del mundo de la programación pero sí del 3D Pues el tío tuvo la paciencia de estar una tarde calculando porcentualmente cuál era esa pérdida de fidelidad que era mínima Pero hay una cierta pérdida Vale entonces vengo por aquí vale tengo la imagen original y ahora a continuación lo que voy a hacer es decirle al sistema voy a decirle al sistema que quiero averiguar Cuál es el píxel de color en un píxel concreto voy a algo sencillito voy a decir print Pixel píxeles en el ya te digo voy a empezar por algo sencillo en 0,0 Entonces en este caso lo que hace voy a decir imagen pun Size f5 y me dice Mira es 84 76 65 y yo digo pues fantástico me lo tendría que creer entonces para comprobarlo lo que voy a hacer es la imagen Ahora sí abrirla con el gimp vamos a ver abro la imagen con el gimp me voy al primer Hola me voy al primer Pixel de todos ahí arriba en la esquina me cojo el cuent gotas hago click pincho ese color y compruebo cuidado no en el rango de 0 a 100 sino en el rango de 0 a 255 y compruebo que 84 es 84 que 76 es 76 y que 65 es 65 luego acabamos de comprobar como el programa ha hecho correctamente su tarea que ha consistido en cargar la imagen y en primer lugar leer el color de un píxel y devolvérmelo como una tupla si esto ya está bien yo a continuación puedo hacer lo siguiente Y es que píxeles de 00 ahora cogemos el imagen punto size para vale para un elemento u otro entonces eh píxeles de 00 es igual a eh voy a hacer algo que sea fácilmente reconocible voy a poner 255 que es el color blanco entonces a continuación evidentemente lo que quiero es guardar la imagen saave y la voy a guardar en José Vicente png o.jpg me da igual lo que sea así que si todo ha ido bien pulso f5 vale si todo ha ido bien debe haber aparecido imagen llamada José Vicente guardado y igual no se ve Ahora mismo pero la voy a abrir con el gimp la voy a abrir con el gimp Y si todo ha ido bien me acerco ahí y voy a poder comprobar como efectivamente el pixxel que se encuentra en 00 tiene el color blanco tiene el color blanco porque evidentemente 255 en el canal rojo 255 en el canal verde y 255 en el canal azul equivale a rojo perdón a blanco quería decir entonces dicho esto ahora a continuación voy a guardar esto como otro archivo 58 recorrer píxeles y ahora a continuación voy a decir lo siguiente Yo podría decir altura es igual a 400 y anchura es igual a 400 pero tú me dirás que es más seguro que yo le diga en este caso que anchura es imagen pun size de cer y altura es imagen pun size de un voy a decir print anchura espera venga va f5 vale Y me dice que la anchura es 400 Por qué pues por una razón muy sencilla porque yo quiero que este ejemplo que yo estoy desarrollando ahora si tú ahora luego cuando acabe la clase lo coges y lo aplicas sobre una imagen que tenga diferente tamaño que quiero que el programa se adapte automáticamente al tamaño de la imagen si yo pongo 400 solo Tratará los primeros 400 por 400 píxeles te preguntarás Por qué no trata toda la imagen vale por eso es por lo que me interesaba el imagen pun size ahora a continuación voy a hacer algo que se salta a todas luces el zen de python Y es que si te acuerdas con el C de python había una de las reglas que era intentar no en inglés nestar es decir no anidar estructuras vale sin embargo vamos a ver un momen vamos a recuperarlo sin embargo me voy a apoyar me voy a apoyar vamos a ver flat is better than nested pero claro si yo tengo claramente a las luces en este ejercicio una matriz bidimensional de píxeles cómo sería flat Pues flat sería como cada una de las filas y ponerlas todas en una sola fila Y eso y te lo digo porque por ejemplo el framework Canvas en html5 funciona así Eso es más eficiente Pero te digo yo que es mucho más difícil vale es mucho más fácil en este caso digamos explícito es mejor que implícito Vale y que la legibilidad cuenta es decir voy a hacer un doble bucle for que se salta esta regla Pero eso también a la vez va a hacer que el código sea mucho más entendible entonces me vengo por aquí y digo for I in Range 0 coma anchura sabes qué tú ya sabes que yo suelo poner la i como iterador pero en este caso Yo creo que va a ser más claro que ponga x para entender la diferencia entre la x y la y ahora verás por qué ahora vengo aquí y creo un segundo bucle for digo for y in Range 0 coma altura y ahora lo que voy a hacer de momento voy a hacer una pequeña burrada digamos pero print x y f5 vale Ah muy bien claro vale venga Ok a String Y si hago así me dirá que tampoco porque creerá que es una tupla Mira pues Vale pues venga vale si te fijas va x0 y as cuando y Ah la ejecución cuando y llegue a 400 a ver si no tarda mucho en llegar a 400 claro cuando y llegue a 400 lo que va a hacer es que y va a reiniciar y x será igual a 1 con lo cual lo que va a hacer es que va a barrer en este doble bucle todas las x y todas las y vale voy a hacer una cosa voy a pararlo porque si no va a estar ahí la vida eh Sí hola Ah venga ya muy bien vale entonces yo lo que quiero es sí Exacto vale lo que estoy haciendo es lo que quiero es recorrer la matriz donde voy a hacer lo siguiente vamos a ver voy a decir ahora que rojo es igual a algo verde es igual a algo azul es igual a algo y yo ahora digo rojo es igual a píxeles de x y de c es la primera de las acuérdate que el color da una tupla de tres vect o sea de tres parámetros el rojo verde el azul esto es el número uno y esto es el número dos con lo cual yo ahora lo que podría hacer Es decir píxeles de X de y x y de cer es igual a rojo Tú fíjate qué tontería acabo de hacer uno y dos verde azul Vale y vamos allá entonces okay esto lo quito Espero que no tarde mucho No creo que tarde más allá de 2s TR segundos vale muy bien eh tupla No soporta asigna Ok vale muy bien entonces no soporta asignación directa lo que voy a hacer es que o sea píxeles de XD y es igual en este caso a rojo verde azul y ya está No soporta designación directa por parámetros pues no pasa nada ok y ya está vale lo que ha hecho es en José Vicente guardado ha guardado est qué es lo que he hecho realmente nada realmente lo que he hecho es almacenar los colores reasignar losos y ya está ahora bien Qué te parece si yo vengo por aquí y digo rojo es igual a 255 menos rojo verde azul y ahora te pregunto antes de ejecutar este ejercicio qué dirías que hace perfecto hace Exactamente eso así que yo ahora a continuación le doy a f5 me espero fíjate ha tardado Pues eso un segundo o dos con lo cual es un doble bucle for pero el rendimiento es relativamente aceptable y eh si te fijas lo que he es la imagen Y a partir de ahí invertirla vale Yo ahora puedo venir y puedo realizar una serie de ejercicios tampoco me voy a enrollar mucho con esto pero para que puedas ver el potencial de esta herramienta Yo vengo por aquí y esto es 59 recorrer píxeles grises y ahora digo Pues sabes qué eh rojo es igual a rojo esta línea me la podría saltar verde es igual a rojo y azul es igual a rojo qué dirías que estoy haciendo con este programa no curiosamente no Por cierto yo sé que a veces cuando digo qué dirías que hago en este programa me par parezco un poco Dora exploradora vale es como dónde vamos a continuación pues Verás lo que hace este código Ya sé que parece que lo pone rojo pero lo que hace es que si a los tres canales de color les está asignando Olvídate que ha Pon rojo está asignando el mismo valor lo que está ocurriendo es que si el canal rojo el canal verde el canal azul tien el mismo valor quiere decir que la imagen está en escala de grises entonces pulso f5 y verás como lo que hace es poner la imagen en blanco y negro predominando el rojo vale hay ot forma de poner la imagen en escala de grises ahora verás la diferencia voy a guardar Cómo eh lo voy a guardar como ejercicio 60 y así luego tienes la memoria de cada variación que hemos hecho que es que color es igual a rojo espera rojo más Verde más azul partido 3 y eh todo ello import math todo ello le voy a decir que quiero flor que lo quiero redondear hacia abajo entonces vengo aquí y digo color ejecuto vamos a ver si el flor no me da error no debería dar error pulso f5 mira ahora la imagen Hola Ah espera AC dado error vale flor is not defined math pun flor vale f5 vale mira ahora la imagen ahí la has visto cómo ha cambiado vale la forma de calcular el blanco y negro ha cambiado la forma de antes si te fijas era un poco injusta en el sentido de que lo que estaba haciendo era obviar la información de verde y de azul y quedarse solo con la información de rojo y esta forma computacionalmente es más pesada porque tiene que hacer una suma una división y luego un redondeo pero es más justa en el sentido de que está teniendo en cuenta los tres canales de color vale tú llegado a este punto tienes algo que decirme o sea algo como tío Estás trabajando demasiado Cuéntame hay veces que hay alumnos que cuando explico esto tienen algún conocimiento previo de pil o se lo que puede hacer pil o mientras yo estoy dando clase Pues los alumnos empiezan un poco a bichar la librería ent Hay algún alumno que alguna vez me dice python p examples por ejemplo aquí digamos aquí o aquí a ver es una librería genial pero o sea tiene una variedad de cosas Aquí aquí mira entonces para empezar tiene directamente modos de fusión tiene por ejemplo métodos con los cuales podemos get Pixel get Data podemos escribir podemos hacer lo que queramos vale en cuanto a Channel operations Fíjate que pone add ad con modulus Blend composite constant darker esto es como cuando vamos a Photoshop y creamos una capa nueva y decimos Cuál es el método de fusión de la capa O sea quiero decir que son operaciones que están muy chulas Por qué Pues porque me ahorran a mí tener que calcular todo eso manualmente y además tengo filters vale tengo filtros Como por ejemplo desenfoque gauso y luego por ejemplo lo que quiero decirte es que cosas como la que las que acabo de hacer que es la imagen e invertirla y la imagen y pasar la escala de grises hay filtros ya predeterminados que lo hacen es decir yo podría usar un filtro que es grayscale y me hubiera ahorrado todo esto y yo podría utilizar un filtro que es invert y me hubiera ahorrado todo eso pero no me lo quiero ahorrar Por qué dirías que no me lo quiero ahorrar Pues porque el qué por verás Exacto claro más que más didáctico lo que quiero demostrar con esta librería hay un momento que me voy a abrir La persiana lo que quiero demostrar es control evidentemente Uy meach vale casi se me Apaga el monitor secundario a ver Ah a ver un segundo que hoy tengo el monitor secundario sensible dame un segundo Vale entonces verás en primer lugar lo que te quiero decir es que no te quiero ocultar que todo esto que acabamos de hacer se podría haber hecho con una función predeterminada pero mi función Recuerda que estamos aprendiendo este ejercicio concreto para luego poder utilizarlo eh con técnicas de Machine learning y con técnicas de Deep learning para reconocer objetos dentro de la imagen entonces Claro si yo por ejemplo quisiera invertir la imagen Yo no haría esto yo lo que haría es utilizar directamente la función de la librería pero yo hago esto para demostrarte que yo tengo la capacidad de poder leer y poder escribir cada píxel de una imagen y si puedo hacer eso puedo hacer lo que me dé la gana con la imagen Es decir el que decir algo claro eso es a lo que me refiero Exacto verás uno de los ejercicios que tengo previsto para este curso ya te digo no hoy porque quiero ver unas cuantas cosas más antes pero a lo largo de estos días es un ejercicio específicamente de feature detection Entonces si lo miras en mi Instagram o en mi Facebook o donde sea vamos a ver ahora para fastidiar no aparecer aquí vale es ese tipo de ejercicios el programa lo que hace es buscar los píxeles o sea amarillo azul verde lo que sea en base a feat horizontales verticales diagonales y tal Vale entonces ahí La idea es la siguiente ahí La idea vale un segundin