grabado vale Y una vez que en la clase de hoy hemos visto el servidor de sockets en funcionamiento pues eh vamos a continuación a pasar a acceso a datos Y así pues como ya os digo así hacemos una hora y media de programación de servicios y procesos y hacemos una hora y media de acceso a datos vale Y ya está bien pues vamos allá y para ello voy a cerrar por aquí y Bueno aquí cierro vale aquí cierro el servidor lo porque ahora os tirará a todos vale cierro el servidor paro el servidor o me desconecto del servidor Bueno voy a decir logout Para volver a mi ordenador Así que cierro por aquí vale vamos a ver dónde nos quedamos el otro día con procesos con acceso perdón el otro día hasta donde yo recuerdo segundo acceso a datos manejo de conectores aquí eh listado de tablas Aquí está Vale eliminar Okay parece que nos quedamos llamada procedimiento Bueno okay vamos a verlo un momentín acceso Perdón blog o editor ahora mismo tengo un poco de lapsus porque no me acabo de acordar Ah esto es línea de comandos okay llamada al procedimiento bueno No esto son estos son procedimientos vale dónde estábamos no Estos son establecimiento de Ok estábamos haciendo un controlador herramientas de mapeo no yo creo que aquí no entramos a ver si alguien se acuerda de donde ha entrado ya pero bueno llegas media hora pronto no pasa nada manejo de ficheros desarrollo no vamos a hacer una cosa voy a buscar aquí dentro y pun php y php vale tamaño modificación el 8 de octubre que sería la semana pasada Hola mundo una pregunta a ver si es que estoy flipo yo que es muy posible no empezamos a hacer una clase Ah esta clase digo me decía yo vale Ok perfecto muy bien vale hicimos esta clase el último proceso que es Select all from tabla Aquí está show tables listado tablas vale Ok y ahora New conexión deb vale perfecto esto Dónde está ejecución de sentencias de descripción de datos vale manejo de conectores ejecución de sentencias descripción de datos eliminar vale perfecto bien pues vamos a hacer unos 20 minutitos de continuar esto eh básicamente cuando llegamos aquí es cuando ahora podemos hacer un conexión de b y con conexión de B podemos empezar a llamar a métodos pero mucho mejor todavía aquí yo lo que puedo hacer es servidor y al hacer servidor lo que voy a hacer Es que voy a crear un archivo vamos a ver llamado no segundo acceso a datos manejo de conectores ejecu 32 Vale y Esto va a ser eh conexión db.php de esta forma ahora a continuación esto es index.php vale index.php tiene esto y conexión de B tiene esto de aquí Así que si hago esto Ahora yo puedo toda esta clase yo puedo toda esta clase yo puedo toda esta clase la corto Hola Por qué no me dejas cortarla ostras no me dejas cortar Ahora sí vale cojo toda la clase decía le doy a cortar me voy a conexión de B pego la clase okay Y ahora a continuación desde index.db lo que voy a hacer es include conexión db.php qué estoy haciendo de esta forma pues lo que estoy haciendo de esta forma vamos a verlo es derivar toda la complejidad de la definición de la clase en un archivo externo ese archivo externo únicamente contiene la definición de la clase y no contiene nada más y ahora a continuación pues digo ec conexión voy a llamar al método eh lista tablas y lista tablas vamos a ejecutarlo fijaos que esto ahora es mucho más limpio me voy a Chrome donde sea que esté no está Chrome vale me voy a Chrome y digo local Host dam segundo acceso a datos manejo de conectores sentencias de descripción y tengo tables in acceso a datos clientes empleados productos y lo que sea vale con lo cual una vez que vengo por aquí ahora voy a poner comentarios aquí vale incluyo el archivo en el cual se encuentra la clase en conexión creo una nueva instancia de la clase estornudo y ahora llamo a un método llamo a un método vale Y aquí tengo el método que me está devolviendo en este caso la tabla recordamos que para qué estamos desarrollando en acceso a datos una clase de conexión a la base de datos pues lo estamos haciendo para que luego esta semana que viene nos vengamos a sistemas de gestión empresarial y en el proyecto y en el proyecto yo entro al proyecto me voy a una aplicación me voy a Eh Pues eso me voy aquí a aplicaciones vale me voy a clientes y quiero utilizar es decir aquí en segundo en sistemas de gestión empresarial en proyecto en la última versión pues no quiero que en servidor tenga un montón de archivos php separados vale quiero que cada archivo php sea el lo correcto vale cada archivo php Perdona un archivo php me lo gestione todo porque es que si os fijáis ahora cada archivo php hace una cosa diferente Y esto no es muy mantenible además os voy a decir que vamos a tener otro problema adicional que vamos a tener que solucionar en esta asignatura de acceso a datos Porque esta es la asignatura para solucionarlo que es lo siguiente veréis yo tengo por aquí la base de datos crimson d tengo aplicaciones y tengo clientes y tengo selección clientes y tengo usuarios voy a ampliar un poquito esta aplicación de la siguiente forma me voy a local Host me voy a php my admin me voy a crimson y en crimson me voy a las tablas y voy a hacer lo típico vale Voy a hacerlo típico de crear tablas relacionadas con claves foráneas os acordáis del año pasado de primero vale Eso quiere decir que voy a crear una nueva tabla de productos con identificador entero 255 clave primaria autoincremental vale es el nombre del producto quiero nombre de producto 255 y ya puede ser nule una de descripción es un text y ya está nu leable y el precio es un decimal dónde estás decimal de 10,2 vale guardo y Okay tengo una tabla de productos lo cual quiere decir que en crimson Pues tengo una tabla de productos vale Okay funciona correctamente el problema es que yo ahora quiero hacer una tabla de pedidos lo típico pedidos identificador entero 255 clave primaria auto incremental pedido fecha es un date vale No es nule bueno s sí que puede serlo y atención y ahora digo clientes nombre vale clientes nombre es un campo entero no es no leable le doy a guardar clientes tiene nombre apellidos vale Ok nombre bien si yo ahora vengo aquí a momentín y ahora vengo aquí a pedidos Yo le doy a insertar la fecha creo un pedido con fecha de hoy clientes nombre aquí viene el problema vale clientes nombre pongo un número uno y yo sé cuando haga una petición que cuando aquí ponga clientes número uno pues en clientes me irá y me cogerá el cliente número uno sí Blanca lo de marcarlo n leable lo hago porque hay veces que al hacer un insert tú quieres insertar solo por ejemplo el registro del identificador Por qué Pues porque igual más adelante mediante update ya meterás el nombre los apellidos el email la dirección población Y tal Pero si no es nule el al campo no le puedes meter nada o sea Perdón al campo no le puedes meter nada es una doble negación lo cual quiere decir que al campo estás obligada a meterle algo entonces cuando un campo lo ponemos nul lo que quiere decir es que en el campo podemos no poner nada y la base de datos lo va a aceptar pero si no ponemos nul a ese campo hay que ponerle algo Cuando hacemos un insert vale es solo por eso no creo que lo use lo del nul pero es solo por eso para cubrirme un poco las espaldas bien Ahora una vez que tenemos pedidos sabemos que esto de aquí filosóficamente es una foreign key pero ahora mismo no lo es vale por eso os acordáis que el año pasado en el examen de bases de datos Pues así como por ejemplo no entraban transacciones pero sí que entraba el tema de claves foráneas Vale pues nos vamos aquí nos vamos a vista de relaciones y por ejemplo le digo eh pedidos a clientes y la columna clientes nombre se va a la tabla de clientes y le doy a guardar y eso quiere decir que ahora sí Acabo de crear una restricción de clave foránea en la tabla de pedidos y esto quiere decir que yo me voy aquí a pedidos y aquí donde veis que pone clientes nombre número uno si yo pongo el ratón por encima me dice e es bueno carrat Sánchez vale Pero lo que sea debería poner José Vicente pero me da igual pero por lo menos reconoce que es Carr de la sanchiz vale o sea reconoce que ese un no es un número uno suelto sino reconoce que ese número es una clave foránea hacia otra tabla vale Esto no es novedad esto es simplemente un repasito del año pasado y es que precisamente si muchas veces decimos que Maya sql sigue el modelo relacional Pues cuando hablamos de bases de datos relacionales hablamos de tablas que guardan relaciones entre ellas vale bien Por lo tanto mi problema ahora porque diréis vale fantástico y qué pues ahora viene mi problema y es que si yo me voy aquí a crimson rp recargo tengo aplicaciones Tengo clientes y tengo productos no tengo ningún producto ahora pero Ah Lo pondré tengo pedidos pero en el pedido pone entes nombre y pone el número uno por qué pone un número uno pues porque es lo que ponen mysql es decir yo ahora mismo he hecho un controlador de bases de datos que es Guay Pero puede ser más Guay vale Yo vengo aquí y digo en selecciona tabla en el método selecciona tabla me coge la tabla y me hace un Select from tabla claro Select de esta tabla de aquí de la tabla de pedidos pues me da esto de aquí pero claro Esto humanamente no es legible Esto no es correcto porque aquí lo que tengo que hacer es meter el dato correcto de momentín que se me descontrola el botón por se me descontrola botón cosas Ah vale ya vale el dato correcto de Quiero llevar vale a dónde quiero apuntar ese dato qué quiero decir pues que aquí en clientes nombre en lugar de poner uno debería poner por ejemplo José Vicente vale pero problema esto crimson no lo sabe esto lo sabe el controlador de la base de datos qué os quiero decir con esto Pues que si os acordáis del esquema full stack un momento que estoy abriendo Okay si os acordáis del esquema que es este esquema de aquí recordad que js recordar que javascript solo sabe lo que le envía php es decir la parte Front de la del programa de interfaz de perdón del programa de gestión empresarial no sabe nada de la base de datos solo sabe que recibe un jas y solo sabe que pinta en pantalla el J son que has recibido tú me das este Jason yo te pinto este Jason Vale qué es lo que tenemos que hacer ahora y en la siguiente clase que vamos a hacer después del taller pues lo que tenemos que hacer es ampliar nuestra clase para que la tabla sea capaz de detectar cuando un campo en lugar de mostrar este campo deberíamos estar mostrando la información de la tabla por ejemplo de clientes vale vamos a por ello vamos a abarcar esto vamos a avanzar aunque sea en 5 minutitos vale Y en ahora a continuación lo que voy a hacer es averiguar Cuáles son las restricciones Cuáles son los vínculos de esta tabla eso qué quiere decir vamos a verlo me voy aquí y digo my sql given a Table Show foreign K vamos a ver vale Ok bien y catus vale Así que me voy aquí me voy a sql me voy a ejecutar esto y digo Table name es igual a pedidos si ejecuto esto de aquí puedo decirle todo vamos a simplificarlo Epa vamos a hacer la tabla lo más sencilla posible OK Vale y ahí lo tenemos Y si os fijáis me está diciendo la restricción que tengo es más voy a ver si me puedo cargar también esto okay crimson primary y momento momento momento Esto vale pues mira me voy a llevar esta consulta si os fijáis yo ahora mismo tengo un listado de columnas este listado de columnas técnicamente me lo está dando me lo está dando digamos el sistema vale me lo está dando el control de bases de datos que yo he hecho vamos a comprobar si esto es cierto o no vale me voy a ir a Bueno me vengo aquí acceso a datos segundo acceso a datos conectores eh descripción de datos servidor vale Y me voy a ejecutar en el servidor me voy a ejecutar selecciona tabla de pedidos eho pedidos Ah perdón es que esto se está conectando a acceso a datos crimson crimson Vale qué me da identificador uno fecha esta de aquí clientes nombre uno Espera que se me apago el monitor momentín Vale entonces a continuación yo lo que quiero es ampliar este listado de aquí para comprobar campo a campo qué es lo que tengo vale para comprobar campo a campo qué es lo que ocurre voy a hacer lo siguiente ahora duplico este proyecto ya sabéis siempre esto es segundo esto es acceso a datos esto es conectores descripción y copio y pego y voy a poner 033 y averiguo claves foráneas vale Y en conexión de B en conexión de B aquí a continuación le digo query es igual a esta query de aquí como ve intento mantenerla lo más sencilla posible hago Esto vale we Table name es igual a tabla y ahora digo result es igual a mysql conexión query While Row es igual a esto de aquí y voy a hacer una operación de debug donde voy a poner Mira bardom Row y eco br esto ya sabéis que es un poco guarro porque pues un método acaba en return Pero bueno Yo quiero hacer bardom y eco para sacar cosas en pantalla Vale entonces me voy aquí me voy a la siguiente versión del proyecto me voy a 033 y tengo Esto vale tengo que clientes nombre vamos a verlo Aquí está clientes nombre vale clientes nombre me dice que es O sea que tiene algún tipo de condición vale tiene algún tipo de historia tiene algún tipo de referencia externa lo que voy a hacer a continuación por lo tanto vamos a verlo va a ser ahora a continuación aquí en el Select campo a campo especificar indicar si tiene una referencia externa o no Qué cosas puedo hacer ahora Bueno pues restricciones es igual a array y momentín que quiero comentar esto antes de que pase la siguiente clase y restricciones de array esto es un Push es igual a Row y al final bomp de restricciones vamos a ejecutarlo y el resultado es el mismo vale antes de que nos vayamos al taller vamos a comentar esto ejecuto una consulta sql para ver qué Campos tienen restricciones de clave foránea me refiero vale para no hacer una consulta tan Happy como Select all Front tabla es como ala venga es como no perdona sebla Espérate un momento vale Y ahora a continuación vamos a ver digo Bueno ejecuto formateo una consulta Vale ahora eh ejecuto la consulta contra la base de datos Y ahora creo una Ray creo un array vacío para guardar las restricciones recupero los datos del servidor hago un Push encubierto a las restricciones y las de bugueo en pantalla vale las de en pantalla quiere decir que yo como desarrollador llega un momento en el que digo ostras llegado a este punto exactamente el programa Qué habrá metido en restricciones pues Oye pues lo vomito en pantalla para que yo como desarrollador pues pueda tener una idea de qué es lo que está ocurriendo vale en php no hay console desgraciadamente Pero bueno puedo vomitar cosas a la pantalla y ya está Vale bien una vez que Hemos llegado aquí teniendo en cuenta que aquí tenemos la petición y aquí tenemos todo el listado de restricciones Pues ahora vamos a parar un momento esta clase Porque ahora a continuación entramos en el siguiente bloque que es el taller del currículum y ya está vale Así que voy a parar