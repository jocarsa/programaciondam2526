bueno pues he estado preparando una serie de sets vamos a verlos por aquí bien vamos a mapas y en mapas aparte de que he creado un archivo de kim pues tenemos por aquí vamos a verlo creo que no lo guardado vale vamos a guardar lo vamos a abrir el quinto vamos a ver este mapa que estaba haciendo entonces en este mapa por una parte vamos a exportar el terreno z vamos a llamarlo vamos a ver por un pam pam imágenes mapas vamos a llamarlo mapa 1 ahí está por otra parte vamos a guardar esto como mapa unos colores terreno juegos y luego por otra parte tengo un mapa de arquitectura que crea así que vamos a llamarlo mapa 1 arquitectura que son elementos arquitectónicos que es diferente de los propios hablaremos de ello bien entonces eso quiere decir que ahora si tengo por aquí el mapa 1 tengo por aquí el mapa arquitectura vamos a crear también el mapa de los personajes por lo menos para que aparezcan al principio así que vamos a crearlo por aquí y voy a decir qué por ejemplo hago una nueva capa bien y por ejemplo aquí en el medio voy a pintar pixel rojo a continuación voy a pintar un píxel verde y a continuación voy a pintar un píxel azul bien así que aquí lo tenemos estos personajes y vamos a por ello así que ahora exportó solo esta capa para unos personajes no nos olvidamos en ningún caso de guardar el archivo original por capas bien y cerramos el equipo lo tengo en una carpeta llamada vamos a verlo i js y originales quería poner originales y aquí tenemos el mapa y una serie de elementos arquitectónicos que también he creado a la lengua hablaremos de ellos están aquí en img en arquitectura y he creado pues una serie de bloques de paredes de ventanas de puertas y de todo esto ahora los meteremos dentro del juego pero antes de ello vamos a arrancar el propio juego vamos a arrancar el propio juego vamos a ir al localhost videojuegos vale vamos a jugar bien en este caso me aparecen los tres personajes es normal no pasa nada porque he creado pues todo un bloque de escenario lo cual pues hace que están todos a la vez ok no pasa nada por eso bien y ahora sí bien el terreno si bien la altura del terreno viene definida por un elemento los colores del terreno vienen definidas por otro por cierto también quiero decir que aquí en videojuegos en dónde estás en terrenos en terreno he creado también una serie de elementos de colores he cogido el bloque principal y lo he ido cambiando de color estos nuestros antiguos y lo he ido cambiando de color para digamos que coincidan con el propio color del terreno entonces ahora teniendo en cuenta que tengo estos dos elementos voy a cargar los voy a ir a condiciones iniciales y dentro de condiciones iniciales pues vamos allá tengo por una parte mapa un terreno o mapa lo que sea bien pues dónde está carrera 9 vale pues vamos a empezar a nombrar lo que he hecho los voy a poner todos en línea voy a sacar la carpeta y los voy a ir nombrando por orden entonces lo que hacer pero lo que hacer vamos a ocultar esto asfalto jardín pavimento casa y vaya jardín así que bloque asfalto bloque jardín lo que pavimento lo que pavimentó casa y bloque valla jardín entonces lo que hacer a lo que asfalto bloque jardín bloque pavimento casa y bloque valla jardín y ahora esto es acera esto es asfalto esto es jardín esto es pavimento casa y esto es vaya jardín bien con esto tengo ya las imágenes cargadas ahora por supuesto me hace falta cargar el propio mapa así que vamos a verlo esto está en mapa 1 colores entonces vengo por aquí voy a llamar a esto mapa colores src es igual a mapas de colores para unos colores y entonces ahora lo que voy a hacer es poner los siguientes elementos voy a decirle al programa voy a indicarle al programa dónde tiene que pintar cada uno de estos elementos diferentes para ello lo que vamos a hacer es bueno indicarle al programa al repasar la imagen no vamos a cargarla vamos a por ello vamos a cargarlo dentro de un contexto inicio y por ejemplo aquí en el inicio vale voy a decir primero en condiciones iniciales el contexto aquí creamos un contexto canvas lienzo mapa colores y en las condiciones iniciales con texto mapa colores con texto mapa colores es igual a lienzo mapa colores ahora en el inicio por ejemplo voy a decirle con texto mapa colores punto pero emails y voy a poner mapa colores mata colores ahí está para colores como 1,100 haciendo esto ya tenemos ese mapa ahí ese contexto ahí vamos a ver el index vamos a ver el estilo y lienzo mapa colores eliminamos todos estos le decimos que lo queremos ver de momento y vamos a ver si lo podemos ver si todo ha ido bien vamos a jugar cuidado porque ocupa demasiado ahí bien y en principio ahí aparece ya el contexto de color con lo cual pues ahora lo que tenemos que hacer es que cada vez que el programa pinte un elemento en lugar de pintar lo verde pues venga aquí y diga bueno de qué color lo tengo que pintar realmente es decir de qué color es en realidad cada uno de los elementos pues voy al momento en el cual pinto el terreno vamos a pintar el terreno vamos a pintar el terreno donde estás terreno vamos a funciones y vamos a hacerlo desde allí ahora por tanto busco pinta terreno aquí está dibuja terreno y básicamente pues lo que voy a hacer es cuando voy a draw y me voy a decirle qué es lo que voy a dibujar digamos con qué bloque voy a dibujar entonces hago esto vamos a ver ok y ahora vamos a decirle qué dif con texto mapa colores punto & image data y bueno hombre así es lo siguiente incluso colección real es igual a contexto mapa colores punto get y mislata de x como y 11 punto data y entonces ahora sí digo si array de uno es igual algo and array de dos es igual a algo and ride de 3 es igual algo en ese caso pinta este bloque bueno pues esto lo pongo por aquí cuidado esto como decía lo pongo por aquí esto lo pongo por aquí y ahora lo que tengo que hacer es averiguar cuáles son los colores de cada uno de los bloques entonces vamos a por ello vamos a por ello antes lo quiero sangrar bastante y este bloque lo cambio cuantos bloques de terreno hay de momento hay 1 2 3 4 5 y 6 pues entonces cojo esto y digo 1 2 3 4 5 y 6 sangro convenientemente vale y entonces vamos allá voy a el gimp por ejemplo para averiguar cuáles son estos colores voy a abrir mapa x cf cuidado porque como he renombrado la carpeta y ahora lo encuentra vamos a ver el sistema de archivos aplicaciones ht docs videojuegos originales mapa bien me voy a terreno y bueno voy a empezar por el asfalto por ejemplo así que asfalto tercera 255 es 42 así que si estos 42 y estos 42 entonces bloque asfalto pintar lo que asad ahora hay un error ahí okey perfecto ahora esto es 67 66 qué curioso 67 66 bloque acera bloque pues por ejemplo pavimento 90 aceite 90 esto es bloque a ver claro como lo hemos llamado bloque pavimento y bloque pavimento casa muy bien pavimento ahora bloque pavimento casa 138 entonces esto es bloque pavimento vale ahora esto es 65 96 54 esto es bloque un bloque jardín y al parecer sólo le falta bloque vaya jardín qué es 111 133 104 y esto es bloque vaya jardín me acabo de dar cuenta de que los índices de los arrays los tengo mal entonces esto es 0 esto es 1 estos 2 esto es 0 esto es 1 estos 2 0 1 y 2 pero 1 y 2 y vamos a probarlo bueno pues a continuación vamos a le voy a quitar el sound in vamos a otra vez aquí alguien cancelamos ahora lo abriremos venimos por aquí y bueno vamos a ver si nos da algún tipo de error ahora así que vamos a verlo con solá le damos a jugar para refrescar bien voy a refrescar del todo porque yo juraría que me ha cogido el anterior vale y contexto mapa colores gettyimages data no parece claro gateway databa con mayúsculas en funciones en la get emails data la d con mayúsculas podemos jugar y bueno si todo va bien así que parece que está cogiendo los bueno los restos los y los correctos bien tenemos ya el pavimento tenemos hay un jardín tenemos una calle tenemos un asfalto vale esto tenemos ahí el final del escenario ok muy bien y yo juraría que el terreno no acaba ahí pero bueno no pasa nada y ahí tenemos una calle tenemos un personaje persiguiéndonos y a continuación vamos a trabajar la parte de arquitectura del de este proyecto ya que bueno pues he preparado una capa más con elementos arquitectónicos que a continuación vamos a poner nos he dejado en una carpeta como arquitectura hay un montón de ellos cargarlos va a ser un rato pero vamos a alinear pero básicamente voy a empezar cargando uno de ellos por lo menos pero básicamente pues corresponden a los elementos arquitectónicos de la casa además he preparado dos versiones un bloque alto y otra de bloque bajo ahora vamos a ver para qué sirven y eso nos permitirá que cuando estemos fuera de una casa veamos la casa cerrada pero cuando nos metamos dentro de una casa veamos por dentro vamos a verlo entonces nos venimos por aquí nos venimos por aquí voy a condiciones iniciales bien en condiciones iniciales voy a empezar a cargar cosas así que var bloque arquitectura y como lo voy a empezar pues voy a empezar por vamos a ver dónde está el bloque más sencillo simple 1 y simple 2 vale simple 1 es igual a new image y bloque arquitectura simple es igual a arquitectura y simple 1 y ahora de la misma forma pues voy a poner bloque arquitectura simple 2 cuidado con el bar esto no va simple 2 bien así que además centro de index.html quiero y en forma para arquitectura además en condiciones iniciales tengo que cargar el lienzo mapa colores pues contexto mapa arquitectura y en forma para arquitectura y entonces ahora en la función de inicio siempre igual con texto mapa arquitectura droid mates mapa arquitectura y vamos a verlo así que ahora me voy a estilo lienzo mapa también arquitectura recargamos jugamos bien mapa arquitectura is not the fine y podemos hacerlo aquí mapa arquitectura y esto es porque en condiciones iniciales mapa colores mapa arquitectura una para arquitectura mapa 1 cómo se llama se debe llamar a un nuevo arquitectura así que ahora si recargo y si todo va bien ahí tengo ya el mapa de arquitectura y por tanto empiezo a pintar para pintar desde el punto de vista en el que en la de funciones pues lo tengo aquí en pinta terreno y es donde voy a empezar a pintar por defecto voy a decir lo siguiente y vale donde acaban los sips digo bar y contexto mapa arquitectura getty mislata x y está bien y entonces ahora digo a raíz de momento 3 es igual a 255 de momento ahora hablamos de ello contexto arquitectura contexto fondo sino contexto fondo si hay también con texto fondo y juraría que sí es igual a bloque arquitectura bloque ya no sé bloque arquitectura simple 1 vamos a verlo recargamos le damos a jugar vale vamos a verlo en principio no en principio en un principio no está saliendo nada igual es que lo está pintando un gancho de dibujo ok vamos a verlo anchura dibujo voy a decir con solo pintando para comprobar si de momento es cierto que está cogiendo el dibujo le voy a jugar y pintando sí que 102 elementos me parecen pocos pero bueno sí que 102 elementos los está pintando recargo por aquí bloque arquitectura simple vamos a verlo más altura bloque z es un bloque grande son bloques grandes también lo tengo que decir esto es vamos a verlo anchura dibujo por tres y aquí voy a poner más 500 vamos a ver dónde lo pintan porque en alguna parte digo yo que en alguna parte lo estará pintando voy a decirle igual que lo quiero pintar en 700 cuando recargo y bueno en alguna parte deberían aparecer el caso es que 100 me parecen pocos para todo lo que hay ahí pero bueno altura bloque efecto bloque arquitectura simple vamos a asegurarnos arquitectura simple 1 punto png arquitectura simple 1 punto png y luego el otro es simple 2 o sea que teóricamente sí que está bien vale pues en funciones voy a ir probando hasta que salgan la pantalla puede ser una cosa enferma el coso voy a comentar todo esto para forzar a que no salga nada forzar a que no pinte el terreno y a ver si pinta los elementos arquitectónicos ahí está el problema no pinta nada no está pintando nada no está pintando nada bloque arquitectura simple no está pintando voy a hacer una cosa con texto fondo punto de waits voy a pintarlo en 0,0 y a ver si así saca ahí está de hecho lo está pintando de hecho lo está pintando parece que con el tamaño correcto pero sin embargo entonces porque no pintaba correctamente el bloque es curioso lo que está pintando es eso y por qué hizo x eso y no lo está pintando recargo el juego ahora sí aunque verá que igual no lo está pintando en el sitio correcto bien de momento en este caso lo importante es que aunque las paredes no están bien aunque están todas con el mismo giro pero lo importante es que realmente aparte de que está matando a islas y realmente la casa se entra más o menos por aquí ok este es el pasillo allá lo haremos de delante y detrás pero bien en principio está representando bien por lo menos las paredes no sé por qué antes no ha funcionado entonces quito esto igual es que no lo había cargado todavía no lo sé interesante está muy bien muy bien o sea sólo funciona si le quito el 700 vale porque no era más 700 yo creo sino que eran menos 700 porque no tengo que levantarlos no tengo que bajarlos y no subirlos esto ya es otra cosa y entonces ahora puedo quitar esto puedo quitar el comentario recargó le voy a jugar y esto ya empieza a salir claro ahora evidentemente tengo que cuadrar los en el sitio hay un error parece vamos a verlo porque el juego se ha detenido claro no sé cuál es el motivo por el cual de repente han desaparecido los elementos arquitectónicos ha sido curioso bien y ahora los elementos deberían estar cuadrando con esa casa debajo entonces vamos a verlo a nivel 2 muy bien porque me he metido directamente con vale fantástico vamos a verlo y en principio ahí está 700 parece demasiado fuerte vamos a poner menos 100 con menos 100 no aparecen vamos a poner menos 200 allí empiezan a aparecer menos 300 vale llega un momento en el que ya aparecen correctamente para no quiero vale aparecen correctamente en el sitio ya tengo una pared digamos ya tengo la pared principal bueno pues ahora lo que tengo que hacer es medir correctamente definir al programa que mira correctamente cuando pone una pared y cuando la pone la otra y cómo voy a hacer esto bueno pues eso lo puedo hacer no va a ser fácil pero eso lo puedo hacer diciendo bueno pues cuando tengas un píxel mira a ver qué píxeles tienes al lado entonces sí el pixel que tienes al lado es de tal tipo de tal otro pues en ese caso quiere decir que eres de tal tipo de pared o de tal otro tipo de pared vamos a analizar cuál es la lógica en el siguiente vídeo y la implementamos vale pues la lógica es la siguiente si por ejemplo tengo este píxel de aquí y digo bueno tengo que mirar todos los de alrededor y decir si el de arriba está ocupado si el de la derecha está ocupado pero el de arriba a la izquierda no está ocupado el de abajo a la derecha no está ocupado eso quiere decir que eres de tipo tal de tipo l o de tipo pues como te decía que un segmento recto o de tipo segmento vertical o de lo que sea entonces vamos a en primer lugar cargar las imágenes o sí porque eso lo tenemos que hacer sí o sí ya habíamos empezado a cargar las imágenes por aquí así que bueno vamos a crear una plantilla y empezamos a cargar bloque arquitectura simple esto es una plantilla pero luego lo cambiaremos y voy a cargar tengo los simples y tengo el xxi tengo 3 es decir el estés y cruz de hecho tengo cruz tengo eles tengo tes y ya está vale pues voy a decir bloque arquitectura x lo que arquitectura x esto es cruz ahora tengo que regarlas 4l si las cuatro test asiste l 1 esto es l 1 3 y 4 el 4 2 3 y 4 y por último voy a cargar las test y te y bien entonces ahora como digo lo que tengo que hacer es mirar digamos que tienen los siguientes elementos entonces me voy aquí a funciones me voy donde estoy pintando la arquitectura y entonces ahora voy a decir lo siguiente vamos a ver va al centro ok y entonces bar arriba bar abajo bar derecha y bar izquierda muy bien esto es arriba es y menos 1 abajo es uno derecha es x1 e izquierda es x menos 1 bien entonces yo ahora lo que voy a hacer es decir vamos a ver si centro es 255 vale que bien esto está bien y ahora digo si centro si arriba de 3 es igual a 255 y es cierto que abajo de 3 es igual a y es cierto que izquierda de 3 es igual a 255 y también es cierto que derecha de 3 es igual a 255 pues en este caso tengo que pintar un bloque arquitectura x es una vez porque se arriba abajo izquierda derecha tiene solidez es que es una esquina de equis voy a hacer lo mismo voy a decir y arriba es sólido abajo es sólido izquierda no es sólido y derecha no es sólido es bloque arquitectura simple uno igual me equivoco pero bueno y al revés 0 25 52 55 esa arquitectura simple 2 vamos a verlo vamos a evaluarlo le voy a jugar bueno parece que ha acertado porque salida el videojuego va lento está yendo lento no pasa nada ahora nos ocupamos de eso pero sí que parece que por lo menos está yendo bien no hay he puesto contra el objetivo ahora trabajaremos para que no vaya lento pero por lo menos parece que los bloques simples los he acertado de casualidad y estoy buscando un bloque x estoy buscando un bloque x igual no tengo ningún bloque x estoy pensando igual es cierto que no tengo ningún bloque x bueno pues casualidad por lo menos de ahí a las paredes pues voy a hacer las test y voy a hacer las él es pero en todo caso pues ya vemos como parece que la cosa está marchando correctamente así que vengo por aquí vamos con las él es roscón a poner comentarios bloques simples así que estos son las tes son 43 y las 43 son 25 52 55 25 50 25 52 55 02 55 25 52 55 y cual me falta el segundo 0 25 02 55 255 entonces esto es l 1 no tengo ni idea de si voy a acertar ahora es imposible que acierte a ojo si acierto me voy a comprar lotería l 4 vamos a recargar le voy a jugar y no las ha puesto no ha puesto ninguna vale por eso son las lastres y yo estoy viendo aclaró el es que éste vamos a verlo vale vamos con las tres bien efectivamente hay una que está mal hay otras que no la ha puesto no sé por qué hay otra vez que está mal y hay algunos que no les está poniendo pero evidentemente está mal entonces yo creo que puedo saber cuál es cuál y vamos a ver si abajo vamos a sacar los bloques este es el de abajo 0 este 3 a bajo cero este 3 eso quiere decir arriba pero es de uno arriba pero este uno vale y los otros como estaban vale también mal izquierda pero es t 4 y el otro este 2 izquierda 0 al momento no hay ninguna izquierda cero este 4 izquierda 0 es de 2 vamos a verlo jugamos y parece que ahora está bien parece que ahora está bastante bien y nos faltan las él es así que si ya tenemos las tres pues vamos a por las él es vamos a por las él es 2 552 5500 0 a ver no no esto no puede ser esto es arriba izquierda esto es arriba derecha ahora abajo izquierdo y abajo derecha ok ahora esto es el e1 l 2 bueno es lo que sea va a salir mal de nuevo le voy a jugar ok vale hay una que ha salido bien de casualidad esta vez aquí ha salido bien aquella vía ya vamos a verla esa ha salido bien también de casualidad lo cual quiere decir hay una tema bueno pues hay una l mal pero las demás están bien y hay una t que está mal vemos como por lo menos está empezando a aparecer lo que quiero vamos a ver otras casas vamos a ver cómo hay en otras casas y apareciendo bien y siguiente cuestión por cierto que el pavimento de la casa de suponía que es más clarito el pavimento de la casa se supone que es más clarito no vamos a verlo lo que pavimentó ahí está lo que pavimento casa recargamos vemos que el juego se está ralentizando bastante ahora sí con lo cual a continuación vamos a ver si podemos hacer que el juego vaya más rápido bien voy a ocultar los canvas o sí porque ya los tengo display none bueno ya ahora la cuestión es que me está calculando las paredes de trozos de escenario donde el personaje está lejos si yo ahora vengo alguna inspección y en la inspección hago un análisis de rendimiento pues probablemente voy a ver que prácticamente estoy consumiendo todo el procesador y no es necesario entonces para ello lo que voy a hacer como digo es pues digamos el trozo del personaje que realmente esté cerca vamos a parar vamos a verlo en un momento vamos a ver ya adelantó evidentemente que va a salir poco positivo y ahí lo tenemos prácticamente nos estamos cargando el rendimiento por esto que acabo de hacer por lo de la arquitectura y esto es porque realmente no vale la pena calcular digamos cada uno de los bloques ahí lo vemos sólo quiero calcular a aquellos que realmente estén cerca y da la impresión de que está calculando pues todos hay cuidado da la impresión de que está cavando todos los que haya entonces a continuación ahora a continuación veré si puedo realizar algún tipo de optimización de momento estoy comprobando que puedo navegar ahora pondré por cierto puertas y ventanas y tal que las tengo preparadas pero de momento lo importante es ver como pues ya tenemos un escenario por el cual nos podemos mover es el correcto bueno voy a poner las puertas y las ventanas en este caso la puerta de momento lo que voy a hacer es no poner nada es decir en el elemento aquí la puerta es de color rojo así que voy a hacer lo siguiente en funciones en los simples lo que simples voy a decir con eso si arriba es esto vale bloque arquitectura simple y voy a decir ander el centro de 0 es igual a 200 a 255 a ver el centro sí y también es centro que es también cierto que el centro de uno es igual a cero y es cierto que centro de dos es igual a cero a ver no un segundo esto es lo que simple entonces esto es puerta con lo cual me copió estos dos así sea claro realmente esto por aquí y ahora sí es cierto esto de aquí no pongas nada el momento ok y ahora ventanas vale ahora digo la ventana es de color verde y entonces digo y centro pero es igual a cero y centro de 1 es igual a 255 y centro de 2 es igual a 0 entonces voy a poner bloque vamos a verlo bloque ventana 1 y ahora pongo esto mismo aquí a continuación y esto es bloque arquitectura ventana 2 espero no haberme equivocado puede que sí ahora lo veremos recargamos le vamos a jugar hay un error vamos a ver cuál es al llegar a alguna ventana ha cometido un error bloque arquitectura ventana 1 cómo se llama ese bloque no lo cargado de lo cargado que interesante bien pues al bloque arquitectura ventana 1 y ventana 2 lo copió lo llamo ventana 1 y ventana 2 bien y si todo ha ido bien jugamos vale y vamos a verlo bueno vamos a ver creo que ha puesto los dos estos bloques y entonces te tengo que decir que cuando se encuentre un bloque de ventana no pinte pared te haya puesto una puerta en la puerta ha puesto una ventana vamos a verlo me voy a funciones y claro le digo dónde pinta claro y tengo que decirle que a continuación no es blanco los bloques simples y no es cierto esto no me lo va a dejar poner a ver que el bloque sea blanco y centro de cero centro de uno no es igual a 255 o el centro de 10 no de dos perdón no es igual a 255 si todo esto ha ido bien y lo pongo también por aquí y lo que estoy diciendo es que solo ponga en el caso de que sea pared vamos a ver no me vaya algo raro está poniendo tres no sé por qué realmente centro de uno y centro de dos no sé por qué los pone los voy a quitar de momento los voy a quitar del momento y ahora en el siguiente bloque de contenido los volveré a poner y analizaremos pues qué es lo que está ocurriendo de momento los tengo pintados dobles vale pues voy a dejarlos así y así vamos implementando más funciones dentro del juego otra cosa que quiero hacer por ejemplo es poner pues la misma lógica para crear las vallas que tiene cada uno de los terrenos con lo cual como nos podemos imaginar pues procederemos igual que al crear las barreras digamos de los elementos pero en lugar de ser barreras blancas pues serán barreras de color verde pero por lo demás pues tampoco tendrán mucho misterio