bien pues la clase de hoy Yo creo que va a ser divertida yo creo que va a ser una clase inspiradora pensaréis que igual estoy siendo irónico ya sabéis que no lo suelo ser y si bien en la clase de ayer de multimedia estuvimos trabajando con websockets para hacer un juego multijugador mi objetivo en la clase de hoy es eh utilizar en procesos y servicios los mismos websockets pero demostraros un uso totalmente diferente de los websockets lo mejor de todo esto es que el servidor va a ser exactamente el mismo lo cual os vendrá a demostrar lo que os dije ayer de que el servidor de sockets que subí ayer que tenéis el código en el servidor en el ghub es un servidor agnóstico lo cual quiere decir que el servidor realmente no de Qué información le está viniendo el form el formador el servidor solo sabe que recibe información y reparte información y el cliente ya sabrá Cómo interpretar esa información Así que para esto voy a hacer un sistema de videoconferencia os acordáis que os comenté que el año pasado hubo un alumno que hizo algo similar partiendo de del concepto de este ejercicio yo voy a hacer un sistema de videoconferencia muy sencillo lo que me dé tiempo a programar en esta primera parte el proyecto de tfg del año pasado de este alumno pues era bastante más grueso más completo Esa es la idea Así que dam segundo y ahora vamos a programación de servicios y procesos vamos a comunicaciones en red y nos vamos a ir el otro día estuvimos hablando de sockets Vale pues hoy vamos a hablar en creación de sockets de websockets así que me voy a editor de texto y me voy a crear un nuevo o sea voy a guardar este archivo segundo procesos y servicios programación de comunicaciones en red y creación de sockets y 001 y atrapo la cámara punto bueno primero estructura vale Estructura pun html No pun html vale Y creo Pues como siempre doc type html ih html por aquí ih por allá Body vale Y ahora una vez que tengo esto aquí lo que voy a hacer es que me voy a venir por aquí y digo que quiero el ejemplo más sencillo J simplest example get webcam feed and can cillo que pueda vale con el get user media Bien voy a empezar teniendo estos dos elementos que es que por una parte voy a tener un vídeo y por otra parte voy a tener un Lienzo eh hoy me interesa tener un Lienzo dentro de lo que cabe lo más pequeño posible porque acordaos de que el servidor que tengo contratado pues no es un servidor muy fuerte que digamos y vamos allá con este Script vamos a ver Script vamos a ver si lo tengo que simplificar vale digo vídeo Lienzo Esto es lo mismo que hemos hecho antes en Machine learning y en otros apartados vale perfecto pues eh Lienzo es igual a document get Element by ID Lienzo get context esto es contexto Vale y e Navigator medio de user media video source object Stream vale Okay y error voy a decir punto Catch error me lo voy a cargar bueno no me lo cargo va no sea que falle la cámara eh drw to Canvas vamos a ver aquí está Vale draw to Canvas video advent listener Play Vale pues bueno vale que es que cuando le de Play al vídeo que está en autoplay Por otra parte vamos a verlo local Host dam Segundo si servicios y procesos programación creación de sockets estructura html Vale y tengo el vídeo y tengo el vídeo y en principio debería tener el Canvas también pero no lo tengo vamos a verlo Ah Canvas is not defin ahí está el problema porque qu porque es Lienzo with Lienzo h y ya está Vale y Ok creo que ya vamos a verlo Vale y ahí está el vídeo lo que está ocurriendo es que lo que tengo aquí es un vídeo y lo que tengo aquí es un Canvas Y esto es importante porque si tengo un Canvas quiero decir que ya sabéis perfectamente Cómo se hace puedo el contenido del Canvas y lo puedo cuantificar voy a hacer una cosa y es que recordáis que el servidor que tenía ayer vale era un servidor de un núcleo de creo recordar 1 gig de ram o 2 gb de ram y 10 GB de disco duro vale si intento pasarle un fotograma completo de 640 480 se me va a petar vale Por qué Pues porque el servidor es pequeño el servidor es muy pequeño os acordáis ayer que solo en multijugador cuando estábamos dos tres personas pues ya se enganchaba un poco con lo cual Eso quiere decir que voy a hacer un 320 240 vale vamos a hacer así y así tengo un vídeo más pequeño y apareceré pixelado Pero bueno para esta prueba de concepto pues va a ser suficiente Vale ahora a continuación una vez que tengo esto lo que voy a hacer es asegurarme que puedo un fotograma de vídeo y lo puedo convertir a código Vale entonces me vengo por aquí y digo eh 00 dos Eh bueno datos del fotograma voy a hacer algo parecido a lo que hicimos cuando hicimos los workers que es lo siguiente aquí entro en un bucle y digo Let datos es igual a contexto get image Data desde 0,0 hasta 32024 es decir quiero todo el bloque Vale ahora comento código así que me vengo por aquí me voy a la siguiente versión datos fotograma y Ah sí perdona fantástico y console.log datos y Ok Vale y aparecen aquí los datos ojo solo con 320 240 y ya tengo una Ray de 37000 datos vale Por qué Pues porque 320 multiplicado por 240 multiplicado por cuatro canales pues Son 307200 elementos Vale entonces yo incluso lo voy a hacer más pequeño vale Voy a hacerlo pequeño y luego a tiempo de hacerlo grande siempre estamos pero eso eh 160 * 120 y 160 * 120 Okay bien eh recargo vale e 160 por no 160 por 120 vale hago así y ahora pues el Canvas está super pixelado Pero no pasa nada vale esto lo que hace vamos a aquí a refrescar Oh 307,000 Ah no perdona Y esto es 160 * 120 Y eso quiere decir que ahora los datos que tendré en el array pues serán cuatro veces menos pero ojo vale aún así son 76,000 piezas de datos la cuestión es que ayer enviaba primero envié un mensaje luego envié la posición x posición y vale Pero ahora cada vez que envíe algo voy a enviar 76.000 piezas de información o sea que vale por eso pues piano bien Vamos allá a continuación lo que voy a hacer es subir esto a internet y me voy a conectar para enviar información vale entonces vengo por aquí y voy a hacer lo siguiente vamos a ver vengo por aquí me voy a conectar me voy a conectar a jarsa comom bar Go bar Explorer me voy a conectar voy a ir a Go voy a ir a crear una carpeta no debe existir llamada videoconferencia no existe Vale y videoconferencia Ok en la carpeta videoconferencia ahora os doy la URL Ah ya existe pues no la veo Ah página dos vaya por Dios Vale pues vamos a ver voy a crear una carpeta no sé pues lo llamo zoom sabes zoom pues pum no sé cómo lo llamo eh Ay espera tengo una amiga que creó un nombre para una sala de videoconferencia blink Hala ya está blink Hala aquí ahora luego se lo envío por correo bien me voy aquí a blink y me voy a crear dos carpetas en blink vale me voy a crear esa que refresque el árbol de directorios y blink blink e no está blink me voy a crear una carpeta llamada emisor y me voy a crear una carpeta llamada receptor vale emisor será el que emita la cámara Vale y receptor será el que reciba la cámara más adelante evidentemente esto debería estar en un mismo software pero ahora mismo va a estar por separado Así que a continuación voy a hacer 001 pun html este es el emisor cojo el código que había desarrollado hasta este momento lo pego ahí dentro técnicamente esto ya no será 003 así que 003 html voy a pegar el código y ahora a continuación y ahora a continuación voy a seleccionar el proyecto que hicimos ayer que no me acuerdo cómo se llama videojuego creo que era Ah no tron opq RS t pues no está Cómo se llama cómo se llamaba la carpeta que hicimos ayer modificado socket perfecto Vale pues me cojo el 15 le doy a editar y digo ahora pondremos comentarios y digo socket ahí socket es igual a websocket wss jvs Puerto 3000 Esto va aquí Me conecto al websocket y ahora a continuación socket listener Open el error pues bueno va error Okay y Esto va Aquí vamos a ver un momentín esto Ay cuidado Esto va aquí ahora al poner comentarios a secciones evidentemente bien a continuación de cuándo en cuando pueda voy a emitir información sockets js stringify claro stringify de qué pues ahora veremos console logod datos nada socket Send json stringify datos. datata Esto es lo que voy a enviar bien Ahora vamos a poner comentarios Estos son variables globales esto Lleva enter vale esto es abro conexión de socket el servidor de ayer no lo paré con lo cual si no ha fallado y no debe fallar debe estar todavía en funcionamiento Y esto es pongo en marcha el vídeo vamos a ver pongo en marcha el vídeo y esto es pongo en marcha el vídeo y esto que hay aquí abajo Ay lo siento y esto que hay aquí abajo es el bucle infinito es el bucle infinito guardo ahora haremos el vídeo 4atro bien estoy enviando la información y al socket le estoy enviando la información de los datos ahora igual estoy petando un poco el socket también te lo digo entonces lo que voy a hacer es decirle que cuando el socket me devuelva claro cuando me dé un mensaje no me va a dar un mensaje nada fuera vamos a verlo guardo voy a ejecutar me voy a jarsa comom barg bar Go barra blink barra qué barra emisor y era 003 html vale permito Uy websocket is already in Close in closing Close State qué fuerte websocket error vale espérate fail connection refus Pues nada espérate no hagas todo esto no hagas todo esto porque esto no va a permitirte hacerlo vamos al servidor vale para ir al servidor para un momento vale websocket error Okay Estoy correcto bien Vamos a por ello me voy dónde me voy a ionos me voy a Iniciar sesión inicio sesión con mi cuenta me voy a servidores le digo que quiero ssh Root @ esto de aquí Qué raro El caso es que no sé por qué Uy Root ar vale me saco la contraseña que como os digo Pues no sé por qué Aquí catap plun no c cojo la contraseña pego la contraseña si todo ve bien entro y ya está vale Ya sé lo que ha pasado Ok perfecto CD home ls CD server o servidor clase lsl servidor clase es pues parece que es 1543 a ver CD server a ver CD servidor clase ls nada fantástico pues CD server y vamos a ver python 3 002 servidor de sockets comentado y mejorado Vale ahora el servidor ya está encendido con lo cual ahora eh aquí fuera vale aquí recargo websocket connection Open con lo cual ahora el websocket es correcto y ahora desbloqueo el socket senen que ahora que calculo que me enviará un poco a porque estaré enviando un montón de información vale pero ahora mismo estoy enviando un montón de información el socket está recibiendo un montón de información pero ya está Vale pero no hace nada más y esto quiere decir esto quiere Uy Esto vale esto quiere decir que si yo ahora a continuación me voy y me vengo aquí y me voy a blink este donde esté eh aquí y me voy a receptor me voy a hacer un archivo 001 html voy a editar este archivo voy a copiarme todo esto pero voy a eliminar un cuántas cosas vamos a ver vale eh Para empezar no esto Qué es Ah no esto sí vale el vídeo me lo quito el vídeo no hace falta Eso quiere decir que vídeo va fuera Lienzo se queda web socket se queda abro conexión de socket se queda pongo en marcha el vídeo no vale Y ahora abro conexión de socket y recibo mensajes del socket copio este código lo pego por aquí vale Y ahora voy a reutilizar el código de ayer de El socket message aquí socket ad event listener message Y entonces cuando haya un evento el servidor me dice lo que sea dibuja jugador nada no quiero dibujar ningún jugador de momento vamos a verlo si esto es correcto yo ahora a continuación me abro dos navegadores vale aquí pongo receptor 001 html vale websocket connection Open y emisor 3 html y si todo va bien ocurre eso Y es que si os fijáis aquí estoy emitiendo datos Y aquí estoy recibiendo datos de hecho aquí recibo un chorrón de datos fantástico vale de momento ya tiene buena pinta de momento ya empieza a funcionar pero claro que reciba números igual no os dice mucho vale evidentemente lo que voy a hacer a continuación es convertir esos datos en imágenes para que veáis que con la misma lógica que ayer enviamos mensajes con la misma lógica que ayer enviamos posiciones de un jugador pues podemos enviar vídeo vale Así que voy a bloquear un poco esto no quieto Cancela voy a bloquear un poco esto paro de enviar información vale este cliente deja de recibir información voy a de ver y por lo tanto Ahora aquí voy a hacer las siguientes versiones y digo blink emisor no cambia nada cambia receptor vaya dónde estás Go y blink voy a recargar ahora sí vale en el receptor voy a editar quieto voy a editar voy a crear un archivo nuevo llamado 002 html y ahora voy a editar este archivo voy a copiar el código de uno voy a pegarlo en dos y ahora a continuación le digo recibo vale eh bar datos o datos imagen es igual a contexto pun get image Data eh de 0,0 a 160120 Vale entonces yo ahora a continuación en event pun Data okay Digo datos punto imagen no for Let I es igual a 0 Y es menor que datos imagen punto Data punto length y más O sea recorro la imagen Pixel a Pixel componente a componente esto está de color rojo no sé por qué pero en principio no está justificado que esté de color rojo Así que voy a pasar y ya está Ah mira ay venga va que me ahogo Vale entonces le digo datos imagen punto Data de I es igual a datos de I porque datos imagen es lo que he cogido de la imagen y datos de I es lo que viene vale es lo que viene del servidor si todo esto es correcto contexto coma put image Data después de los datos le pongo los datos se lo pongo en le pongo datos imagen en 0,0 y yo creo que ya está y el console log me lo puedo quitar ya porque ya sé lo que hace me voy a guardar y si todo ha ido bien ahora por aquí recargo el emisor por aquí me voy al receptor a un nuevo receptor Y si os fijáis tengo un programa de videoconferencia Bueno he recibido primer fotograma pero se ha quedado un poco frito vamos a verlo el servidor me dice nada vamos a quitar lo del servidor me dice Ah mira ahí refresca poco a poco tengo como mucho lag también te digo que lo del servidor me dice probablemente me está ralentizando guardo recargo vale a ver ahora okay Hola mira lo del servidor me dice igual lo dejo Sabes porque hace un momento funcionaba vale aquí hay un problema y es que el servidor no le está diciendo nada voy a recargar Ahora sí vale Parecía un problema del emisor no del receptor vale hago así ahí vale veis que tengo un lag bastante grande voy a levantar la mano a ver Cuánto tarda en aparecer la mano en la otra parte veis que va muy lento o sea parece que en lugar de ir a tiempo real lo que está haciendo es saturar el servidor vale como estoy saturando el servidor pero ya podemos empezar a ver que funciona Pues yo lo que voy a hacer Es que voy a parar el emisor y voy a intentar optimizar el emisor vale para que no sature el servidor y os cuento lo que ha pasado vamos a ver aquí en el emisor esto es el emisor si voy a hacer un nuevo archivo 004 html abro el 003 vamos a ver abro el 004 bien y en el 003 lo que ocurre es que yo estoy enviando mensajes sin saber sin comprobar si el servidor da basto o no vale entonces estoy haciendo un request Animation frame de todo lo rápido que puedo y claro es un poco fuerte entonces vengo por aquí y digo bar temporizador es igual a set Time out e function draw to Canvas en un segundo vale draw to Canvas en un segundo aquí en lugar de hacer un request Animation frame voy a hacer un Clear Time out temporizador y voy a hacer un set Time out temporizador dentro de un segundo lo cual quiere decir que le voy a enviar la información al servidor una vez cada segundo Así que guardo y ahora me vengo aquí y ejecuto el 004 html De hecho aquí el propio Canvas irá a un fotograma por segundo lo podéis ver pero no pasa nada lo he bloqueado yo vale o sea lo he limitado yo y ahora me voy al cliente Oh míralo Qué bonito Ahora sí vale si os dais cuenta ahora no estoy saturando al servidor y ahora el servidor es capaz de recoger los datos correctamente vale por tanto ahora a continuación os paso esta URL y simplemente lo que quiero me voy al chat os pego ahí la URL voy a ver cómo voy de tráfico de red Por cierto vale porque evidentemente en tráfico de red Pues ahora estoy tanto recibiendo como emitiendo De hecho he emitido 400 megas también es cierto que estoy con el zoom lo cual vale bien qué es lo que quiero Ahora pues quiero que entréis en el receptor y quiero que me confirméis si me veis a un fotograma por segundo Sí vale pero es que insisto el vps que tengo es micro es mínimo o sea probablemente podría ir a dos fotogramas por segundo Pero bueno lo pongo un fotograma por segundo para no saturar y ahora veréis el Por qué he hecho vale Por qué he hecho la ventana grande entonces qué ocurre Pues que perfecto por ahí Blanca me ves vale Eso quiere decir que acabamos de hacer un sistema de videoconferencia muy cutre muy básico vale tendría que estar todo en la misma ventana tendrías que emitir y recibir y ver a todos los demás y todo eso vale tranquilos ya llegaremos a ello pero bueno pero de momento sobre todo el núcleo el Core de lo que os quería enseñar hoy es pues el poder trabajar poder reutilizar los mismos sockets que ayer nos servían para hacer videojuegos pues hoy nos sirven para hacer un programa de transmisión de vídeo vale bien una vez dicho esto voy a comentar el código voy a parar el emisor vale paro veréis que la imagen se quedará congelada vale me quedaré congelado en el último fotograma emitido okay bien y ahora a continuación vamos a comentar código entonces en el emisor voy primero al emisor en el emisor eh capturo el vídeo en html capturo el Lienzo para dibujar eh capturo un contexto 2D y ahora Cuando alguien me abre una conexión vale esto es copi de pegado del socket Okay entonces voy a utilizar el vídeo del get user media esto quiere decir que hoy por cierto he hecho un sistema de transmisión de vídeo sin audio vale pero otro día podemos hacer con audio Y entonces digo el en la Fuente del vídeo es lo que viene de la cámara y por lo tanto Ponme el vídeo en la cámara vale si hay error si hay algún tipo de error lánzalo por consola ahora bucle infinito me espero un segundo a poner el bucle en marcha y entonces digo Esta es la función de bucle y digo en el vídeo Perdón en el Lienzo dibujo el contenido del vídeo ahora los datos atrapo el contenido del Lienzo y lo pongo en un array envío este array al socket Esta es la parte importante y ahora reinicio el temporizador y dentro de un segundo ejecuto de nuevo y esto de aquí básicamente es pongo en marcha esto no hace falta esto no hace falta Esto me lo puedo cargar Okay bien siguiente esto es el emisor de vídeo ahora a continuación vamos a por el receptor de vídeo guardo por aquí directorio receptor me voy al número dos vale eh selecciono el Lienzo en el que dibujar ahora luego a la segunda en la segunda parte a ver si podemos hacer un sistema de videoconferencia múltiple de múltiples personas entonces eh contexto eh le pongo un contexto 2D Yo creo que el servidor se petar Pero bueno da igual No pasa nada Para eso lo tengo contratado creo una nueva conexión y digo que atrapo los datos iniciales del Lienzo vale el socket se abierto el socket tacata vale Ok bien y ahora cuando el servidor me envíe un mensaje datos es lo que me envía el servidor pero pásalo a js Y entonces digo repaso los datos de la imagen uno a uno y igualo los datos de la imagen a los datos que vienen del socket contexto punp image Data y pongo esos datos en el Lienzo y ya está Vale y con esto como veis tenemos una primera versión de un programa de videoconferencia los sockets La idea es que veáis lo que comentábamos ayer no esto hacerlo con php Perdona Bueno sí con php y con Apache sería No ya imposible pero sería muy pesado vale Apache eh yo suelo decir que cada vez que hacemos una petición a Apache y fijaos que en sistemas de gestión empresarial hacemos un montón de peticiones a Apache pero cuando Apache se despierta es algo así como ir a comprar a mercadona con un tanque del ejército vale es decir Apache lleva de todo Apache lleva misiles lleva cohetes está acorazado pesa no sé Cuántas toneladas tienes pistolas tienes granadas tienes de todo Pero tú dirás ya pero es que voy a comprar el mercadona no me hace falta Todo esto Solo quiero un vehículo para llegar a mercadona pues Apache es un tanque la ventaja que tiene Apache Es que le pidas lo que le pidas lo tiene pero claro qué ocurre Pues que cuando estamos haciendo sistemas de gestión empresarial y hacemos una petición cada x segundos pues Oye pues no pasa nada que apach sea un tanque que me sobra cuando hago una petición de estas de voy a la base de datos y pido la base de datos y me la devuelves en jas que estoy no utilizando el 99% de lo que arranco de Apache pues Oye pues tampoco pasa nada quiero decir ni se nota pero claro cuando ayer en un videojuego O como cuando hoy en una aplicación de videoconferencia estamos enviando y recibiendo constantemente información porque Claro que cada vez que arranco y envío esté enviando un tanque pues evidentemente va a hacer que la aplicación vaya pesada vale por eso ya os digo de la misma forma yo aquí he arrancado en este caso en mi servidor un servidor de websockets a mí en la vida se me ocurriría hacer una web con un blog y que el servidor me y que el blog me lo sirviera un servidor de websockets porque sería Pero para qué O sea menudo malgasto de recursos y menuda complicación de establecer una conexión con websockets total para que cuando alguien cargue tu web haga pum toma ahí tien los artículos del Blog Ya está ya lo puedes empezar a leer vale por eso no es cuestión de que websockets son Guay o apaches Guay o lo que sea sino que es una cuestión de que entendáis los pros y los contras de cada cosa y podáis adaptar de la misma forma que igual si hago una web pues la hago con Apache pero si esa web lleva incrustado un chat pues en ese caso probablemente ese chat o lo haré con python o lo haré con nojs o lo haré con una tecnología que sea más apropiada para peticiones continuas vale Así que la idea es un poco estáa bueno como nos quedan 20 minutos voy a aprovechar para empezar a esbozar el ejercicio que haremos a la vuelta cuando volváis de empresar eación emprendedora y de inglés y básicamente lo que voy a querer hacer es una aplicación en la que todos eh todos leamos y todos recibamos vale vamos a verlo para ello en emisor me voy a todo esto y aquí en blink en la carpeta original me voy a hacer un archivo llamado no me acuerdo un archivo llamado 004 pues html y Ok crear vale voy a pegar vale Y ahora en lugar de enviar los datos voy a enviar claro es que si envío mi IP no va a valer vale un momentín voy a crear un identificador único const ID identificador es Quiero la fecha en unix Así que js unix date apoc será no en python Time esto o eso es venga va perfecto fantástico vale identificadores date.now Lo cual quiere decir lo cual quiere decir que vamos a ver si ahora yo envío los datos en socket Send voy a enviar lo siguiente voy a enviar un objeto que dirá identificador es identificador vale como siempre la idea y la ventaja de utilizar Jon en javascript vale os aseguro que os va a dar más alegrías que tristezas y datos. datata estoy enviando un paquete donde no solo envío vídeo sino que digo A quién pertenece ese vídeo vale datos pun Data venga Okay ahora a continuación aquí en el mismo 005 voy a decir recibo mensajes del socket le pego recibo mensajes del socket y datos es igual a j son no voy a quitar todo esto de momento vale Y voy a decir eh console.log datos vale con lo cual si todo ha ido bien me voy a jara.com barg blink Barra html bien tengo principio un vídeo no tengo algún error s error Vale qué ocurre String dónde en la 54a esto no en la 54 datata una coma vale Ya está guardar recargo Okay web shock Open eh Ah sí correcto vale esto de aquí es el Canvas muy bien y ahora a continuación me voy a abrir otro me voy a abrir otro y aquí viene la fiesta es que este esta instancia de aquí de la izquierda está recibiendo los datos de la derecha y esta distancia de la derecha está recibiendo los datos de la izquierda vale o sea luego tengo un sistema de multiconferencia los dos van a recibir y los dos van a leer Este es el objetivo de la clase de hoy que hagamos Aunque vaya lento Aunque vaya un fotograma por segundo o menos pero que todos nos veamos vale que hagamos un Canvas de conferencia con lo cual ahora a continuación vamos a ver me da tiempo sí un cuartito de hora yo creo que me da tiempo hacer cosas vale a continuación voy a cerrar esto por aquí me vengo por aquí me voy a generar el archivo 006 punto html Me cojo el 5co me lo pego en el se vale ahora a continuación qué es lo que ocurre cuando recibo unos datos Vale pues lo que ocurre es lo siguiente vamos a ver eh div Class es igual bueno ID es igual a lienzos di vale Y entonces digo vamos a ver entonces digo led lienzos es igual a document punto eh query selector vamos a ver un momentín que estoy pensando porque no voy a hacerlo siguiente lienzos led lienzos bar lienzos es igual a Ray Okay muy bien ahora for no lienzos for each existe es igual a false lienzos punto for each function Lienzo digo si Lienzo es igual a datos punto q datos punto identificador en ese caso existe es igual a true vale Y aquí abajo haré otra cosa Entonces en ese caso document punto momentín y no vale bar elementos lienzos es igual a Esto vale en ese caso elementos lienzos punto Push document create Element Canvas vale elementos lienzos de elementos lienzos leng -1 vale punto with es igual a 160 elementos lienzos de elementos lienzos lienz igual a 120 muy bien y yo Ah claro ahora tengo que crear un contexto muy bien vale No pasa nada Pues creamos un contexto bar contextos es igual a Ray entonces contextos punto Push Y qué esto es igual a elementos lienzos punto getcontext 2D es decir estoy creando para cada una de las personas que se conecten un Canvas y un contexto vale si sí si existe es igual a true no Espérate si existe es igual a false no todo esto que acabo de escribir es en el caso de que no exista si no existe créalo Okay vale Si el Lienzo no existe créalo vale Y si existe en ese caso vamos a ver elementos lienzos punto Push vale eh claro get Index of js for each and get Index creo que es poner coma Index ahí está coma Index Vale entonces digo elementos lienzos no contextos vamos a ver Mira Let datos es igual a no Let mis datos es igual a contextos de index punto get image Data de 0,0 a Ahora aquí for Let I es igual a 0 Y es menor que mis datos Perdón aquí mis datos pun Data leng y más vale Y entonces digo mis datos punto Data de es igual a datos punto datos curioso datos. datos di con lo cual al final contextos de index putage Data de qué de mis datos en 0,0 vamos a ver si ha funcionado o Cuántos errores Tengo o qué dicen los errores me voy a guardar me voy a abrir la versión 6 ahora comentamos código por supuesto bien websocket connection Open vale No hay errores esto es muy raro cuando no hay errores pues uno se preocupa porque es como que no es normal Ok vale espérate esto aquí bien De momento no está haciendo lo que debe vale Hola Okay aquí está Vale elementos Lienzo is not defined muy bien en la línea 84 elementos Lienzo elementos lienzos elementos Lienzo vale plural Hay un problema ahí plural y singular vale elementos lienzos es con plural por tanto esto tiene que tener una s y una s vale guardamos recargamos vamos a la consola en principio en la consola no aparece nada Ah claro Espérate vale contextos pun Push y document punto get no query selector dónde estás lienzos query selector lienzos punto appen Child elementos lienzos de lo que sea vale es decir no hab puesto el elemento en pantalla vale venga recargamos vale Y ahora teóricamente Ah mira mira está poniendo elementos vale está poniendo elementos lo cual ya es malo vale ya es malo porque se supone que existe está fallando el método de control y encima no me está dibujando bien vale poco a poco pero ya lo vamos teniendo vale míralo vale lo que quiero es que ahí se me cree un nuevo Canvas no un montón de Canvas no algo está pasando vale se me cree un nuevo Canvas y aquí me piné lo que viene de la otra ventana vale Okay bien pues vamos a hacer un parón porque en 5 minutos empieza la siguiente clase vuestra Así que paro de grabar y