bien he estado preparando una serie de sprites para trabajar sobre el terreno del juego son una especie de módulos de modelos de sprays isométricos con diferentes terminador es diferentes lados del terreno estos módulos los he renderizado y los han guardado dentro del proyecto voy a guardar esto como voy a guardar esto como terreno 2 guardo y voy a cerrar por aquí vale y ahora sirviendo por aquí vamos a ver un gesto por aquí en otra pantalla voy a sacar el finder voy a sacar aplicaciones voy a sacar buenas 72 voy a sacar videojuegos puede ser un acceso a esta carpeta bien y entonces y ahora me meto en imágenes lo primero que voy a ver es que bueno he dejado por aquí estos módulos de terreno y preparados y ocurre en este caso que empiezo a tener tantos elementos en pantalla empezamos a tener tantos sprites que llega un momento que si entro a esta carpeta empiezo a no saber muy bien qué es lo que estoy viendo vale entonces lo que voy a hacer en este caso es organizar el código así que voy a poner por aquí pues terreno voy a poner por aquí personalizable componentes personajes voy a poner por aquí personajes voy a poner por aquí pues cosas como por ejemplo el terreno bueno terreno ya lo tengo arriba es fondos así que voy a empezar a meter la información aquí dentro de las carpetas estos son camiseta cara pantalones pies piel pelo y sombra es los componentes personajes los voy a meter aquí los fondos los voy a meter aquí y voy a crear nueva carpeta llamada pues quizás ítems quizás props lo que sea y aquí voy a meter de momento el premio entonces si hago así lo importante como siempre es que pues cuando estamos trabajando con el proyecto pues finalmente tengamos todo organizado de forma que a medida que el proyecto va creciendo pues mantenemos el control sobre aquello que estamos haciendo evidentemente y como te puedes imaginar sigue reorganizado la información ahora mismo el videojuego no va a funcionar porque he cambiado las imágenes de carpetas entonces lo que tengo que hacer es actualizar la información de las carpetas a cerrar por aquí y vamos a hacer aquí y vamos a cargar pues dentro de la carpeta js vamos a cargar los archivos y sobre todo en condiciones iniciales vamos a verlo por aquí pues para qué ing personajes img personajes el premio está dentro de ítems y lo otro creo que lo tengo dentro de css dentro de index.hr ml que sí está en css pues estará aquí en estilo entonces cargamos en este caso fondos pues fondo dos puntos jpg y esto lo que hace es que se ahora arrancó el servidor y se ahora arrancó el juego si todo ha ido bien y si no me ha dejado ninguna imagen pues todo funcionará correctamente me falta el configurador vamos a verlo si lo de la camiseta está realmente aquí en el configurador eso es la otra parte del juego que ahora mismo al menos no voy a abrir pero evidentemente en un momento dado si se abrirá así que vamos a verlo aquí pues sí lo hemos llamado componente es personaje pues esto lo voy a meter aquí entonces componente es personaje componentes personaje completo y ahí lo tenemos bien si ahora voy a localhost barra videojuegos ahora en principio hacer esto un poquito de zoom debería jugar y en principio si todo va bien pues todo debería funcionar correctamente y si no pues amiga quieta será dejado algo pero para efecto y ahí lo tenemos pues lo que quiero ahora lo que quiere a continuación es que el terreno no sea una burda imagen pegada de fondo sino quiero que el terreno sea interactivo es decir quiero que el terreno yo lo pueda ir generando y cambiando nivel a nivel quiero que si el personaje supera el terreno y los palos superan el terreno pues realmente se caiga quiero que reconozca colisión con el terreno y quiero que el terreno no sea una ilusión de fondo sino que realmente sea un componente activo del juego hay diferentes estrategias para trabajar con terrenos de personajes o sea terrenos videojuegos escenarios de videojuegos yo te voy a enseñar una que pienso que es bastante como te diría yo agradable desde el punto de vista en el que te abre muchas posibilidades es decir desde el punto de vista en que no solo te voy a enseñar a generar un terreno sino que te voy a enseñar a generar múltiples terrenos con relativamente poco esfuerzo por tu parte bien pues entonces ahora lo que voy a hacer es que voy a abrir gimp esto que voy a hacer ahora se puede hacer con cualquier software de creación o edición de imágenes pasadas en píxeles en este caso pues bueno suele usar bing porque es una herramienta bastante cómoda para hacer muchos tipos de operaciones es una herramienta gratuita así que me voy a ir a archivo me voy a ir a crear uno nuevo y ahora tengo que tomar una decisión no ya difícil vale sino que va a marcar un poco pues una serie de decisiones que vamos tomar a continuación en este caso la anchura y la altura va a definir pues en la extensión del terreno la extensión del escenario 512 por 512 puede parecer una imagen muy pequeña para definir el escenario de un videojuego pero es que yo realmente no voy a dibujar el escenario dentro de esta imagen sino que esta imagen va a ser una especie de mapa en base al cual voy a generar el escenario por eso 502 de 512 me va a dar como para hacer un terreno grande pero claro luego hay que tener en cuenta que luego el juego va creciendo entonces la pregunta es era suficientemente grande como para poder albergar los cuando el videojuego crees que hay dificultad no lo sé vamos a empezar con 512 y bueno en cierto momento a tiempo de cambiar pues siempre estamos así que elijo 512 eso sí intento elegir un tamaño que sea una potencia de 2 para que pues el ordenador el proceso de la forma más rápida posible y le voy a aceptar tengo una imagen que de hecho quiero que sea transparente ahora veremos voy a crear una capa nueva y ahora aquí con el pincel por ejemplo el pincel voy a de hecho creo que tengo para y el lápiz que es mejor para ciertas cosas me voy a acercar y por aquí en medio con un tamaño de 8 vale ok perfecto pues pinto voy a pintar eso de allí es más voy a pintar un gruñó así ya que sea irregular que sea claramente irregular o sea no estoy buscando ni hacer un círculo ni hacer un rectángulo entonces lo que he hecho en este caso es elegir por ejemplo el color negro de partida ahora hablaremos de que podemos usar otros colores y eso va a ser lo divertido así que yo ahora guardo esto lo voy a exportar en este caso importante que lo guardemos con formato png por otra parte es el de por defecto de ejemplo voy a guardar el escritorio voy a crear una carpeta llamada mapas y voy a guardar esto como mapa 1 experto cómo png importante que sea png y no jpg porque el jpg comprime la imagen y fusiona un poco los pixeles fusiona los colores mientras que el png tiene compresión con pérdida y respeta la estructura de todo aquello que yo dibujo vale por tanto aunque ocupa ligeramente más que el jpg pero vale la pena bien este mapas lo voy a copiar y lo voy a pegar dentro de imagen tengo ya protegen por tanto hay mapas y qué es lo que voy a hacer para minero interesante lo que voy a hacer es que voy a este mapa va a ser pues eso un mapa un plano digamos el programa va a empezar a ver píxel a píxel este mapa donde se encuentra un píxel negro lo que va a hacer lo que va a hacer es colocar uno de estos sprites de momento voy a colocar el sprite terreno 9 que es el clásico y luego veremos que tenemos una serie de sprites de márgenes digamos para que en lugar de acabar en bloque duro pues acabe en un bloque redondeado pero ahora luego si acaso le daremos lógica a esa parte a ver lo que voy a hacer es unir estas dos cosas es decir el programa tiene que ser capaz y aquí es donde viene la dificultad técnica de la clase de hoy tiene que ser capaz de registrar píxel a píxel en esta imagen y luego donde se encuentre cada uno de estos píxeles pues me pegara uno de estos elementos para ello por tanto nos vamos al código voy a menos trabajo por aquí un poco apartado y ahora me voy a index html vemos que teníamos por aquí el inicio y todo eso vale y ahora dentro del inicio voy a crear una función aquí dentro de funciones reiniciar su pierna y vela que lo tenemos vale pues voy a crear otra función function llamada dibuja terreno la función dibuja terreno será llamada por la función de inicio así que inició dibuja terreno es más ahora de momento vamos a ver bueno voy a hacer una cosa séptima out dibuja terreno y no quiero ejecutar un segundo después de que cargue el juego porque quiero hacer esto por una razón muy sencilla y es que las imágenes tardar un poquito en cargar entonces le doy un segundo de margen para que antes de dibujar el terreno se haya preocupado de cargar primero las imágenes es un pequeño defecto de javascript que cuando yo intento dibujar una imagen el programa no se preocupa por saber si realmente esa imagen ha cargado entonces me tengo que preocupar yo manualmente cada lenguaje de programación y cada entorno de desarrollo pues tiene unas ventajas y otras desventajas ahora dentro de lo que es la estructura tenía un canvas y del lienzo tenía tengo que tiene 512 por 512 y tenía un fondo que es donde pegue la imagen manualmente entonces yo ahora lo que quiero es decirle al sistema que quiero hacer otro canvas llamado lienzo al fondo que de momento tendrá 508 512 y quiero hacer otro pequeño canvas y quiero hacer otro pequeño canvas que es mapa que va a ser 512 por 512 también entonces ahora lo que hago es que dentro de las condiciones iniciales no perdón dentro de donde dentro de inicio a ver dónde se definen los contextos bueno aquí puedo empezar a cargar el mapa eso sí bar mapa punto ese roce mapas mapa 1 punto penal bien ahora condiciones iniciales vamos a verlo porque me está faltando hay el contexto muy bien entonces duplicó los dos realmente triplicó contexto a fondo es lienzo fondo y contexto mapa es lienzo mapa puede ser no me acuerdo es el lienzo y en forma entonces ahora lo que voy a hacer bueno aparte de que en condiciones iniciales también voy a cargar el bloque de terreno bar bloque 9 es bloque es terreno no me suena que se llamará así dónde estaba lo encerrado primero juegos terreno y terreno 9 el terreno y ahora como digo vamos a verlo si ya está todo cargado es ese dibujo terreno lo que va a hacer es contexto fondo punto draw image y quiero dibujar él con texto mapa perdón quiero dibujar el mapa en 00 vamos a dibujarlo por cierto que en estilo tendré que decirle que el mapa esto es y en forma para va a tener una posición absoluta un top de 0 píxeles led de 0 píxeles y por si acaso le voy a decir z index es de mil o 10 mil o 100 mil millones de trillones por qué pues porque lo que quiero es que este momento esté dibujado allá arriba encima de todo luego lo ocultaré pero ahora lo quiero ver no está saliendo vamos a ver si tengo algún error y dibuja terreno y es not be fine dónde estás muy bien perfecto vamos a funciones dibujar terreno en funciones dibuja terreno vamos a inicio vamos a index dibuja terreno is not the fine en principio sí que debería lo que voy a hacer es que coma en mayúsculas o contra la mayúsculas r para asegurarme de que recarga todos los elementos es decir equivale al botón derecho vaciar la caché y volver a cargar de manera forzada porque si no lo que estaba ocurriendo es que me estaba cargando de nuevo solo el archivo html pero no me estaba cargando los js entonces lo que estaba haciendo es asumir que eran los mismos que antes entonces ya muchas veces lo hago con teclas rápida que es command mayúsculas r control mayúsculas r para forzar a que lo recargue todo bien tengo como una especie de moco en la pantalla tengo como una especie de mancha negra en la pantalla pero no pasa nada eso es porque yo de momento quiero ver este canvas y luego ya más adelante incluso fíjate que en plan a lo bestia pues lo que puedo hacer es lienzo mapa decirle border un píxel solid black a lo bestia para ver si realmente el lienzo y luego ya cuando ya hemos acabado de operar con esto cuando ya veas claro lo que estamos viendo con esto pues ya lo que haré es ocultarlo bien a continuación ahora viene una parte muy divertida y muy interesante te lo digo medio en broma medio en serio es que me voy a funciones y voy a decir vale ahora quiero uno a uno los píxeles de esta imagen y quiero empezar a trabajar quiero empezar a operar con los píxeles de esa imagen entonces yo defino aquí digo bar píxeles es igual a contexto mapa punto get image data o sea dame los píxeles quiero los datos en crudo de esta imagen porque voy a operar con ellos entonces esta parte es muy interesante esta parte es muy divertida porque lo que nos permite hacer no es ya copiar y pegar sprays y pegarlos en la pantalla so ya lo hemos hecho lo que nos permite es tener un control de la imagen entonces yo vengo por aquí y digo contexto o mapa y me trata es un método con lo cual tiene paréntesis y ahora vamos a ver qué sale de aquí entonces voy a poner con solé punto log punto perdón de píxeles una de las buenas cosas que tienen perfecciona mente javascript es que lo puedes tirar todo a la consola gettyimages data así perdón desde 0,0 hasta 512 con 1.512 requiere cuatro parámetros los primeros dos son la primera esquina los segundos dos son la segunda esquina así que recargo pierre get inmediata se requieren cuatro argumentos pero sólo se han encontrado cero no es sí perdón es que mapa no es una pena que no que estoy mezclando las cosas y esto es 0 512 ahora si es el tamaño que quiere escoger ese entonces ahora despliego inmediata me voy a data veo que hay tantos datos que el programa los tiene que separar en bloques no me nos puede enseñar todos juntos y vio ahí 000 000 es decir veo todo ceros pero es normal eso quiere decir que de cada uno de los píxeles tengo no hay nada efectivamente tengo rojos a cero en el rojo cero en el verde cero en el azul y el cuarto número es el alfa entonces esto que te voy a contar ahora es un poco rollo pero es cómo funciona el los datos en un canvas html5 y es que los cuatro primeros valores son el primer píxel de arriba a la izquierda el primer valor es el rojo el segundo valor es el verde el tercer malversación azul y el cuarto valor es el alfa pero este parámetro número 4 es el primer parámetro del siguiente pixel los cuatro siguientes números son el segundo píxel entonces claro en principio podríamos pensar que es un rollo porque no hay una forma de saber dónde empieza un píxel y dónde acaba el siguiente lo tenemos que contar en bloques de cuatro una forma de hacerlo es la siguiente una forma de hacerlo es recorremos los datos bar y es igual a 0 y es menor a píxeles punto data punto link la longitud de los datos y ahora voy a hacer y es más igual a 4 y eso lo que va a hacer es que en lugar de hacer un bucle for que va uno a uno lo que va a hacer es ir cada bloque de cuatro y por tanto este bucle for se va a encargar el solito de ir saltando automáticamente de píxel a píxel y entonces yo te digo var componente rojo si quieres voy a poner ser componente rojo es igual a píxeles punto data de iu y más uno realmente pero si efectivamente ha escogido la idea es rojo verde o sea componente verde es más uno componente azul estimados y componente transparencia voy a llamarlo componente de otra forma que se puede llamar es hereje y aquí una de alfa vale ya componen red component green comm por hindú y componen de alfa eso ya como quieras roda - y es él y más 3 y entonces yo ahora que voy a hacer pues lo que voy a hacer es lo siguiente que hacer es decirle al sistema si componente rojo es igual a 0 esto puede fallar pero ahora te digo por qué y por qué te digo puede fallar porque yo no tengo todas conmigo de que lo que he usado en gimp sea el color negro parece que si vamos a ver suerte pero te digo que aún así a veces he visto fallar y componente verde es igual a 0 y componente azul es igual a cero eso quiere decir ah perdón componente alfa es igual a 255 o sea un píxel opaco no un píxel transparente pues en ese caso voy a decir con solé punto log te has encontrado un trozo de terreno es más sabes que como todos los píxeles son negros lo que voy a hacer es esto es decir si te fijas la diferencia entre los píxeles que dibujado y los que no estaban dibujados es que los que no estaban dibujados son transparentes y los que yo he dibujado sean negros sean como sea son opacos y por tanto vale entonces si hago esto yo la recargo y no sé si lo estás viendo pero me dice que me he encontrado 795 píxeles de color negro la pregunta que podrías hacerte es que bueno vale parece que esto ha funcionado pero realmente yo he pintado a 795 no sé lo que voy a hacer es lo siguiente lo que voy a hacer es que voy a el lápiz voy a bajar el tamaño y voy a pintar los píxeles lo voy a guardar luego lo podemos deshacer lo voy a guardar voy a recargar vale no sé si lo ha recargado yo diría que no porque aparte si bien no pasa nada porque lo que puedo hacer es exportar esto como mapa 2 y ya está y así le obligó a recargarlo entonces me voy a condiciones iniciales le digo mapa 2 no está claro por supuesto y esto es porque estaba guardando los mapas en el escritorio para intento tras mapa 2 y lo pongo aquí porque él vamos a programados ok y no sé si lo ves pero me dice dos veces que has encontrado un trozo de terreno luego por tanto puede volver ya al mapa uno sabiendo que no tengo que confiar ciegamente en que ese parámetro sea cierto sino que parece que efectivamente es cierto ese parámetro hasta ahora vemos como somos capaces de localizar qué píxeles realmente nos estamos encontrando de terreno pero hay una pequeña cosa hay una pequeña cosa y es que yo ahora como se la x y la y de cada uno de los píxeles porque necesito saber la x la y para ahora a continuación pintar el terreno para saber dónde pongo realmente cada uno de los bloques la idea es que donde me encuentre cada uno de estos píxeles pues me iré al espacio isométrico y ahí pintaré un bloque de terreno bueno pues como te digo que es desde el punto de vista es un rollo el hecho de que los datos me los den en toda una pileta y esta tirita no tenga el diseño y pero si yo sé que esta longitud está hecha a partir d a partir de bloques de cuatro y sé porque lo he definido yo que la anchura y la altura de la imagen es 512 por 512 pues en este caso lo que puedo hacer es averiguar puedo saber cada píxel digamos que xy qué y tiene esto lo puede saber de la siguiente forma voy a hacer un cálculo lo he hecho bastantes veces pero nunca me acuerdo de memoria con lo cual es probable que falle las primeras veces de hecho lo que voy a hacer es poner el mapa 2 porque si no me van a salir un montón de píxeles vamos a por ello bien y ahora digo ahí vamos a verlo perdón la x la quién es el número de columnas digamos que tenemos vamos a ver es la y partido la multiplicado por 4 partido 512 vamos a ver y esto la y es lo que me da esto es y por 4 por 512 no perdón y esto es / / con porcentaje entre 512 vamos a verlo y por 4 vamos a verlo a ver no no no esto es más punto flor podría sacarlo de algún juego no es punto flor y 512 vamos a ver lo consuele punto log si no lo saco de algún otro juego que tenga por ahí desarrollado ahora todo digo y más coma más vengo por aquí recargo y me dice cuatro mil siete y cuatro mil 23 cosas que evidentemente no puede ser pero creo que aquí el haberlo multiplicado por cuatro es lo que me sobra un segundo y voy a verlo en un momento a ver una vez que tenemos ya estas fórmulas afinadas para la equis para la y voy a hacer una prueba voy a hacer una prueba me voy a arriba del todo eso es la que lo que voy a hacer es que voy a dibujar un píxel esto no espera que estoy con la brocha lápiz y voy a dibujar otro por ejemplo por aquí en aquí pues en 3 y 1 voy a ver si me deja llegar a esa carpeta más cara para no tener que ir copiando cada vez mapas tapados y vamos a comprobar si es cierto key recargamos vale 0 y 6 1 parece que efectivamente las fórmulas están funcionando correctamente tiempos ahora ya lo que quiero es devolver el mapa al 1 sabiendo que las fórmulas que nos dan son correctas aquí tenemos todas las todos los píxeles digamos que estamos encontrando y ahora por tanto lo que quiero es con esta información por cada uno de los píxeles negros que me encuentre aquí quiero dibujar un terreno isométrico dentro del canvas correspondiente que por cierto vamos a comprobar que está en el sitio tenemos contenedor tenemos fondo lienzo al lienzo fondo correcto y en su fondo en este caso no pasa nada esta vamos a verlo y en su fondo vale y en condiciones iniciales contexto fondo y aquí vamos a decirle que el lienzo fondo también se beneficie de esa ampliación automática en base a la pantalla con solano con tenedor pienso fondo y lienzo perfecto ahora por tanto me voy a funciones me voy aquí a este digamos esta función y ahora para cada uno de estos bloques lo que quiero es con texto fondo punto draw image y quiero dibujar el que se llama bloque lo que 9 en iso x de x y eso y de equis y esto no va a funcionar pero no va a funcionar no va a funcionar muy bien por la sencilla razón de que yo estoy digamos convirtiendo cada pixel en cada pixel isométrico y eso no puede ser porque cada uno de estos píxeles tiene un píxel de anchura pero como hemos visto los sprites que estoy definiendo pues evidentemente cada uno de estos sprites tiene pues creo que son 256 píxeles de anchura vale vamos a ver eso vamos a ver en qué se traduce eso así que recargó vamos a verlo por aquí de momento no he visto nada para hacer en pantalla no hay ningún error en consola vale voy a ocultar vamos a ver voy a ocultar el fondo voy a no dibujar el fondo para asegurarme que el fondo no varía recargo y ahí es lo que de hecho esto no lo he visto antes no sé si estaba ocurriendo pero es que igual el fondo me estaba mareando no lo sé no pues se ve que el fondo me estaba tapando pues menos mal que he quitado esto mil 449 cuadrado no me cuadra vamos a verlo fondo pienso fondo y lienzo en principio el fondo debería estar atrás este debería estar por encima pero el problema es que el lienzo fondo no tiene la información de posición absoluta el lienzo fondo ahí está el problema voy a bajar esto a líneas y ahora lienzo fondo exposición absoluta top 0 píxeles l 0 píxeles recargamos vale y ahí empieza a aparecer entonces ahí lo que tengo es que de hecho ahí realmente hay en esa parte de ahí no sé que tengo pero lo que me cuadra es esto de aquí de hecho eso de aquí no sé si lo ves pero es como el dibujito del gorrito ese que he hecho en el game esto es lo que ya te digo que no me acaba de cuadrar mucho pero bueno ahora veremos lo que es entonces claro esto ha salido así porque yo en funciones le he dicho que la x es la x la y voy a poner 10 no sea suficiente todavía pero voy a poner días recargo vamos a ver claro ahora se habrá ido vete saber dónde no veo no nos bajo es otra repetición del fondo voy a hacer una cosa ahí está vale 3 ahí va les está yendo y ahí sí lo empezamos a ver lo que está haciendo aunque todavía no está preparado aunque todavía nos está contando correctamente pero lo que está haciendo es dibujar crear una cada uno de estos elementos e isométricos pero con cada uno de los píxeles claro lo que está ocurriendo ahí evidentemente es que me lo tengo que llevar un poco al sitio no pasa nada porque para eso tenemos la función que podemos utilizar de desfase con la función de desfase lo que puedo hacer es re cuadrar el fondo ahora creamos un desfase pero de momento lo que quiero teniendo en cuenta que el punto original del punto cero está ahí pues bueno lo que quiero es llevármelo entonces quiero decir que vamos a hacer bar anchura bloque es igual a 100 y ahora pongo aquí la anchura bloque ahora se me va a ir completamente de la pantalla pero la idea mira es más se salva completamente de la pantalla no voy a crear allá arriba abra el mapa de hecho cojo esto me lo llevo y así por lo menos un poco pero tengamos localizado y luego ya así eso pues ya trabajaremos el desfase así que sobre escribo recargo bien y ahí empezamos a tener eso como podemos ver lo que ocurre en este caso es que estamos empezando a pintar cada uno de los cada uno de los bloques bien vamos a abrir 80 de hecho voy a poner momento 40 más que nada porque quiero que veas es qué no sé si lo ves allí como realmente el dibujo que estoy haciendo es el dibujo que toca por 20 aunque sale un poco ahí distorsionado x y eso xx y vale pero por lo menos empieza a ser ese dibujo o por ejemplo si yo vengo ahora aquí al game vamos a empezar con algo más sencillo si quieres si vamos a verlo vamos a ver momentos laterales de momento voy a hacer una cosa así que sí que efectivamente parecía como que había altura entonces voy a pintar algo sencillo voy a pintar 3 x 3 y así un poco pues vamos a poder ver bien si está saliendo lo que toca y fíjate que sí que sale no sé si veis 1 2 y 3 y 1 2 y 3 hay una cosa que no me acaba de cuadrar mucho y es que la distancia en este eje no parece la misma distancia que en el otro eje y no debería ser evidentemente vale y también vamos a la consola y así un poco evaluamos el resultado vale y esto es 2 4 6 es el problema no es correcto y eso quiere decir que está x no tenía que multiplicarla por 2 aguas y ahora sí ahora si es un 2 3 1 2 3 en la y 1 2 y 3 y ahora sí que podemos poner con tranquilidad cualquier tipo de terreno digamos sabiendo que saldrá correctamente entonces ahora sí que podemos ya empezar a buscar la longitud del mapa el original recuerda que es d de 256 y allí el sprite que he dibujado pues probablemente habrá que afinar lo un poco y luego quiero decir que no tiene por qué coincidir perfectamente y luego también te digo que recordamos que en el propio drogba image yo puedo elegir anchura bloque bar anchura dibujo es igual a por ejemplo 30 entonces ahora tengo por aquí y pongo anchura dibujo con anchura dibujo y fíjate como yo puedo elegir digamos cuánto me va a ocupar realmente cada sprite y por tanto yo puedo ir jugando con ese tamaño ahí lo tenemos por ejemplo si yo ahora vengo por aquí al game a partir de aquí voy a dibujar un pequeño terreno pero así y así digamos la plataforma que dará acceso a una zona más grande pues sobre escribo le voy a recargar y fíjate como pues me va a generar un mapa de ladrillos que luego va a reemplazar este de aquí pero con el dibujo que quiero es decir y ahora vengo por aquí y ahora puedo ir extendiendo el mapa voy a extenderlo por aquí y ahora hago así y creo un pasillo y fíjate que de esta forma una vez que hemos sufrido al principio una vez que hemos tenido que programar la primera parte que ha sido dura pero luego lo vamos a poder disfrutar en el sentido de que yo lo que dibujo en el gym automáticamente se va a convertir en un mapa en isométrico y te digo más y cuando además esté vivo que se va a convertir en un paraíso métrico quiero decir que fíjate que yo ahora mismo estoy creando píxeles negros pero luego puedo jugar y puedo decir bueno si te encuentras un pixel negro crea una pieza de terreno pero si te encuentras un píxel verde pues crea un enemigo y si te encuentras un píxel rojo pues crear un recogí blé con más vida y sic y si te encuentras con no sé qué es lo que quiero decir vale entonces hay la idea y la idea es que ahora lo que voy a hacer es quitar el fondo voy a poner un degradado de fondo voy a hacer un 2048 x 2048 y ya nos vamos a empezar a quitar un poco el fondo que teníamos antes y te digo más ahora a continuación otra de las cosas que vamos a hacer es comparar cuál es la posición del personaje con respecto a los sprites y decir oye la posición el personaje está adentro de un píxel negro pues no pasa nada estás en la plataforma pero la posición del personaje se sale del píxel negro y entra en un pixel transparente pues te has caído y entonces me haces la animación de que te caes hacia abajo vale decir la idea de que trabajar con el tipo de mapas está súper bien porque a partir de aquí podemos hacer como verás pues lo que queramos entonces vengo por aquí voy a pintar voy a hacer un degradado puede ser un degradado clásico como el que hicimos otro día pero sin aquí sin un fondo realmente crea una capa nueva la pinto de color gris juego con la transparencia y una cosa así más o menos y esto lo voy a guardar en img como fondos como solo degradado vamos a verlo y ahora vengo por aquí me voy a estilo me voy aa fondo degradado con solo degradado y voy a decir en este caso que background size verás vamos a ver si yo no le digo esto recargo ahora sólo tengo el degradado de fondos es genial y algo así y llega momento que se repite cuando se acaba se repite yo le voy a decir background 6 100% para que el fondo se adapte automáticamente a la pantalla y así siempre tengo ese degradado de fondo si ahora por ejemplo empieza a jugar vamos a verlo si ahora empiezo a jugar pues la idea voy a hacer un poquito más es um a ver que nosotros habían llegado nuestras noches voy a jugar no sé dónde están a esta variante pues la idea es que ahora en un momento pues llevaremos el terreno a los personajes para que digamos pues podamos empezar a jugar bien vamos allá vamos a por ello vamos a por ello al dibujar los personajes entiendo digo yo me planteo por cierto una cosa que quiero decirte es que si te fijas yo el terreno lo estoy dibujando una vez y como te diría yo y no lo he metido dentro del bucle porque el terreno está ahí el terreno está quieto no tengo por qué dibujarlo no sé cuántas veces por segundo ahora bien ahora luego si quizás el terreno es muy grande y el personaje tiene que ir moviéndose por el terreno pues en ese caso redibujar el terreno pero no voy a redibujar el terreno en cada bucle sino que voy a redibujar el terreno sólo cuando sea necesario o sea lo que quiero que veas es que no es una cuestión de lo que podemos hacer que podríamos meterlo en el re dibujo del bucle evidentemente como te podés imaginar si no es la cuestión de lo que debemos hacer porque si no gastaremos muchos recursos yo creo que más o menos ya te lo puedo enseñar solo con lo que tengo sin complicarlo más entonces mira me voy a funciones sí que permíteme que evidentemente antes de hacer nada más contexto fondo punto clear recta y sea 00 anchura dibujo anchura navegador altura navegador recargó debe quedarse igual a jugar ok bien y ahora lo que voy a hacer cuidado esto no hay que hacerlo pero lo que voy a hacer en funciones es dibuja terreno es por ejemplo por aquí dibuja terreno date cuenta de una cosa yo vengo por aquí inspeccionó voy a hacer un análisis performance pero ya aquí a recargar pero unos cuantos segundos esto y fíjate cómo estamos de procesador o sea nos sobra todavía pero si yo dibujo el terreno cada vez le voy a jugar no sois leves como los personajes no van tan fluidos como antes ahora voy a hacer un profile van como la grados efectivamente totalmente le doy aquí stop y ahora verás para empezar le está costando probablemente me esté cepillando el procesador vale probablemente lo que está ocurriendo es que me estoy quedando pues no menos y cepillando pero vamos pero fíjate la diferencia de antes ahora vale entonces por eso yo puedo meter el re dibujo en el terreno en el bucle fíjate lo pongo me ha costado pero no es eso sino que tengo que en todo momento evaluar mis recursos y decir bueno una cosa es lo que puedo hacer y otra cosa es lo que debo hacer y en este caso no tiene sentido que esté dibujando el terreno en cada bucle si el terreno al menos de momento no está cambiando luego siguiente cuestión es que tenemos por aquí el canvas este ya que ya tenemos claro que funciona ya no nos hace falta verlo en la pantalla por tanto yo lo que puedo hacer es algo tan sencillo como ir a estilo y decir que lienzo mapa voy a decirle simplemente display no ya que un elemento no hace falta que esté mostrado en la pantalla para que funcione entonces fíjate cómo está oculto pero aunque estaba oculto el programa lo tiene en consideración para crear el mapa le voy a jugar no te preocupes por eso porque lo que está haciendo es ver el recording de la sesión anterior vale lo digo porque si hago un nuevo recording verás cómo verás como el procesador vuelve a estar como hace un momento es decir muy liberado bien pues como te decía ahora lo que quiero es cuadrar tanto el tamaño como la posición de los sprites con los personajes por ejemplo en este caso lo que voy a hacer dentro de funciones es decirle que la anchura bloque va a ser y la anchura dibujo pues será 80 más o menos yo creo no lo sé vamos a verlo o ser jugando después igual no tanto 50 por aquí no al revés pues entonces 120 ahora más o menos empieza a tener sentido y ahora por tanto como te digo lo que quiero es que yo pueda calcular vamos a verlo por jaguar aquí yo pueda calcular si el personaje está cayéndose o no está cayéndose voy a hacer un poquito de trampa efe un poquito de trampa por cierto el personaje su x inicial cuánto es aclaró es que era dos y pico por dos chinos y pico espera que te lo digo era mil tres mil 1000 mil bueno vale me puede valer vale voy a este terreno voy a ampliarlo esa lengüeta el cuidado y por qué no y lo que quiero que esté muy grande y lo que quiero es crear una plataforma que acoja al personaje para que no empecemos el juego con el personaje cayendo entonces sobre escribo recargo y así la plataforma de momento acoge al personaje y ahora lo que vamos a hacer es calcularla pues en el personaje con respecto a pues como diría yo el este en el suelo lo que quiero ahora por tanto es como te digo la posición del personaje quiero irme al terreno o sea quiero irme al mapa y preguntar oye en esta posición se está cayendo el personaje con esta posición hay algo y si el forma me dice no hay ningún píxel posible digo porque te has caído por el acantilado y si me dice si hay un píxel pues en este caso es que sigues la plataforma entiendes lo que quiero decir es que voy a recuperar un momento vamos a ver voy a recuperar un momento a estilo aquí esto vale voy aquí en index crear un mapa canvas y en su punto aunque él el lienzo mapa y lienzo punto es igual a eso y ahora verás lo que voy a hacer por supuesto en condiciones iniciales contexto punto lienzo el punto es que ya no me acuerdo como lo llamado pienso punto se ve muy bien y entonces ahora voy a hacer lo siguiente voy a decir contexto punto feel style es igual a red y ahora en el bucle voy a tener que partir lo un poco pero bueno contexto punto clear recto 00 512 y ahora contexto punto fil recta y voy a pintar en pose x post y coma 22 y eso qué quiere decir bueno pues es lo que quiere decir es que ahí arriba vamos a verlo ahí arriba voy a acercar debería estar pintando bienestar no sólo es un punto no sé si ves el punto un punto rojo está ahí vale entonces ese punto representa al personaje voy a hacerlo más grande si quieres que sea mucho más grande me abre un 5 para que se vea bien y luego evidentemente tengo que partir la posición del personaje y se empieza a ver ahora esto va a ser posible en x partido 4 no sé cuánto será la realidad partido 4 para buscar el desfase correcto no es y todavía no es el correcto partido 14 todavía no partido torero cuanto es él 50 pues iguales 50 igual es ese mismo número pues va a ser que sí fíjate que no sé si lo ves pero ahora la posición del punto rojo coincide perfectamente con los píxeles en la pantalla no se ve igual sale pequeño vale pero está ahí con lo cual pues ahora por ejemplo lo que puedo hacer es decirle al sistema que pues quiero eso vale quiero que digamos como te diría yo quiero decirle que cuando se caiga o sea cuando esté fuera del punto pues digamos acabe el juego pero quiero hacer otra cosa más importante también quiero hacer otra cosa más determinante y es que señora tengo por aquí yo me salgo y ahí ir ahí realmente terreno o por ejemplo si yo vengo por aquí al gym wilton y por aquí y dibujo más terreno luego terreno por ahí y un poco igual me lo flipo yo solo pero a mí esto me da muchas expectativas porque es madre miento es la de terreno que puedo hacer me puedo hacer un terreno en un momento con el gimp y automáticamente se convierte en un terreno dentro del videojuego pero claro pero tengo el problema de que cuando llegó allí me salgo de la pantalla entonces lo que tengo que programar es una función de desfase mediante la cual digamos corrija la posición del personaje para que de alguna forma el personaje siempre esté centrado en la pantalla vamos a programar esto los sistemas de desfases son fáciles de entender a veces no demasiado de programar pero bueno vamos a meter por aquí en nuevas propiedades ahora luego pondremos comentarios entonces pongo bar desfase x es igual a cero vamos a ponerlo y bar de fase y es igual a cero la idea lo que quiero es decirle siempre al sistema que tenga al personaje enfocado en la pantalla además cada vez que pinto algo esto es lo peligroso cada vez que pinto algo le tengo que aplicar el desfase eso quiere decir que me voy a funciones vamos a verlo ahora así que probablemente voy a tener que pintar el personaje de pintar el fondo cada vez a lo veremos y oye con texto fondo esto realmente no hará falta todo el rato pero vale ahora veremos hablaremos la bestia y esto es piso x más desfase x desfase y de hecho si vengo aquí a condiciones iniciales y le pongo desfase x 220 fíjate cómo está el terreno y fíjate que no está igual lo ha movido hacia la derecha no se lo has visto entrar es un poco para que veas que está funcionando ahora evidentemente dentro del bucle tengo que hacer lo mismo para cada vez que vive un personaje entonces me buscó los droga emails vamos a ver vale esta de animación ángulo esto no estás más desfase voy a copiarlo x más desfase y esto es más desfase x más desfase y más desfase x más desfase y más desfase x más desfase y x más desfase y más desfase x más desfase y esto qué es lo que hace esto lo que hace es que se lleva había condiciones iniciales y le digo aquí no se sirve es como bueno pues me pasó para pagar 420 y en el momento que entré por ahí me lo ha desfasado digamos y ahora lo que necesito por tanto es decirle al sistema que el desfase ya no va a ser una variable única digamos sino que va a ser una variable que va a ir cambiando mediante el movimiento del personaje entonces en este caso vamos a verlo me voy a ir al bucle ahora si tengo que dibujar dibuja terreno aunque duela te va a doler por lo menos vamos a quitarlos con soles que es también ralentizan mogollón ahora si va a ralentizar lo digo yo y ahora lo que necesito es decirle al sistema dentro del bucle voy a ser marcos a desfase x más para que lo veas para que lo comprueben si hago así lo que ocurre dentro del juego es que no se vive espero esta tendencia ya está tirando realmente hacia donde no debe pero bueno si lo hiciera al revés me obligaría a seguir dentro del ir avanzando en el juego digamos vale no quiero esto realmente no quiero desfase xx era una demostración lo que quiero es ahora digamos calcular dónde está realmente el personaje entonces vamos a ver yo voy a decir lo siguiente el medio de la pantalla bar medio pantalla x es igual a la pantalla partido por 2 mar medio pantalla es igual a altura pantalla partido por 2 y por tanto yo ahora voy a decirle hizo x después x campos y es menor pros y les extraer otra familia que es muy bien es menor que medio pantalla x en ese caso desfase + + igual lo hecho al revés ahora veremos en caso contrario desfase x menos lo que va a hacer es un desfase animado agradable qué pasa aquí porque me dice que tengo un error creo que no tengo ningún error voy a ignorar ese mensaje de error igual luego me lo como' con patatas pero me dio pantalla y desfase y vamos allá recargamos le damos a jugar parece que hay un error porque se ha quedado congelado ante la pantalla es no te falló anchura pantalla condiciones iniciales anchura navegador y altura navegador vamos a recargar le vamos a jugar un momento que recarga del todo si ese entonces ahí vale está al revés tiene toda la pinta de estar al revés asiste - - - - más puede ser vamos a verlo porque sería te digo este tipo de cosas de que acaban estando al revés si siempre les acabó acertando a prueba y error así que yo creo que más o menos ahora veremos hay uno de los dos el caso es que quiere funcionar quiere hacer algo pero bueno no pasa nada otra cosa que puedo hacer por cierto es definir en condiciones iniciales el bar velocidad desfase es igual a 5 por ejemplo y ahora aquí en bucle desfase más igual velocidad desfase más igual velocidad desfase y así más que nada es que lo va a hacer más rápido y así veremos mejor donde que está pasando y bueno la idea como te digo es probar y los signos y al final encontraremos el correcto y todavía no pero ya aparecerá a la hora de las combinaciones cero muy bien si nada porque yo creo que en el cálculo del medio pantalla debo tener en cuenta también el desfase x y el desfase y porque se no tiene sentido pero ahora vete a saber tengo que volver a hacer las pruebas pero bueno la idea esto ya tiene otro aspecto ahí lo tenemos vibra un poco no pasa nada ahora lo corregirá se puede corregir más o menos poniéndole 1 también lo que se puede hacer es que compruebe este desfase cada equis tiempo vamos a esperar a que esté allí y si paras y sigue vibrando un poco pero no pasa nada estás en el nivel 2 y evidentemente ahora a continuación pues lo que podemos hacer es dentro de lo que es el mapa crear los enemigos digamos como píxeles es decir que un punto negro sea un terreno pero un punto rojo sea un enemigo un punto verde sea el punto al que tienes que llegar y así digamos que por ejemplo pues yo puedo poner que el inicio esté aquí también puedo poner que el inicio del personaje esté en ese punto que los malos estén por aquí que el objetivo esté ahí y de esta manera pues digamos que podemos seguir avanzando podemos ir creando terrenos incrementales para cada uno de los niveles con dificultad creciente y con retos digamos pues más abordables vale pues de esta manera fíjate que poco a poco ya vamos teniendo pues un juego bastante como te diría yo completo desde el punto de vista en que tenemos personaje protagonista tenemos antagonistas podemos hacer recogerles con vida tenemos un inicio tenemos un final tenemos una misión y en definitiva y luego ya evidentemente esto se puede personalizar infinitamente quiero decir que yo he creado unos personajes con cabeza de cubo y luego se pueden cambiar los personajes para que sean arqueros para que sean enanos para que sean elfos para que sean magos para que sea lo que se quiera que sea es decir una vez que hemos definido lo que sería la plantilla del juego pues una vez que tenemos esto ahora ya como te diría yo personalizar el gameplay del juego es algo que prácticamente tiene que ver ya cada vez más con gráficos y menos con programación porque la programación ya es directamente pues esto que estamos viendo